<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rhonda Ho Kah Yee">
<meta name="dcterms.date" content="2023-02-20">

<title>IS415-GAA - Take-home Assignment 2: Spatio-temporal Analysis of COVID-19 Vaccination Trends at the Sub-district Level, DKI Jakarta</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Week 1&amp;2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Week 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Week 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Week 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Week 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Week 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-assignment" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Assignment</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-assignment">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Assgn/Take-home_Assgn1/Take-home_Assgn1.html">
 <span class="dropdown-text">Take-home Assignment 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Take-home Assignment 2: Spatio-temporal Analysis of COVID-19 Vaccination Trends at the Sub-district Level, DKI Jakarta</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rhonda Ho Kah Yee </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 20, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">March 1, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.1 Objectives</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.2 The Data</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">1.3 Tasks</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting Started</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3. Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">3.1 Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#import-shapefile-into-r-environment" id="toc-import-shapefile-into-r-environment" class="nav-link" data-scroll-target="#import-shapefile-into-r-environment">3.1.1 Import shapefile into r environment</a></li>
  <li><a href="#identifying-relevant-columns" id="toc-identifying-relevant-columns" class="nav-link" data-scroll-target="#identifying-relevant-columns">3.1.2 Identifying Relevant Columns</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">3.1.3 Data Pre-Processing</a></li>
  </ul></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">3.2 Aspatial Data</a>
  <ul class="collapse">
  <li><a href="#observations-of-data-website" id="toc-observations-of-data-website" class="nav-link" data-scroll-target="#observations-of-data-website">3.2.1 Observations of Data Website</a></li>
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">3.2.2 Importing Aspatial Data</a></li>
  <li><a href="#data-pre-processing-1" id="toc-data-pre-processing-1" class="nav-link" data-scroll-target="#data-pre-processing-1">3.2.3 Data Pre-processing</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geospatial-data-integration" id="toc-geospatial-data-integration" class="nav-link" data-scroll-target="#geospatial-data-integration">4. Geospatial Data Integration</a></li>
  <li><a href="#calculation-monthly-vaccination-rates" id="toc-calculation-monthly-vaccination-rates" class="nav-link" data-scroll-target="#calculation-monthly-vaccination-rates">5. Calculation: Monthly Vaccination Rates</a></li>
  <li><a href="#mapping-of-monthly-vaccination-rates" id="toc-mapping-of-monthly-vaccination-rates" class="nav-link" data-scroll-target="#mapping-of-monthly-vaccination-rates">6. Mapping of Monthly Vaccination Rates</a></li>
  <li><a href="#local-gi-analysis" id="toc-local-gi-analysis" class="nav-link" data-scroll-target="#local-gi-analysis">7. Local Gi* Analysis</a></li>
  <li><a href="#emerging-hot-spot-analysisehsa" id="toc-emerging-hot-spot-analysisehsa" class="nav-link" data-scroll-target="#emerging-hot-spot-analysisehsa">8. Emerging Hot Spot Analysis(EHSA)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>Hello! This is Rhonda Ho’s take-home Assignment 2 for IS415 module.</p>
<p>To view/hide all the code at once, please click on the “&lt;/&gt; code” tab beside the title of this html document and select the option to view/hide the code.</p>
<p>The full details of this assignment can be found <a href="https://is415-ay2022-23t2.netlify.app/th_ex2.html">here</a>.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.1 Objectives</h2>
<p>Exploratory Spatial Data Analysis (ESDA) hold tremendous potential to address complex problems facing society. In this study, you are tasked to apply appropriate Local Indicators of Spatial Association (LISA) and Emerging Hot Spot Analysis (EHSA) to undercover the spatio-temporal trends of COVID-19 vaccination in DKI Jakarta.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.2 The Data</h2>
<ol type="1">
<li><strong>Aspatial data</strong></li>
</ol>
<p>For the purpose of this assignment, data from <a href="https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/">Riwayat File Vaksinasi DKI Jakarta</a> will be used. Daily vaccination data are provided. We are only required to download either the first day of the month or last day of the month of the study period.</p>
<ol start="2" type="1">
<li><strong>Geospatial data</strong></li>
</ol>
<p>For the purpose of this study, DKI Jakarta administration boundary 2019 will be used. The data set can be downloaded at Indonesia Geospatial portal, specifically at <a href="https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html">this page</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The national Projected Coordinates Systems of Indonesia is DGN95 / Indonesia TM-3 zone 54.1.</li>
<li>Exclude all the outer islands from the DKI Jakarta sf data frame, and</li>
<li>Retain the first nine fields in the DKI Jakarta sf data frame. The ninth field JUMLAH_PEN = Total Population.</li>
</ul>
</div>
</div>
</section>
<section id="tasks" class="level2">
<h2 class="anchored" data-anchor-id="tasks">1.3 Tasks</h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ol type="1">
<li><p><strong>Choropleth Mapping and Analysis</strong></p>
<ul>
<li><p>Compute the monthly vaccination rate from July 2021 to June 2022 at sub-district (also known as kelurahan in Bahasa Indonesia) level,</p></li>
<li><p>Prepare the monthly vaccination rate maps by using appropriate tmap functions,</p></li>
<li><p>Describe the spatial patterns revealed by the choropleth maps (not more than 200 words).</p></li>
</ul></li>
<li><p><strong>Local Gi* Analysis</strong></p>
<p>With reference to the vaccination rate maps prepared in ESDA:</p>
<ul>
<li><p>Compute local Gi* values of the monthly vaccination rate,</p></li>
<li><p>Display the Gi* maps of the monthly vaccination rate. The maps should only display the significant (i.e.&nbsp;p-value &lt; 0.05)</p></li>
<li><p>With reference to the analysis results, draw statistical conclusions (not more than 250 words).</p></li>
</ul></li>
<li><p><strong>Emerging Hot Spot Analysis(EHSA)</strong></p>
<p>With reference to the local Gi* values of the vaccination rate maps prepared in the previous section:</p>
<ul>
<li><p>Perform Mann-Kendall Test by using the spatio-temporal local Gi* values,</p></li>
<li><p>Select three sub-districts and describe the temporal trends revealed (not more than 250 words), and</p></li>
<li><p>Prepared a EHSA map of the Gi* values of vaccination rate. The maps should only display the significant (i.e.&nbsp;p-value &lt; 0.05).<br>
</p></li>
<li><p>With reference to the EHSA map prepared, describe the spatial patterns revealed. (not more than 250 words).</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2. Getting Started</h1>
<p>The following packages will be used:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a>: used for importing, managing, and processing geospatial data</p></li>
<li><p><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a>: a collection of packages for data science tasks</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a>: used for creating thematic maps, such as choropleth and bubble maps</p></li>
<li><p><a href="https://spatstat.org/"><strong>spatstat</strong></a>: used for point pattern analysis</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/raster/"><strong>raster</strong></a>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/funModeling/index.html"><strong>funModeling</strong></a>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/maptools/index.html"><strong>maptools</strong></a>: a set of tools for manipulating geographic data and</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/spdep/index.html"><strong>sfdep</strong></a>: for performing geospatial data wrangling and local colocation quotient analysis.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, spatstat, raster, funModeling, maptools, sfdep, readxl, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-wrangling" class="level1">
<h1>3. Data Wrangling</h1>
<section id="geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data">3.1 Geospatial Data</h2>
<section id="import-shapefile-into-r-environment" class="level3">
<h3 class="anchored" data-anchor-id="import-shapefile-into-r-environment">3.1.1 Import shapefile into r environment</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From the output, we can observe that:</p>
<ol type="1">
<li><p>Geometry type is MULTIPOLYGON</p></li>
<li><p>CRS information is <a href="https://epsg.io/4326">WGS 84</a> instead of the CRS for Indonesia, Jakarta.</p></li>
</ol>
</section>
<section id="identifying-relevant-columns" class="level3">
<h3 class="anchored" data-anchor-id="identifying-relevant-columns">3.1.2 Identifying Relevant Columns</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(jkt2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Having a glimpse at our data, some of relevant column(s) that we need for our task is:</p>
<ul>
<li><p><code>KAB_KOTA</code> : represents the cities in Jakarta</p></li>
<li><p><code>KECAMATAN</code> : represents the district in Jakarta</p></li>
<li><p><code>DESA_KELUR</code> : represents the sub-districts in Jakarta.</p></li>
</ul>
</section>
<section id="data-pre-processing" class="level3">
<h3 class="anchored" data-anchor-id="data-pre-processing">3.1.3 Data Pre-Processing</h3>
<section id="check-for-invalid-geometries" class="level4">
<h4 class="anchored" data-anchor-id="check-for-invalid-geometries">3.1.3.1 Check for Invalid Geometries</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for invalid geometries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(jkt2019) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-for-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="check-for-missing-values">3.1.3.2 Check for Missing Values</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for missing values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(jkt2019))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output, we have discovered that there are 14 missing values in our dataset which may affect our analysis. Thus, I removed all missing values in the sub-districts(a part of our main study focus), using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(jkt2019,<span class="fu">c</span>(<span class="st">"DESA_KELUR"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="transformation-of-coordinates-information" class="level4">
<h4 class="anchored" data-anchor-id="transformation-of-coordinates-information">3.1.3.3 Transformation of Coordinates Information</h4>
<p>Earlier on, we discovered that the assigned coordinates system of our data is WGS 84 which is not appropriate for an Indonesian-specific geospatial dataset. Another way of checking it is using the function, <a href="https://www.rdocumentation.org/packages/sf/versions/1.0-9/topics/st_crs">st_crs()</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether need to transform</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(jkt2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As this is an Indonesian-specific geospatial dataset, I will be using <a href="https://epsg.io/23845">EPSG:23845.</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transforms the CRS to DGN95, ESPG code 23845</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(jkt2019, <span class="dv">23845</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(jkt2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Yay, we have successfully managed to transform our dataset to the appropriate coordinates system!</p>
</section>
<section id="removal-of-outer-islands" class="level4">
<h4 class="anchored" data-anchor-id="removal-of-outer-islands"><strong>3.1.3.4 Removal of Outer Islands</strong></h4>
<p>To start off, let visualise our data!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(jkt2019))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The visualisation above shows that our data consist of outer islands beyond Jakarta. As this is not important for our analysis, we should remove it.</p>
<p>Previously, we have identified 3 important attributes which represents the divisions of Jakarta. They are <code>KAB_KOTA</code> (City), <code>KECAMATAN</code> (District) and <code>DESA_KELUR</code> (Village). Removing the outer islands by the City would help us to remove all the districts and villages within it, so I proceeded to check the unique values of it.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(jkt2019<span class="sc">$</span><span class="st">"KAB_KOTA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From this, we can observe that all the values has “JAKARTA” in it except “KEPULAUAN SERIBU”(Thousand Island). The code chunk below visualises the different cities in Jakarta.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(jkt2019) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"KAB_KOTA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will need to remove the outer islands by using the <a href="https://www.educative.io/answers/what-is-the-filter-method-in-r">filter()</a> function to filter out the outer islands.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accepts only if the value of KAB_KOTA is NOT KEPULAUAN SERIBU</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">filter</span>(jkt2019, KAB_KOTA <span class="sc">!=</span> <span class="st">"KEPULAUAN SERIBU"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For this assignment, we are required to only retain the first 9 fields.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filters out other fields by accepting only the first 9 fields</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> jkt2019[, <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For easier comprehension of our data, I have decided to translate the column headers to English.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> jkt2019 <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Object_ID=</span>OBJECT_ID,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Province=</span>PROVINSI, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">City=</span>KAB_KOTA, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">District=</span>KECAMATAN, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Village_Code=</span>KODE_DESA, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Village=</span>DESA, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sub_District=</span>DESA_KELUR,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Code=</span>KODE, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Population=</span>JUMLAH_PEN</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With that, we are done for our geospatial data!</p>
</section>
</section>
</section>
<section id="aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data">3.2 Aspatial Data</h2>
<section id="observations-of-data-website" class="level3">
<h3 class="anchored" data-anchor-id="observations-of-data-website">3.2.1 Observations of Data Website</h3>
<p>Examining DKI Jakarta Vaccination File History <a href="https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/">website</a>, some of my observations were:</p>
<ul>
<li><p>Entire page is in Indonesian</p>
<ul>
<li><p>To translate to English, simply right click anywhere on the webpage and click “Translate to English” button</p></li>
<li><p>Alternative solutions for translation can be found <a href="https://www.wikihow.com/Translate-a-Web-Page">here</a>.</p></li>
</ul></li>
<li><p>There were two columns for DKI Jakarta Vaccination File History, one for “<em>Vaccination Data Based on Village and District</em>”, another for “<em>RT-Based Vaccination Data</em>”</p>
<ul>
<li>We will be focusing on the “V<em>accination Data Based on Village and District</em>”column as our task require us to analyse on a sub-district level.</li>
</ul></li>
<li><p>Many instances of missing data!</p>
<ul>
<li><p>E.g 1) The hyperlink to March 1 2022 will direct you to March 2 2022 data and March 1 2022 cannot be found :(</p></li>
<li><p>E.g 2) Certain months such as July 2021, August 2021, February 2022 were missing the record of the date written in the table and its respective data</p>
<ul>
<li><p>A few examples of missing records are 19 July 2021, 28 August 2022, 11 September, 28 February 2022, 17 March 2022</p></li>
<li><p>Upon further research and some of my assumptions, missing data can be due to:</p>
<ul>
<li><p>A glitch in the system, which prevents the data from being uploaded</p></li>
<li><p>An update of the system which may prevent records from being uploaded on that day</p></li>
<li><p>Data not recorded as there is no available data due to the day being a holiday</p>
<ul>
<li><p>For e.g 28 February 2022 record and data is missing and that day so happens to be an Indonesian major holiday called <a href="https://publicholidays.co.id/isra-miraj/">Isra Mi’raj</a>. Upon further <a href="https://www.3ecpa.co.id/resources/indonesia-public-holidays/isra-miraj/#:~:text=They%20walk%20in%20the%20city,Indonesia%20during%20Isra%20Mi'raj.">research</a>, Indonesians celebrate that day by gathering at their local mosque for prayers and/or will be walking in the city going to the city hall while chanting the Salawat. Thus, there is a high possibility that people will not get vaccinated on this specific day.</p></li>
<li><p>For reference, the list of holidays for <a href="https://www.officeholidays.com/countries/indonesia/2021">2021</a>and <a href="https://publicholidays.co.id/2022-dates/">2022</a>.</p></li>
<li><p>However, there are also days where it is a holiday but vaccination data is still being recorded such as 1 January 2022 (New Year’s Day) and 1 May 2022(Labour Day). A possible reason could be that, assuming Indonesia is similar to Singapore, certain clinics will still be opened but only for selected hours.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Under our task we are required to compute monthly vaccination rate from <u>July 2021 to June 2022</u> and we are only required to download the <u>first or last day of the month of study period</u>.</p>
<p>For this assignment, I will be using data of the first day of each month of the study period with the exception of March 2021, I will be using March 2 instead of March 1 as March 1’s data is missing.</p>
</section>
<section id="importing-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data">3.2.2 Importing Aspatial Data</h3>
<p>In our ‘data/aspatial’ folder, we have downloaded multiple .xlsx files ranging from 1 July 2021 to 1 June 2022. But before we compile it together, we need to understand each dataset and check for any discrepancies.</p>
<p>The purpose of the code chunk below is to reach each excel file under the folder ‘data/aspatial’ , create its dataframe(df) and assign it to a variable name which is in the format of “month_year”. E.g April_2022 . The following functions are used:</p>
<ul>
<li><p><a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/list.files">list.files():</a> creates a list of the files in a directory/folder</p></li>
<li><p><a href="https://www.digitalocean.com/community/tutorials/substring-function-in-r">substr():</a> extract the characters present in the data</p></li>
<li><p><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim():</a> remove whitespace</p></li>
<li><p><a href="https://www.digitalocean.com/community/tutorials/paste-in-r">paste():</a> concatenate strings and values into a single element</p></li>
<li><p><a href="https://readxl.tidyverse.org/reference/read_excel.html#:~:text=read_excel()%20calls%20excel_format(),file%20itself%2C%20in%20that%20order.">read_excel()</a>: to read the data in xlsx format</p></li>
<li><p><a href="https://www.geeksforgeeks.org/finding-the-length-of-string-in-r-programming-nchar-method/#:~:text=nchar()%20method%20in%20R,character%20in%20a%20string%20object.&amp;text=Where%3A%20String%20is%20object.,the%20length%20of%20a%20string.">nchar():</a> gets the length of string</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gets all files under the folder 'data/aspatial' which is in '.xlsx' format</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>study_period_data <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">'data/aspatial'</span>,<span class="at">pattern =</span> <span class="st">"*.xlsx"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#instantiate an empty list which will be used later to contain all the df names</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df_list <span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> study_period_data){</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a> <span class="co"># eg of x: Data Vaksinasi Berbasis Kelurahan (01 April 2022).xlsx</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a> <span class="co"># extract the year and month from the data file name</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a> month_yr <span class="ot">&lt;-</span> <span class="fu">str_trim</span>(<span class="fu">substr</span>(x, <span class="dv">38</span>, <span class="fu">nchar</span>(x)<span class="sc">-</span><span class="dv">6</span>)) <span class="co">#e.g output: April 2022</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a> <span class="co">#split the month and year by the empty space inbetween</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a> split_month_yr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(month_yr,<span class="st">" "</span>) <span class="co">#e.g output: [[1]][1]'April' '2022'</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a> <span class="co">#split_month_yr[[1]][1] shows the month, split_month_yr[[1]][2] shows the year </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a> <span class="co">#join the month and year with "_"</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a> join_month_yr <span class="ot">&lt;-</span> <span class="fu">paste</span>(split_month_yr[[<span class="dv">1</span>]][<span class="dv">1</span>],split_month_yr[[<span class="dv">1</span>]][<span class="dv">2</span>],<span class="at">sep=</span><span class="st">"_"</span>) </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a> <span class="co">#e.g output: April_2022</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a> <span class="co">#join_month_yr will be used as the variable name to store the df</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a> <span class="co">#add each month name to list</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a> df_list<span class="ot">&lt;-</span><span class="fu">append</span>(df_list,join_month_yr)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a> <span class="co"># get filepath that we need to read each month's excel file</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a> filepath <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"data/aspatial/"</span>,x,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a> <span class="co"># eg output: "data/aspatial/Data Vaksinasi Berbasis Kelurahan (01 April 2022).xlsx"</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a> <span class="co">#reach each excel file and assign it to its variable name </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">assign</span>(join_month_yr,<span class="fu">read_excel</span>(filepath))</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-pre-processing-1" class="level3">
<h3 class="anchored" data-anchor-id="data-pre-processing-1">3.2.3 Data Pre-processing</h3>
<section id="check-for-duplicated-values" class="level4">
<h4 class="anchored" data-anchor-id="check-for-duplicated-values">3.2.3.1 Check for Duplicated Values</h4>
<p>To check for any duplicate columns for each dataset, I created a function called duplication_check() which takes in the df filename as a variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>duplication_check <span class="ot">&lt;-</span> <span class="cf">function</span>(file_name) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  duplicated_columns <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(<span class="fu">as.list</span>(file_name))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  duplicated_chara <span class="ot">&lt;-</span> <span class="fu">colnames</span>(file_name[duplicated_columns])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(duplicated_chara)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I then made use of df_list which I populated earlier on to contain all of our df names and looped through it. This allows me to check for each time period df, which df has duplicated columns using the function I created.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> df_list) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  duplicated_col <span class="ot">&lt;-</span> <span class="fu">duplication_check</span>(<span class="fu">get</span>(df))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">identical</span>(duplicated_col, <span class="fu">character</span>(<span class="dv">0</span>))){</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    duplicated_col<span class="ot">=</span><span class="st">"none"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Under df"</span>, df, <span class="st">"| duplicated col:"</span>, <span class="fu">toString</span>(duplicated_col)))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output, we can observe that for df April_2022, Juni_2022 and Mei_2022. There is a duplicated column called <code>LANSIA\r\nDOSIS 3</code>.</p>
<p>Diving deeper into each dataset with a duplicated column with the use of glimpse(), we can observe that column <code>LANSIA\r\nDOSIS 3</code> and column <code>LANSIA\r\nDOSIS 2</code> are exactly the same.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(April_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>But how does this affect our dataset?</strong></p>
<p>Upon translation, i discovered that <code>LANSIA\r\nDOSIS</code> refers to elderly dosage.</p>
<p>This means that in our datasets with duplicated columns, there is 4 related columns - Elderly Dosage 1, Elderly Dosage 2, Elderly Dosage 3, Total Elderly Dosage where Dosage 3 values are a repeat of Dosage 2 values.</p>
<p>I suspected that the Total elderly vaccine delivered should be the sum of Elderly Dosage 1, 2 and 3. However, according to April_2022 df, total elderly vaccine delivered is 1536442 which is neither the sum of elderly dosage 1, 2 and 3 nor the sum of elderly dosage 1 and 2. This suggests that either the total sum is wrongly added or the values for elderly dosage 3 was input wrongly. Regardless, this reduces the reliability of those data columns.</p>
</section>
<section id="check-for-missing-values-1" class="level4">
<h4 class="anchored" data-anchor-id="check-for-missing-values-1">3.2.3.2 Check for Missing Values</h4>
<p>To check for missing values, I created a function, check_missing_value() and used it to check for each df.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>check_missing_value <span class="ot">&lt;-</span> <span class="cf">function</span>(filename){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(filename))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> df_list) {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">check_missing_value</span>(<span class="fu">get</span>(df)))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output, I realised that all the df were missing 3 fields. Looking deeper, I realised it was the same 3 fields (1st row, first 3 columns) for all the df that were blank. The reason why it is empty is due to the fact that is was merged with the top column in the excel and the 1st row of each excel file was meant to represent the total dosages across all districts. Thus, we will be removing it later.</p>
</section>
<section id="combination-of-every-.xlsx-files" class="level4">
<h4 class="anchored" data-anchor-id="combination-of-every-.xlsx-files">3.2.3.3 Combination of every .xlsx Files</h4>
<p>Now, we need to combine the data files for every time period of our study period.</p>
<p><strong>What are the relevant columns?</strong></p>
<p>I would need to add the date and year in a new column</p>
<p>need to convert to english language for easier comprehension</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can derive count of people who were vacinated by target - yet to be vacinated</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df_str <span class="cf">in</span> df_list) {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span><span class="fu">get</span>(df_str)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  new_df<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#extract relevant columns</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'WILAYAH KOTA'</span>, <span class="co"># CITY AREA</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">'KECAMATAN'</span>, <span class="co"># DISTRICT</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">'KELURAHAN'</span>, <span class="co"># SUBDISTRICT</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">'SASARAN'</span>, <span class="co"># TARGET population to be vacinated</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">'BELUM VAKSIN'</span> <span class="co">#Yet to be vacinnated</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#add the month_year</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">Time_Period =</span> df_str)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(df_str,new_df)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">0</span>)), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">'WILAYAH KOTA'</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'KECAMATAN'</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'KELURAHAN'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'SASARAN'</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'BELUM VAKSIN'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'Time_Period'</span>))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#combining all tgt</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df_str <span class="cf">in</span> df_list) {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  combined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(combined_df,<span class="fu">get</span>(df_str))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#translate  colnames into eng</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CITY_AREA"</span>, <span class="st">"DISTRICT"</span>,<span class="st">"SUBDISTRICT"</span>, <span class="st">"TARGET"</span>, <span class="st">"YET_TO_BE_VACINATED"</span>, <span class="st">"TIME_PERIOD"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#convert into date format yyyy-mm-dd</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Desember_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-12-01'</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Februari_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-02-01'</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Januari_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-01-01'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Juli_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-07-01'</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Juni_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-06-01'</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Mei_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-05-01'</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Oktober_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-10-01'</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Maret_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-03-02'</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Agustus_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-08-01'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'September_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-09-01'</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'November_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-11-01'</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'April_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-04-01'</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to date format</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD <span class="ot">&lt;-</span><span class="fu">as.Date</span>(combined_df<span class="sc">$</span>TIME_PERIOD, <span class="at">format=</span><span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(combined_df<span class="sc">$</span>TIME_PERIOD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check missing values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>combined_df[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(combined_df))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As identified earlier, there are missing values under <code>CITY AREA</code> and <code>DISTRICT</code> where the <code>SUBDISTRICT</code> is “TOTAL”. As our analysis focuses on the Subdistricts of Jakarta, knowing the “Total” is not important. Hence, I decided to remove it.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(combined_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(combined_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we need to check whether this data consist of any outer islands and remove it accordingly. The code chunk below follow the steps earlier shown in the removal of outer islands.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#identify unique values of city areas in Jakarta</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(combined_df<span class="sc">$</span><span class="st">"CITY_AREA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the outer island i.e KAB.ADM.KEP.SERIBU</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(combined_df, CITY_AREA <span class="sc">!=</span> <span class="st">"KAB.ADM.KEP.SERIBU"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="geospatial-data-integration" class="level1">
<h1>4. Geospatial Data Integration</h1>
<p>Now that we have prepared our geospatial and aspatial data frames, we’ll need to join them. A quick look at their headers tell us what their common fields are:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(jkt2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Analyzing the columns headers, columns related to the city, district and subdistrictshould match.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># joins based on district, Sub_District and City</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(jkt2019, combined_df,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"City"</span><span class="ot">=</span><span class="st">"CITY_AREA"</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"District"</span><span class="ot">=</span><span class="st">"DISTRICT"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Sub_District"</span><span class="ot">=</span><span class="st">"SUBDISTRICT"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, let’s visualise our combined_jakarta and with its target and to be vaccinated values count.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>target_vaccines <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TARGET"</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Target Vaccinated Count"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>yet_to_be_vaccines <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"YET_TO_BE_VACINATED"</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Yet To Be Vaccinated Count"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(target_vaccines, yet_to_be_vaccines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Both our maps show that there are missing values even though both dataframes missing values were removed earlier.</p>
<p>Thus, we need to look deeper into our values. Some of my observations looking at the <code>SUBDISTRICT</code> and <code>Sub_District</code> values directly were that there were alternate ways of calling the same sub district. For example, “KRAMAT JATI” in combined_df, but “KRAMAT ATI” in jkt2019.</p>
<p>The code chunk below further explores the unique values of sub districts found in count_subdistrict but not in bd_subdistrict and vice versa.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>count_subdistrict <span class="ot">&lt;-</span> <span class="fu">c</span>(combined_df<span class="sc">$</span>SUBDISTRICT)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>bd_subdistrict <span class="ot">&lt;-</span> <span class="fu">c</span>(jkt2019<span class="sc">$</span>Sub_District)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Aspatial SUBDISTRICT:</span><span class="sc">\n</span><span class="st">__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(count_subdistrict[<span class="sc">!</span>(count_subdistrict <span class="sc">%in%</span> bd_subdistrict)])</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique Geospatial Sub_District:</span><span class="sc">\n</span><span class="st">__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bd_subdistrict[<span class="sc">!</span>(bd_subdistrict <span class="sc">%in%</span> count_subdistrict)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The table below compiles the mismatched records of the subdistricts between the two dataframes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise a dataframe of our cases vs bd subdistrict spelling</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>spelling <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Aspatial_Count=</span><span class="fu">c</span>(<span class="st">"BALE KAMBANG"</span>, <span class="st">"HALIM PERDANA KUSUMAH"</span>, <span class="st">"JATI PULO"</span>, <span class="st">"KALI BARU"</span>, <span class="st">"KAMPUNG TENGAH"</span>, <span class="st">"KRAMAT JATI"</span>, <span class="st">"KERENDANG"</span>, <span class="st">"PAL MERIAM"</span>, <span class="st">"PINANG RANTI"</span>, <span class="st">"RAWA JATI"</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Geospatial_BD=</span><span class="fu">c</span>(<span class="st">"BALEKAMBAG"</span>, <span class="st">"HALIM PERDANA KUSUMA"</span>, <span class="st">"JATIPULO"</span>, <span class="st">"KALIBARU"</span>, <span class="st">"TENGAH"</span>, <span class="st">"KRAMATJATI"</span>, <span class="st">"KRENDANG"</span>, <span class="st">"PALMERIAM"</span>, <span class="st">"PINANGRANTI"</span>, <span class="st">"RAWAJATI"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>spelling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we need to rectify the mismatched subdistricts names.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># where jkt2019 is a mismatched value, replace with the correct value</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'BALEKAMBANG'</span>] <span class="ot">&lt;-</span> <span class="st">'BALE KAMBANG'</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'HALIM PERDANA KUSUMA'</span>] <span class="ot">&lt;-</span> <span class="st">'HALIM PERDANA KUSUMAH'</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'JATIPULO'</span>] <span class="ot">&lt;-</span> <span class="st">'JATI PULO'</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KALI BARU'</span>] <span class="ot">&lt;-</span> <span class="st">'KALIBARU'</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'TENGAH'</span>] <span class="ot">&lt;-</span> <span class="st">'KAMPUNG TENGAH'</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KRAMATJATI'</span>] <span class="ot">&lt;-</span> <span class="st">'KRAMAT JATI'</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KRENDANG'</span>] <span class="ot">&lt;-</span> <span class="st">'KERENDANG'</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'PALMERIAM'</span>] <span class="ot">&lt;-</span> <span class="st">'PAL MERIAM'</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'PINANGRANTI'</span>] <span class="ot">&lt;-</span> <span class="st">'PINANG RANTI'</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'RAWAJATI'</span>] <span class="ot">&lt;-</span> <span class="st">'RAWA JATI'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Rejoining the two dataframes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(jkt2019, combined_df,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Sub_District"</span><span class="ot">=</span><span class="st">"SUBDISTRICT"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># double check of any missing values</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(combined_jakarta))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#which(is.na(combined_jakarta))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once again, let’s visualise it!<br>
</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>updated_target_count <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TARGET"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Updated Target Vacinated Count"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>updated_yet_to_be_count <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"YET_TO_BE_VACINATED"</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Updated TO Be Vaccinated Count"</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(updated_target_count, updated_yet_to_be_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculation-monthly-vaccination-rates" class="level1">
<h1>5. Calculation: Monthly Vaccination Rates</h1>
<p>To calculate the monthly vaccination rates, I will be using this formula:</p>
<p><span class="math inline">\(Vaccination Rate (\%) =\frac{Target - Yet To Be Vaccinated}{Target} * 100\)</span></p>
<p>where Target refers to target population to get vaccinated and YetToBeVacinated refers to population who have not been vaccinated yet. Essentially, the vaccination rate is derived from taking count of people who are vaccinated over count of people who are supposed to be vaccinated.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grouping based on the sub-district and time_period</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(jkt2019, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"SUBDISTRICT"</span> <span class="ot">=</span> <span class="st">"Sub_District"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SUBDISTRICT, TIME_PERIOD) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">vaccination_rates</span><span class="st">`</span> <span class="ot">=</span> ((<span class="fu">sum</span>(TARGET<span class="sc">-</span>YET_TO_BE_VACINATED)<span class="sc">/</span><span class="fu">sum</span>(TARGET))<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#afterwards, pivots the table based on the Dates, showing the cumulative death rate</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> TIME_PERIOD,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> vaccination_rates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The output of the code chunk below shows monthly vaccination rates across each sub-district from a study period of July 2021 to June 2022.</p>
<p>Convert our dataframes into sf objects</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(combined_jakarta)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> vr<span class="sc">%&gt;%</span> <span class="fu">left_join</span>(jkt2019, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"SUBDISTRICT"</span><span class="ot">=</span><span class="st">"Sub_District"</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(vr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mapping-of-monthly-vaccination-rates" class="level1">
<h1>6. Mapping of Monthly Vaccination Rates</h1>
<p>There are different <a href="https://storymaps.arcgis.com/stories/bcb8e509f319436786a2481c722bc218">methods</a> to classify the vaccination rates in choropleth maps. Initially, I considered Jenks classification method as it can minimize variation in each group which allows map readers to easily witness the trends presented by the map. However, this method is not very suitable for our data as it has low variance.</p>
<p>The code chunk below shows the decreasing variance as time passes through the period of July 2021 to June 2022.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-07-01</span><span class="st">`</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-10-01</span><span class="st">`</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-02-01</span><span class="st">`</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-06-01</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To get a clearer visualization of a specific month, I decided to use the classification method, cont as it creates a smooth, linear gradient in which the change in values is proportionally related to the change in colors. For the color palette, i decided to go with a sequential scheme from yellow to green as it more suited for ordered data that progress from low to high.</p>
<p>The code chunk below is an interactive map of vaccination rates in July 2021. By clicking on a certain location, it will show us the district name and respective vaccination rates. The darker the green, the higher the vaccination rates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">"2021-07-01"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Vaccination Rates in July 2021"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height =</span> <span class="fl">0.5</span>, </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Insights:</p>
<ol type="1">
<li><p>The sub-district with the lowest vaccination rate is CIPINANG BESAR UTARA (23.15%).</p></li>
<li><p>The sub-district with the highest vaccination rate is HALIM PERDANA KUSUMAH (55.24%).</p></li>
<li><p>Not much clusters can be identified.</p></li>
<li><p>Sub-districts with lower vaccination rates can try to learn/adopt strategies from sub districts with higher vaccination rates’ to increase their own vaccination rates.</p></li>
</ol>
<p>The code chunk below is an interactive map of vaccination rates in June 2022.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">"2022-06-01"</span>, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Vaccination Rates in June 2022"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height =</span> <span class="fl">0.5</span>, </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Insights (as compared to July 2021):</p>
<ol type="1">
<li><p>The sub-district with the lowest vaccination rate is no longer CIPINANG BESAR UTARA(81.79%) but KEBON MELATI (78.13%). However, the lowest vaccination rate in June 2022 is still much higher than the the highest vaccination rate in July 2021 (55.24%).</p></li>
<li><p>The sub-district with highest vaccination rate is the same, HALIM PERDANA KUSUMAH (89.76%).</p></li>
<li><p>The bottom half sub-districts tend to have a higher vaccination rate than the top half sub-districts.</p></li>
<li><p>Thus, we can infer that within a span of 1 year, the vaccination rates across the sub-districts in Jakarta have increased.</p></li>
</ol>
<p>The code chunk below plots the vaccination rate across the our study period of July 2021 to June 2022. The data is classified using manually. The breakpoints are 20, 40, 60, 80, 100.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>rate_cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(<span class="fu">st_set_geometry</span>(vr[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>], <span class="cn">NULL</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>rate_cols</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>map_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(rate_cols))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rate_cols)) {</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  cmap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(rate_cols[[i]], </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">#style = "cont",</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.labels =</span> rate_cols[[i]],</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.label.color =</span> <span class="st">'gray12'</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.label.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.show =</span> <span class="cn">FALSE</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  map_list[[i]] <span class="ot">&lt;-</span> cmap</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map_list, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Insights:</p>
<ol type="1">
<li><p>We can actually see Jakarta’s vaccination rate increase steadily across the period of July 2021 to February 2022.</p></li>
<li><p>However, from February 2022 to June 2022, there is not much difference in the vaccination rates across all sub-districts.</p></li>
</ol>
</section>
<section id="local-gi-analysis" class="level1">
<h1>7. Local Gi* Analysis</h1>
<p>Computing local Gi* statistics</p>
<p>To detect hot spot areas with high vaccination rates, and cold spot areas with high vaccination rates in Jakarta, we will be using Getis-Ord Gi* statistics. Time-series analysis will also be conducted to understand the evolution of spatial hot spots and cold spots across the time period of July 2021 to June 2022.</p>
<p>For Interpretation of Gi* values:</p>
<p><span class="math inline">\(Gi∗&gt;0\)</span> : indicates grouping of areas with values higher than average</p>
<p><span class="math inline">\(Gi∗&lt;0\)</span> : indicates grouping of areas with values lower than average</p>
<p>A larger magnitude represents a greater intensity of grouping.</p>
<p>For significant Gi* statistic values, two spatial associations can be inferred:</p>
<ul>
<li><p><strong>Hot spot areas:</strong> where <span class="math inline">\(Gi∗&gt;0\)</span>, significant and positive, if location is associated with relatively high values of the surrounding locations.</p></li>
<li><p><strong>Cold spot areas:</strong> where <span class="math inline">\(Gi∗&lt;0\)</span>, significant and negative, if location is associated with relatively low values in surrounding locations</p></li>
</ul>
<p><strong>Compute local Gi* of vaccination rates in July 2022</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>wm_idw <span class="ot">&lt;-</span> vr <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">st_contiguity</span>(geometry),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">wts =</span> <span class="fu">st_inverse_distance</span>(nb, geometry,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#monthly vaccination rate for July_2021</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>HCSA_july2021 <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-07-01</span><span class="st">`</span>, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>HCSA_july2021</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of "</span>,<span class="st">"July 2021"</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"p-value of Gi*"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map1, map2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we are ready to plot the significant (i.e.&nbsp;p-values less than 0.05) hot spot and cold spot areas by using appropriate tmap functions as shown below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>HCSA_sig_july2021 <span class="ot">&lt;-</span> HCSA_july2021  <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_sig_july2021) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Hot and Cold Spot Areas of Vaccination Rates in July 2021"</span>, <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Observation:</p>
<ol type="1">
<li>The are 6 hot spot areas and 1 cold spot area.</li>
</ol>
<p>Perform the same steps as above to compute local Gi* in June 2022.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>HCSA_june2022 <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-06-01</span><span class="st">`</span>, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>HCSA_june2022</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we are ready to plot the significant (i.e.&nbsp;p-values less than 0.05) hot spot and cold spot areas in June 2022 by using appropriate tmap functions as shown below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>HCSA_sig_june2022 <span class="ot">&lt;-</span> HCSA_june2022  <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_june2022) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_sig_june2022) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Hot and Cold Spot Areas of Vaccination Rates in June 2022"</span>, <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Observation:</p>
<ol type="1">
<li>There is only 1 hot spot area and 1 cold spot area.</li>
</ol>
<p>Comparison:</p>
<p>Comparing both maps of Hot and Cold Spot Areas of Vaccination Rates in July 2021 and June 2022, we can observe that</p>
<ol type="1">
<li><p>The intensity of Gi* value has changed. The lowest range of Gi* value change from -4 to -2 to -6 to -4.</p></li>
<li><p>The significant hot and cold spot locations have changed. Over 1 year, the hot spot shifted downwards while the cold spot locations lessened and becomes more clustered in the center of Jakarta.</p></li>
<li><p>In June 2022, the hot spot location is associated with relatively higher values of the surrounding locations as compared to July 2021.</p></li>
<li><p>The no. of hot spot areas has decreased from 6 to 1.</p></li>
</ol>
</section>
<section id="emerging-hot-spot-analysisehsa" class="level1">
<h1>8. Emerging Hot Spot Analysis(EHSA)</h1>
<p>To organise our data, we first have to create a df with the data organised in the following format: Date, Sub_District and Vaccination_Rate.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract relevant columns</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> combined_jakarta[<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate vaccination rates</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">VACCINATION_RATES =</span> (TARGET <span class="sc">-</span> YET_TO_BE_VACINATED)<span class="sc">/</span>TARGET <span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#drop target and yet to be vaccinated</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">=</span> <span class="fu">subset</span>(copy_cjkt_df, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Total_Population,CITY_AREA,DISTRICT,TARGET,YET_TO_BE_VACINATED) )</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#for clarity, reorder the columns to time period, subdistrict, vaccination rates</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df<span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(VACCINATION_RATES, <span class="at">.after=</span>Sub_District)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df<span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(TIME_PERIOD)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(copy_cjkt_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Sub_District"</span>,<span class="st">"Vaccination_Rate"</span>,<span class="st">"geometry"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(copy_cjkt_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(copy_cjkt_df)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#class(copy_cjkt_df$TIME_PERIOD)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#typeof(copy_cjkt_df$TIME_PERIOD)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below creates a time series cube using spacetime() of sfdep package:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>vr_st<span class="ot">&lt;-</span> <span class="fu">as_spacetime</span>(copy_cjkt_df,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">.loc_col =</span> <span class="st">"Sub_District"</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">.time_col =</span> <span class="st">"Date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>By using is_spacetime_cube() of sfdep package, we can check if vacc_rate_st is indeed a space-time cube object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(vr_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>vr_nb <span class="ot">&lt;-</span> vr_st <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(<span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">wt =</span> <span class="fu">st_inverse_distance</span>(nb, geometry,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">scale=</span><span class="dv">1</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha=</span><span class="dv">1</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vr_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> vr_nb <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    Vaccination_Rate, nb, wt, <span class="at">nsim=</span><span class="dv">99</span>)) <span class="sc">|&gt;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb60" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Assignment 2: Spatio-temporal Analysis of COVID-19 Vaccination Trends at the Sub-district Level, DKI Jakarta"</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "20 february 2023"</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Rhonda Ho Kah Yee"</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">      code-fold: true</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">      code-tools: true</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: false</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Overview</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>Hello! This is Rhonda Ho's take-home Assignment 2 for IS415 module.</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>To view/hide all the code at once, please click on the "<span class="sc">\&lt;</span>/<span class="sc">\&gt;</span> code" tab beside the title of this html document and select the option to view/hide the code.</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>The full details of this assignment can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://is415-ay2022-23t2.netlify.app/th_ex2.html)</span>.</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Objectives</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>Exploratory Spatial Data Analysis (ESDA) hold tremendous potential to address complex problems facing society. In this study, you are tasked to apply appropriate Local Indicators of Spatial Association (LISA) and Emerging Hot Spot Analysis (EHSA) to undercover the spatio-temporal trends of COVID-19 vaccination in DKI Jakarta.</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 The Data</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Aspatial data**</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>For the purpose of this assignment, data from <span class="co">[</span><span class="ot">Riwayat File Vaksinasi DKI Jakarta</span><span class="co">](https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/)</span> will be used. Daily vaccination data are provided. We are only required to download either the first day of the month or last day of the month of the study period.</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Geospatial data**</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>For the purpose of this study, DKI Jakarta administration boundary 2019 will be used. The data set can be downloaded at Indonesia Geospatial portal, specifically at <span class="co">[</span><span class="ot">this page</span><span class="co">](https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html)</span>.</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The national Projected Coordinates Systems of Indonesia is DGN95 / Indonesia TM-3 zone 54.1.</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Exclude all the outer islands from the DKI Jakarta sf data frame, and</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain the first nine fields in the DKI Jakarta sf data frame. The ninth field JUMLAH_PEN = Total Population.</span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 Tasks</span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>The specific tasks of this take-home exercise are as follows:</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Choropleth Mapping and Analysis**</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Compute the monthly vaccination rate from July 2021 to June 2022 at sub-district (also known as kelurahan in Bahasa Indonesia) level,</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Prepare the monthly vaccination rate maps by using appropriate tmap functions,</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Describe the spatial patterns revealed by the choropleth maps (not more than 200 words).</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Local Gi\* Analysis**</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>    With reference to the vaccination rate maps prepared in ESDA:</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Compute local Gi<span class="sc">\*</span> values of the monthly vaccination rate,</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Display the Gi<span class="sc">\*</span> maps of the monthly vaccination rate. The maps should only display the significant (i.e.&nbsp;p-value <span class="sc">\&lt;</span> 0.05)</span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the analysis results, draw statistical conclusions (not more than 250 words).</span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Emerging Hot Spot Analysis(EHSA)**</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>    With reference to the local Gi<span class="sc">\*</span> values of the vaccination rate maps prepared in the previous section:</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Perform Mann-Kendall Test by using the spatio-temporal local Gi<span class="sc">\*</span> values,</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Select three sub-districts and describe the temporal trends revealed (not more than 250 words), and</span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Prepared a EHSA map of the Gi<span class="sc">\*</span> values of vaccination rate. The maps should only display the significant (i.e.&nbsp;p-value <span class="sc">\&lt;</span> 0.05).\</span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the EHSA map prepared, describe the spatial patterns revealed. (not more than 250 words).</span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Getting Started</span></span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>The following packages will be used:</span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sf**</span><span class="co">](https://cran.r-project.org/web/packages/sf/index.html)</span>: used for importing, managing, and processing geospatial data</span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tidyverse**</span><span class="co">](https://www.tidyverse.org/)</span>: a collection of packages for data science tasks</span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tmap**</span><span class="co">](https://cran.r-project.org/web/packages/tmap/index.html)</span>: used for creating thematic maps, such as choropleth and bubble maps</span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**spatstat**</span><span class="co">](https://spatstat.org/)</span>: used for point pattern analysis</span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**raster**</span><span class="co">](https://cran.r-project.org/web/packages/raster/)</span>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**funModeling**</span><span class="co">](https://cran.r-project.org/web/packages/funModeling/index.html)</span>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**maptools**</span><span class="co">](https://cran.r-project.org/web/packages/maptools/index.html)</span>: a set of tools for manipulating geographic data and</span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sfdep**</span><span class="co">](https://cran.r-project.org/web/packages/spdep/index.html)</span>: for performing geospatial data wrangling and local colocation quotient analysis.</span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, spatstat, raster, funModeling, maptools, sfdep, readxl, tidyverse)</span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Data Wrangling</span></span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Geospatial Data</span></span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.1 Import shapefile into r environment</span></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA"</span>) </span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a>From the output, we can observe that:</span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Geometry type is MULTIPOLYGON</span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>CRS information is <span class="co">[</span><span class="ot">WGS 84</span><span class="co">](https://epsg.io/4326)</span> instead of the CRS for Indonesia, Jakarta.</span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.2 Identifying Relevant Columns</span></span>
<span id="cb60-131"><a href="#cb60-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-134"><a href="#cb60-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-135"><a href="#cb60-135" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(jkt2019)</span>
<span id="cb60-136"><a href="#cb60-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-137"><a href="#cb60-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-138"><a href="#cb60-138" aria-hidden="true" tabindex="-1"></a>Having a glimpse at our data, some of relevant column(s) that we need for our task is:</span>
<span id="cb60-139"><a href="#cb60-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-140"><a href="#cb60-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`KAB_KOTA`</span> : represents the cities in Jakarta</span>
<span id="cb60-141"><a href="#cb60-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-142"><a href="#cb60-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`KECAMATAN`</span> : represents the district in Jakarta</span>
<span id="cb60-143"><a href="#cb60-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-144"><a href="#cb60-144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DESA_KELUR`</span> : represents the sub-districts in Jakarta.</span>
<span id="cb60-145"><a href="#cb60-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-146"><a href="#cb60-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.3 Data Pre-Processing</span></span>
<span id="cb60-147"><a href="#cb60-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-148"><a href="#cb60-148" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.1.3.1 Check for Invalid Geometries</span></span>
<span id="cb60-149"><a href="#cb60-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-152"><a href="#cb60-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-153"><a href="#cb60-153" aria-hidden="true" tabindex="-1"></a><span class="co">#check for invalid geometries</span></span>
<span id="cb60-154"><a href="#cb60-154" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(jkt2019) <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb60-155"><a href="#cb60-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-156"><a href="#cb60-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-157"><a href="#cb60-157" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.1.3.2 Check for Missing Values</span></span>
<span id="cb60-158"><a href="#cb60-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-161"><a href="#cb60-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-162"><a href="#cb60-162" aria-hidden="true" tabindex="-1"></a><span class="co">#check for missing values</span></span>
<span id="cb60-163"><a href="#cb60-163" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(jkt2019))</span>
<span id="cb60-164"><a href="#cb60-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-165"><a href="#cb60-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-166"><a href="#cb60-166" aria-hidden="true" tabindex="-1"></a>Based on the output, we have discovered that there are 14 missing values in our dataset which may affect our analysis. Thus, I removed all missing values in the sub-districts(a part of our main study focus), using the code chunk below.</span>
<span id="cb60-167"><a href="#cb60-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-170"><a href="#cb60-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-171"><a href="#cb60-171" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(jkt2019,<span class="fu">c</span>(<span class="st">"DESA_KELUR"</span>))</span>
<span id="cb60-172"><a href="#cb60-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-173"><a href="#cb60-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-174"><a href="#cb60-174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.1.3.3 Transformation of Coordinates Information</span></span>
<span id="cb60-175"><a href="#cb60-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-176"><a href="#cb60-176" aria-hidden="true" tabindex="-1"></a>Earlier on, we discovered that the assigned coordinates system of our data is WGS 84 which is not appropriate for an Indonesian-specific geospatial dataset. Another way of checking it is using the function, <span class="co">[</span><span class="ot">st_crs()</span><span class="co">](https://www.rdocumentation.org/packages/sf/versions/1.0-9/topics/st_crs)</span>.</span>
<span id="cb60-177"><a href="#cb60-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-180"><a href="#cb60-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-181"><a href="#cb60-181" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether need to transform</span></span>
<span id="cb60-182"><a href="#cb60-182" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(jkt2019)</span>
<span id="cb60-183"><a href="#cb60-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-184"><a href="#cb60-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-185"><a href="#cb60-185" aria-hidden="true" tabindex="-1"></a>As this is an Indonesian-specific geospatial dataset, I will be using <span class="co">[</span><span class="ot">EPSG:23845.</span><span class="co">](https://epsg.io/23845)</span></span>
<span id="cb60-186"><a href="#cb60-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-189"><a href="#cb60-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-190"><a href="#cb60-190" aria-hidden="true" tabindex="-1"></a><span class="co"># transforms the CRS to DGN95, ESPG code 23845</span></span>
<span id="cb60-191"><a href="#cb60-191" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(jkt2019, <span class="dv">23845</span>)</span>
<span id="cb60-192"><a href="#cb60-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-193"><a href="#cb60-193" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(jkt2019)</span>
<span id="cb60-194"><a href="#cb60-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-195"><a href="#cb60-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-196"><a href="#cb60-196" aria-hidden="true" tabindex="-1"></a>Yay, we have successfully managed to transform our dataset to the appropriate coordinates system!</span>
<span id="cb60-197"><a href="#cb60-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-198"><a href="#cb60-198" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **3.1.3.4 Removal of Outer Islands**</span></span>
<span id="cb60-199"><a href="#cb60-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-200"><a href="#cb60-200" aria-hidden="true" tabindex="-1"></a>To start off, let visualise our data!</span>
<span id="cb60-201"><a href="#cb60-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-204"><a href="#cb60-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-205"><a href="#cb60-205" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(jkt2019))</span>
<span id="cb60-206"><a href="#cb60-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-207"><a href="#cb60-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-208"><a href="#cb60-208" aria-hidden="true" tabindex="-1"></a>The visualisation above shows that our data consist of outer islands beyond Jakarta. As this is not important for our analysis, we should remove it.</span>
<span id="cb60-209"><a href="#cb60-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-210"><a href="#cb60-210" aria-hidden="true" tabindex="-1"></a>Previously, we have identified 3 important attributes which represents the divisions of Jakarta. They are <span class="in">`KAB_KOTA`</span> (City), <span class="in">`KECAMATAN`</span> (District) and <span class="in">`DESA_KELUR`</span> (Village). Removing the outer islands by the City would help us to remove all the districts and villages within it, so I proceeded to check the unique values of it.</span>
<span id="cb60-211"><a href="#cb60-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-214"><a href="#cb60-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-215"><a href="#cb60-215" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(jkt2019<span class="sc">$</span><span class="st">"KAB_KOTA"</span>)</span>
<span id="cb60-216"><a href="#cb60-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-217"><a href="#cb60-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-218"><a href="#cb60-218" aria-hidden="true" tabindex="-1"></a>From this, we can observe that all the values has "JAKARTA" in it except "KEPULAUAN SERIBU"(Thousand Island). The code chunk below visualises the different cities in Jakarta.</span>
<span id="cb60-219"><a href="#cb60-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-222"><a href="#cb60-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-223"><a href="#cb60-223" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(jkt2019) <span class="sc">+</span> </span>
<span id="cb60-224"><a href="#cb60-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"KAB_KOTA"</span>)</span>
<span id="cb60-225"><a href="#cb60-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-226"><a href="#cb60-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-227"><a href="#cb60-227" aria-hidden="true" tabindex="-1"></a>Next, we will need to remove the outer islands by using the <span class="co">[</span><span class="ot">filter()</span><span class="co">](https://www.educative.io/answers/what-is-the-filter-method-in-r)</span> function to filter out the outer islands.</span>
<span id="cb60-228"><a href="#cb60-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-231"><a href="#cb60-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-232"><a href="#cb60-232" aria-hidden="true" tabindex="-1"></a><span class="co"># accepts only if the value of KAB_KOTA is NOT KEPULAUAN SERIBU</span></span>
<span id="cb60-233"><a href="#cb60-233" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> <span class="fu">filter</span>(jkt2019, KAB_KOTA <span class="sc">!=</span> <span class="st">"KEPULAUAN SERIBU"</span>)</span>
<span id="cb60-234"><a href="#cb60-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-235"><a href="#cb60-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-236"><a href="#cb60-236" aria-hidden="true" tabindex="-1"></a>For this assignment, we are required to only retain the first 9 fields.</span>
<span id="cb60-237"><a href="#cb60-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-240"><a href="#cb60-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-241"><a href="#cb60-241" aria-hidden="true" tabindex="-1"></a><span class="co"># filters out other fields by accepting only the first 9 fields</span></span>
<span id="cb60-242"><a href="#cb60-242" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> jkt2019[, <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb60-243"><a href="#cb60-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-244"><a href="#cb60-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-245"><a href="#cb60-245" aria-hidden="true" tabindex="-1"></a>For easier comprehension of our data, I have decided to translate the column headers to English.</span>
<span id="cb60-246"><a href="#cb60-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-249"><a href="#cb60-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-250"><a href="#cb60-250" aria-hidden="true" tabindex="-1"></a>jkt2019 <span class="ot">&lt;-</span> jkt2019 <span class="sc">%&gt;%</span> </span>
<span id="cb60-251"><a href="#cb60-251" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb60-252"><a href="#cb60-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">Object_ID=</span>OBJECT_ID,</span>
<span id="cb60-253"><a href="#cb60-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">Province=</span>PROVINSI, </span>
<span id="cb60-254"><a href="#cb60-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">City=</span>KAB_KOTA, </span>
<span id="cb60-255"><a href="#cb60-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">District=</span>KECAMATAN, </span>
<span id="cb60-256"><a href="#cb60-256" aria-hidden="true" tabindex="-1"></a>    <span class="at">Village_Code=</span>KODE_DESA, </span>
<span id="cb60-257"><a href="#cb60-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">Village=</span>DESA, </span>
<span id="cb60-258"><a href="#cb60-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sub_District=</span>DESA_KELUR,</span>
<span id="cb60-259"><a href="#cb60-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">Code=</span>KODE, </span>
<span id="cb60-260"><a href="#cb60-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Population=</span>JUMLAH_PEN</span>
<span id="cb60-261"><a href="#cb60-261" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-262"><a href="#cb60-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-263"><a href="#cb60-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-264"><a href="#cb60-264" aria-hidden="true" tabindex="-1"></a>With that, we are done for our geospatial data!</span>
<span id="cb60-265"><a href="#cb60-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-266"><a href="#cb60-266" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 Aspatial Data</span></span>
<span id="cb60-267"><a href="#cb60-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-268"><a href="#cb60-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2.1 Observations of Data Website</span></span>
<span id="cb60-269"><a href="#cb60-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-270"><a href="#cb60-270" aria-hidden="true" tabindex="-1"></a>Examining DKI Jakarta Vaccination File History <span class="co">[</span><span class="ot">website</span><span class="co">](https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/)</span>, some of my observations were:</span>
<span id="cb60-271"><a href="#cb60-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-272"><a href="#cb60-272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Entire page is in Indonesian</span>
<span id="cb60-273"><a href="#cb60-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-274"><a href="#cb60-274" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>To translate to English, simply right click anywhere on the webpage and click "Translate to English" button</span>
<span id="cb60-275"><a href="#cb60-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-276"><a href="#cb60-276" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Alternative solutions for translation can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.wikihow.com/Translate-a-Web-Page)</span>.</span>
<span id="cb60-277"><a href="#cb60-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-278"><a href="#cb60-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There were two columns for DKI Jakarta Vaccination File History, one for "*Vaccination Data Based on Village and District*", another for "*RT-Based Vaccination Data*"</span>
<span id="cb60-279"><a href="#cb60-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-280"><a href="#cb60-280" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We will be focusing on the "V*accination Data Based on Village and District*"column as our task require us to analyse on a sub-district level.</span>
<span id="cb60-281"><a href="#cb60-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-282"><a href="#cb60-282" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Many instances of missing data!</span>
<span id="cb60-283"><a href="#cb60-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-284"><a href="#cb60-284" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>E.g 1) The hyperlink to March 1 2022 will direct you to March 2 2022 data and March 1 2022 cannot be found :(</span>
<span id="cb60-285"><a href="#cb60-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-286"><a href="#cb60-286" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>E.g 2) Certain months such as July 2021, August 2021, February 2022 were missing the record of the date written in the table and its respective data</span>
<span id="cb60-287"><a href="#cb60-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-288"><a href="#cb60-288" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>A few examples of missing records are 19 July 2021, 28 August 2022, 11 September, 28 February 2022, 17 March 2022</span>
<span id="cb60-289"><a href="#cb60-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-290"><a href="#cb60-290" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Upon further research and some of my assumptions, missing data can be due to:</span>
<span id="cb60-291"><a href="#cb60-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-292"><a href="#cb60-292" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>A glitch in the system, which prevents the data from being uploaded</span>
<span id="cb60-293"><a href="#cb60-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-294"><a href="#cb60-294" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>An update of the system which may prevent records from being uploaded on that day</span>
<span id="cb60-295"><a href="#cb60-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-296"><a href="#cb60-296" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Data not recorded as there is no available data due to the day being a holiday</span>
<span id="cb60-297"><a href="#cb60-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-298"><a href="#cb60-298" aria-hidden="true" tabindex="-1"></a><span class="ss">                -   </span>For e.g 28 February 2022 record and data is missing and that day so happens to be an Indonesian major holiday called <span class="co">[</span><span class="ot">Isra Mi'raj</span><span class="co">](https://publicholidays.co.id/isra-miraj/)</span>. Upon further <span class="co">[</span><span class="ot">research</span><span class="co">](https://www.3ecpa.co.id/resources/indonesia-public-holidays/isra-miraj/#:~:text=They%20walk%20in%20the%20city,Indonesia%20during%20Isra%20Mi'raj.)</span>, Indonesians celebrate that day by gathering at their local mosque for prayers and/or will be walking in the city going to the city hall while chanting the Salawat. Thus, there is a high possibility that people will not get vaccinated on this specific day.</span>
<span id="cb60-299"><a href="#cb60-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-300"><a href="#cb60-300" aria-hidden="true" tabindex="-1"></a><span class="ss">                -   </span>For reference, the list of holidays for <span class="co">[</span><span class="ot">2021</span><span class="co">](https://www.officeholidays.com/countries/indonesia/2021)</span>and <span class="co">[</span><span class="ot">2022</span><span class="co">](https://publicholidays.co.id/2022-dates/)</span>.</span>
<span id="cb60-301"><a href="#cb60-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-302"><a href="#cb60-302" aria-hidden="true" tabindex="-1"></a><span class="ss">                -   </span>However, there are also days where it is a holiday but vaccination data is still being recorded such as 1 January 2022 (New Year's Day) and 1 May 2022(Labour Day). A possible reason could be that, assuming Indonesia is similar to Singapore, certain clinics will still be opened but only for selected hours.</span>
<span id="cb60-303"><a href="#cb60-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-304"><a href="#cb60-304" aria-hidden="true" tabindex="-1"></a>Under our task we are required to compute monthly vaccination rate from <span class="co">[</span><span class="ot">July 2021 to June 2022</span><span class="co">]</span>{.underline} and we are only required to download the <span class="co">[</span><span class="ot">first or last day of the month of study period</span><span class="co">]</span>{.underline}.</span>
<span id="cb60-305"><a href="#cb60-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-306"><a href="#cb60-306" aria-hidden="true" tabindex="-1"></a>For this assignment, I will be using data of the first day of each month of the study period with the exception of March 2021, I will be using March 2 instead of March 1 as March 1's data is missing.</span>
<span id="cb60-307"><a href="#cb60-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-308"><a href="#cb60-308" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2.2 Importing Aspatial Data</span></span>
<span id="cb60-309"><a href="#cb60-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-310"><a href="#cb60-310" aria-hidden="true" tabindex="-1"></a>In our 'data/aspatial' folder, we have downloaded multiple .xlsx files ranging from 1 July 2021 to 1 June 2022. But before we compile it together, we need to understand each dataset and check for any discrepancies.</span>
<span id="cb60-311"><a href="#cb60-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-312"><a href="#cb60-312" aria-hidden="true" tabindex="-1"></a>The purpose of the code chunk below is to reach each excel file under the folder 'data/aspatial' , create its dataframe(df) and assign it to a variable name which is in the format of "month_year". E.g April_2022 . The following functions are used:</span>
<span id="cb60-313"><a href="#cb60-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-314"><a href="#cb60-314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">list.files():</span><span class="co">](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/list.files)</span> creates a list of the files in a directory/folder</span>
<span id="cb60-315"><a href="#cb60-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-316"><a href="#cb60-316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">substr():</span><span class="co">](https://www.digitalocean.com/community/tutorials/substring-function-in-r)</span> extract the characters present in the data</span>
<span id="cb60-317"><a href="#cb60-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-318"><a href="#cb60-318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">str_trim():</span><span class="co">](https://stringr.tidyverse.org/reference/str_trim.html)</span> remove whitespace</span>
<span id="cb60-319"><a href="#cb60-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-320"><a href="#cb60-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">paste():</span><span class="co">](https://www.digitalocean.com/community/tutorials/paste-in-r)</span> concatenate strings and values into a single element</span>
<span id="cb60-321"><a href="#cb60-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-322"><a href="#cb60-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">read_excel()</span><span class="co">]</span>(https://readxl.tidyverse.org/reference/read_excel.html#:~:text=read_excel()%20calls%20excel_format(),file%20itself%2C%20in%20that%20order.): to read the data in xlsx format</span>
<span id="cb60-323"><a href="#cb60-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-324"><a href="#cb60-324" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">nchar():</span><span class="co">]</span>(https://www.geeksforgeeks.org/finding-the-length-of-string-in-r-programming-nchar-method/#:~:text=nchar()%20method%20in%20R,character%20in%20a%20string%20object.&amp;text=Where%3A%20String%20is%20object.,the%20length%20of%20a%20string.) gets the length of string</span>
<span id="cb60-325"><a href="#cb60-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-328"><a href="#cb60-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-329"><a href="#cb60-329" aria-hidden="true" tabindex="-1"></a><span class="co">#gets all files under the folder 'data/aspatial' which is in '.xlsx' format</span></span>
<span id="cb60-330"><a href="#cb60-330" aria-hidden="true" tabindex="-1"></a>study_period_data <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">'data/aspatial'</span>,<span class="at">pattern =</span> <span class="st">"*.xlsx"</span>)</span>
<span id="cb60-331"><a href="#cb60-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-332"><a href="#cb60-332" aria-hidden="true" tabindex="-1"></a><span class="co">#instantiate an empty list which will be used later to contain all the df names</span></span>
<span id="cb60-333"><a href="#cb60-333" aria-hidden="true" tabindex="-1"></a>df_list <span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb60-334"><a href="#cb60-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-335"><a href="#cb60-335" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> study_period_data){</span>
<span id="cb60-336"><a href="#cb60-336" aria-hidden="true" tabindex="-1"></a> <span class="co"># eg of x: Data Vaksinasi Berbasis Kelurahan (01 April 2022).xlsx</span></span>
<span id="cb60-337"><a href="#cb60-337" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-338"><a href="#cb60-338" aria-hidden="true" tabindex="-1"></a> <span class="co"># extract the year and month from the data file name</span></span>
<span id="cb60-339"><a href="#cb60-339" aria-hidden="true" tabindex="-1"></a> month_yr <span class="ot">&lt;-</span> <span class="fu">str_trim</span>(<span class="fu">substr</span>(x, <span class="dv">38</span>, <span class="fu">nchar</span>(x)<span class="sc">-</span><span class="dv">6</span>)) <span class="co">#e.g output: April 2022</span></span>
<span id="cb60-340"><a href="#cb60-340" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-341"><a href="#cb60-341" aria-hidden="true" tabindex="-1"></a> <span class="co">#split the month and year by the empty space inbetween</span></span>
<span id="cb60-342"><a href="#cb60-342" aria-hidden="true" tabindex="-1"></a> split_month_yr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(month_yr,<span class="st">" "</span>) <span class="co">#e.g output: [[1]][1]'April' '2022'</span></span>
<span id="cb60-343"><a href="#cb60-343" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-344"><a href="#cb60-344" aria-hidden="true" tabindex="-1"></a> <span class="co">#split_month_yr[[1]][1] shows the month, split_month_yr[[1]][2] shows the year </span></span>
<span id="cb60-345"><a href="#cb60-345" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-346"><a href="#cb60-346" aria-hidden="true" tabindex="-1"></a> <span class="co">#join the month and year with "_"</span></span>
<span id="cb60-347"><a href="#cb60-347" aria-hidden="true" tabindex="-1"></a> join_month_yr <span class="ot">&lt;-</span> <span class="fu">paste</span>(split_month_yr[[<span class="dv">1</span>]][<span class="dv">1</span>],split_month_yr[[<span class="dv">1</span>]][<span class="dv">2</span>],<span class="at">sep=</span><span class="st">"_"</span>) </span>
<span id="cb60-348"><a href="#cb60-348" aria-hidden="true" tabindex="-1"></a> <span class="co">#e.g output: April_2022</span></span>
<span id="cb60-349"><a href="#cb60-349" aria-hidden="true" tabindex="-1"></a> <span class="co">#join_month_yr will be used as the variable name to store the df</span></span>
<span id="cb60-350"><a href="#cb60-350" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-351"><a href="#cb60-351" aria-hidden="true" tabindex="-1"></a> <span class="co">#add each month name to list</span></span>
<span id="cb60-352"><a href="#cb60-352" aria-hidden="true" tabindex="-1"></a> df_list<span class="ot">&lt;-</span><span class="fu">append</span>(df_list,join_month_yr)</span>
<span id="cb60-353"><a href="#cb60-353" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-354"><a href="#cb60-354" aria-hidden="true" tabindex="-1"></a> <span class="co"># get filepath that we need to read each month's excel file</span></span>
<span id="cb60-355"><a href="#cb60-355" aria-hidden="true" tabindex="-1"></a> filepath <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"data/aspatial/"</span>,x,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb60-356"><a href="#cb60-356" aria-hidden="true" tabindex="-1"></a> <span class="co"># eg output: "data/aspatial/Data Vaksinasi Berbasis Kelurahan (01 April 2022).xlsx"</span></span>
<span id="cb60-357"><a href="#cb60-357" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb60-358"><a href="#cb60-358" aria-hidden="true" tabindex="-1"></a> <span class="co">#reach each excel file and assign it to its variable name </span></span>
<span id="cb60-359"><a href="#cb60-359" aria-hidden="true" tabindex="-1"></a> <span class="fu">assign</span>(join_month_yr,<span class="fu">read_excel</span>(filepath))</span>
<span id="cb60-360"><a href="#cb60-360" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-361"><a href="#cb60-361" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-362"><a href="#cb60-362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-363"><a href="#cb60-363" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb60-364"><a href="#cb60-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-365"><a href="#cb60-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-366"><a href="#cb60-366" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2.3 Data Pre-processing</span></span>
<span id="cb60-367"><a href="#cb60-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-368"><a href="#cb60-368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.2.3.1 Check for Duplicated Values</span></span>
<span id="cb60-369"><a href="#cb60-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-370"><a href="#cb60-370" aria-hidden="true" tabindex="-1"></a>To check for any duplicate columns for each dataset, I created a function called duplication_check() which takes in the df filename as a variable.</span>
<span id="cb60-371"><a href="#cb60-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-374"><a href="#cb60-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-375"><a href="#cb60-375" aria-hidden="true" tabindex="-1"></a>duplication_check <span class="ot">&lt;-</span> <span class="cf">function</span>(file_name) {</span>
<span id="cb60-376"><a href="#cb60-376" aria-hidden="true" tabindex="-1"></a>  duplicated_columns <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(<span class="fu">as.list</span>(file_name))</span>
<span id="cb60-377"><a href="#cb60-377" aria-hidden="true" tabindex="-1"></a>  duplicated_chara <span class="ot">&lt;-</span> <span class="fu">colnames</span>(file_name[duplicated_columns])</span>
<span id="cb60-378"><a href="#cb60-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(duplicated_chara)</span>
<span id="cb60-379"><a href="#cb60-379" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-380"><a href="#cb60-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-381"><a href="#cb60-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-382"><a href="#cb60-382" aria-hidden="true" tabindex="-1"></a>I then made use of df_list which I populated earlier on to contain all of our df names and looped through it. This allows me to check for each time period df, which df has duplicated columns using the function I created.</span>
<span id="cb60-383"><a href="#cb60-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-386"><a href="#cb60-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-387"><a href="#cb60-387" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> df_list) {</span>
<span id="cb60-388"><a href="#cb60-388" aria-hidden="true" tabindex="-1"></a>  duplicated_col <span class="ot">&lt;-</span> <span class="fu">duplication_check</span>(<span class="fu">get</span>(df))</span>
<span id="cb60-389"><a href="#cb60-389" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">identical</span>(duplicated_col, <span class="fu">character</span>(<span class="dv">0</span>))){</span>
<span id="cb60-390"><a href="#cb60-390" aria-hidden="true" tabindex="-1"></a>    duplicated_col<span class="ot">=</span><span class="st">"none"</span></span>
<span id="cb60-391"><a href="#cb60-391" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-392"><a href="#cb60-392" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-393"><a href="#cb60-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Under df"</span>, df, <span class="st">"| duplicated col:"</span>, <span class="fu">toString</span>(duplicated_col)))</span>
<span id="cb60-394"><a href="#cb60-394" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-395"><a href="#cb60-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-396"><a href="#cb60-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-397"><a href="#cb60-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-398"><a href="#cb60-398" aria-hidden="true" tabindex="-1"></a>Based on the output, we can observe that for df April_2022, Juni_2022 and Mei_2022. There is a duplicated column called <span class="in">`LANSIA\r\nDOSIS 3`</span>.</span>
<span id="cb60-399"><a href="#cb60-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-400"><a href="#cb60-400" aria-hidden="true" tabindex="-1"></a>Diving deeper into each dataset with a duplicated column with the use of glimpse(), we can observe that column <span class="in">`LANSIA\r\nDOSIS 3`</span> and column <span class="in">`LANSIA\r\nDOSIS 2`</span> are exactly the same.</span>
<span id="cb60-401"><a href="#cb60-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-404"><a href="#cb60-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-405"><a href="#cb60-405" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(April_2022)</span>
<span id="cb60-406"><a href="#cb60-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-407"><a href="#cb60-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-408"><a href="#cb60-408" aria-hidden="true" tabindex="-1"></a>**But how does this affect our dataset?**</span>
<span id="cb60-409"><a href="#cb60-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-410"><a href="#cb60-410" aria-hidden="true" tabindex="-1"></a>Upon translation, i discovered that <span class="in">`LANSIA\r\nDOSIS`</span> refers to elderly dosage.</span>
<span id="cb60-411"><a href="#cb60-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-412"><a href="#cb60-412" aria-hidden="true" tabindex="-1"></a>This means that in our datasets with duplicated columns, there is 4 related columns - Elderly Dosage 1, Elderly Dosage 2, Elderly Dosage 3, Total Elderly Dosage where Dosage 3 values are a repeat of Dosage 2 values.</span>
<span id="cb60-413"><a href="#cb60-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-414"><a href="#cb60-414" aria-hidden="true" tabindex="-1"></a>I suspected that the Total elderly vaccine delivered should be the sum of Elderly Dosage 1, 2 and 3. However, according to April_2022 df, total elderly vaccine delivered is 1536442 which is neither the sum of elderly dosage 1, 2 and 3 nor the sum of elderly dosage 1 and 2. This suggests that either the total sum is wrongly added or the values for elderly dosage 3 was input wrongly. Regardless, this reduces the reliability of those data columns.</span>
<span id="cb60-415"><a href="#cb60-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-416"><a href="#cb60-416" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.2.3.2 Check for Missing Values</span></span>
<span id="cb60-417"><a href="#cb60-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-418"><a href="#cb60-418" aria-hidden="true" tabindex="-1"></a>To check for missing values, I created a function, check_missing_value() and used it to check for each df.</span>
<span id="cb60-419"><a href="#cb60-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-422"><a href="#cb60-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-423"><a href="#cb60-423" aria-hidden="true" tabindex="-1"></a>check_missing_value <span class="ot">&lt;-</span> <span class="cf">function</span>(filename){</span>
<span id="cb60-424"><a href="#cb60-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(filename))</span>
<span id="cb60-425"><a href="#cb60-425" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-426"><a href="#cb60-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-427"><a href="#cb60-427" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> df_list) {</span>
<span id="cb60-428"><a href="#cb60-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">check_missing_value</span>(<span class="fu">get</span>(df)))</span>
<span id="cb60-429"><a href="#cb60-429" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-430"><a href="#cb60-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-431"><a href="#cb60-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-432"><a href="#cb60-432" aria-hidden="true" tabindex="-1"></a>Based on the output, I realised that all the df were missing 3 fields. Looking deeper, I realised it was the same 3 fields (1st row, first 3 columns) for all the df that were blank. The reason why it is empty is due to the fact that is was merged with the top column in the excel and the 1st row of each excel file was meant to represent the total dosages across all districts. Thus, we will be removing it later.</span>
<span id="cb60-433"><a href="#cb60-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-434"><a href="#cb60-434" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.2.3.3 Combination of every .xlsx Files</span></span>
<span id="cb60-435"><a href="#cb60-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-436"><a href="#cb60-436" aria-hidden="true" tabindex="-1"></a>Now, we need to combine the data files for every time period of our study period.</span>
<span id="cb60-437"><a href="#cb60-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-438"><a href="#cb60-438" aria-hidden="true" tabindex="-1"></a>**What are the relevant columns?**</span>
<span id="cb60-439"><a href="#cb60-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-440"><a href="#cb60-440" aria-hidden="true" tabindex="-1"></a>I would need to add the date and year in a new column</span>
<span id="cb60-441"><a href="#cb60-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-442"><a href="#cb60-442" aria-hidden="true" tabindex="-1"></a>need to convert to english language for easier comprehension</span>
<span id="cb60-443"><a href="#cb60-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-446"><a href="#cb60-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-447"><a href="#cb60-447" aria-hidden="true" tabindex="-1"></a><span class="co"># we can derive count of people who were vacinated by target - yet to be vacinated</span></span>
<span id="cb60-448"><a href="#cb60-448" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df_str <span class="cf">in</span> df_list) {</span>
<span id="cb60-449"><a href="#cb60-449" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span><span class="fu">get</span>(df_str)</span>
<span id="cb60-450"><a href="#cb60-450" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-451"><a href="#cb60-451" aria-hidden="true" tabindex="-1"></a>  new_df<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb60-452"><a href="#cb60-452" aria-hidden="true" tabindex="-1"></a>    <span class="co">#extract relevant columns</span></span>
<span id="cb60-453"><a href="#cb60-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'WILAYAH KOTA'</span>, <span class="co"># CITY AREA</span></span>
<span id="cb60-454"><a href="#cb60-454" aria-hidden="true" tabindex="-1"></a>             <span class="st">'KECAMATAN'</span>, <span class="co"># DISTRICT</span></span>
<span id="cb60-455"><a href="#cb60-455" aria-hidden="true" tabindex="-1"></a>             <span class="st">'KELURAHAN'</span>, <span class="co"># SUBDISTRICT</span></span>
<span id="cb60-456"><a href="#cb60-456" aria-hidden="true" tabindex="-1"></a>             <span class="st">'SASARAN'</span>, <span class="co"># TARGET population to be vacinated</span></span>
<span id="cb60-457"><a href="#cb60-457" aria-hidden="true" tabindex="-1"></a>             <span class="st">'BELUM VAKSIN'</span> <span class="co">#Yet to be vacinnated</span></span>
<span id="cb60-458"><a href="#cb60-458" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">%&gt;%</span></span>
<span id="cb60-459"><a href="#cb60-459" aria-hidden="true" tabindex="-1"></a>    <span class="co">#add the month_year</span></span>
<span id="cb60-460"><a href="#cb60-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">Time_Period =</span> df_str)</span>
<span id="cb60-461"><a href="#cb60-461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-462"><a href="#cb60-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(df_str,new_df)</span>
<span id="cb60-463"><a href="#cb60-463" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-464"><a href="#cb60-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-465"><a href="#cb60-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-466"><a href="#cb60-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-469"><a href="#cb60-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-470"><a href="#cb60-470" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">0</span>)), </span>
<span id="cb60-471"><a href="#cb60-471" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">'WILAYAH KOTA'</span>,</span>
<span id="cb60-472"><a href="#cb60-472" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'KECAMATAN'</span>,</span>
<span id="cb60-473"><a href="#cb60-473" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'KELURAHAN'</span>,</span>
<span id="cb60-474"><a href="#cb60-474" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'SASARAN'</span>,</span>
<span id="cb60-475"><a href="#cb60-475" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'BELUM VAKSIN'</span>,</span>
<span id="cb60-476"><a href="#cb60-476" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'Time_Period'</span>))</span>
<span id="cb60-477"><a href="#cb60-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-478"><a href="#cb60-478" aria-hidden="true" tabindex="-1"></a><span class="co">#combining all tgt</span></span>
<span id="cb60-479"><a href="#cb60-479" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df_str <span class="cf">in</span> df_list) {</span>
<span id="cb60-480"><a href="#cb60-480" aria-hidden="true" tabindex="-1"></a>  combined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(combined_df,<span class="fu">get</span>(df_str))</span>
<span id="cb60-481"><a href="#cb60-481" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-482"><a href="#cb60-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-483"><a href="#cb60-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-484"><a href="#cb60-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-487"><a href="#cb60-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-488"><a href="#cb60-488" aria-hidden="true" tabindex="-1"></a><span class="co">#translate  colnames into eng</span></span>
<span id="cb60-489"><a href="#cb60-489" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CITY_AREA"</span>, <span class="st">"DISTRICT"</span>,<span class="st">"SUBDISTRICT"</span>, <span class="st">"TARGET"</span>, <span class="st">"YET_TO_BE_VACINATED"</span>, <span class="st">"TIME_PERIOD"</span>)</span>
<span id="cb60-490"><a href="#cb60-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-491"><a href="#cb60-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-492"><a href="#cb60-492" aria-hidden="true" tabindex="-1"></a><span class="co">#convert into date format yyyy-mm-dd</span></span>
<span id="cb60-493"><a href="#cb60-493" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Desember_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-12-01'</span></span>
<span id="cb60-494"><a href="#cb60-494" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Februari_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-02-01'</span></span>
<span id="cb60-495"><a href="#cb60-495" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Januari_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-01-01'</span></span>
<span id="cb60-496"><a href="#cb60-496" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Juli_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-07-01'</span></span>
<span id="cb60-497"><a href="#cb60-497" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Juni_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-06-01'</span></span>
<span id="cb60-498"><a href="#cb60-498" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Mei_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-05-01'</span></span>
<span id="cb60-499"><a href="#cb60-499" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Oktober_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-10-01'</span></span>
<span id="cb60-500"><a href="#cb60-500" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Maret_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-03-02'</span></span>
<span id="cb60-501"><a href="#cb60-501" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'Agustus_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-08-01'</span></span>
<span id="cb60-502"><a href="#cb60-502" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'September_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-09-01'</span></span>
<span id="cb60-503"><a href="#cb60-503" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'November_2021'</span>] <span class="ot">&lt;-</span> <span class="st">'2021-11-01'</span></span>
<span id="cb60-504"><a href="#cb60-504" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD[combined_df<span class="sc">$</span>TIME_PERIOD <span class="sc">==</span> <span class="st">'April_2022'</span>] <span class="ot">&lt;-</span> <span class="st">'2022-04-01'</span></span>
<span id="cb60-505"><a href="#cb60-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-506"><a href="#cb60-506" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to date format</span></span>
<span id="cb60-507"><a href="#cb60-507" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>TIME_PERIOD <span class="ot">&lt;-</span><span class="fu">as.Date</span>(combined_df<span class="sc">$</span>TIME_PERIOD, <span class="at">format=</span><span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb60-508"><a href="#cb60-508" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(combined_df<span class="sc">$</span>TIME_PERIOD)</span>
<span id="cb60-509"><a href="#cb60-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-510"><a href="#cb60-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-513"><a href="#cb60-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-514"><a href="#cb60-514" aria-hidden="true" tabindex="-1"></a><span class="co">#check missing values</span></span>
<span id="cb60-515"><a href="#cb60-515" aria-hidden="true" tabindex="-1"></a>combined_df[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(combined_df))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb60-516"><a href="#cb60-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-517"><a href="#cb60-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-518"><a href="#cb60-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-519"><a href="#cb60-519" aria-hidden="true" tabindex="-1"></a>As identified earlier, there are missing values under <span class="in">`CITY AREA`</span> and <span class="in">`DISTRICT`</span> where the <span class="in">`SUBDISTRICT`</span> is "TOTAL". As our analysis focuses on the Subdistricts of Jakarta, knowing the "Total" is not important. Hence, I decided to remove it.</span>
<span id="cb60-520"><a href="#cb60-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-523"><a href="#cb60-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-524"><a href="#cb60-524" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(combined_df)</span>
<span id="cb60-525"><a href="#cb60-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-526"><a href="#cb60-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-529"><a href="#cb60-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-530"><a href="#cb60-530" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(combined_df))</span>
<span id="cb60-531"><a href="#cb60-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-532"><a href="#cb60-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-533"><a href="#cb60-533" aria-hidden="true" tabindex="-1"></a>Next, we need to check whether this data consist of any outer islands and remove it accordingly. The code chunk below follow the steps earlier shown in the removal of outer islands.</span>
<span id="cb60-534"><a href="#cb60-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-537"><a href="#cb60-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-538"><a href="#cb60-538" aria-hidden="true" tabindex="-1"></a><span class="co">#identify unique values of city areas in Jakarta</span></span>
<span id="cb60-539"><a href="#cb60-539" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(combined_df<span class="sc">$</span><span class="st">"CITY_AREA"</span>)</span>
<span id="cb60-540"><a href="#cb60-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-541"><a href="#cb60-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-544"><a href="#cb60-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-545"><a href="#cb60-545" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the outer island i.e KAB.ADM.KEP.SERIBU</span></span>
<span id="cb60-546"><a href="#cb60-546" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(combined_df, CITY_AREA <span class="sc">!=</span> <span class="st">"KAB.ADM.KEP.SERIBU"</span>)</span>
<span id="cb60-547"><a href="#cb60-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-548"><a href="#cb60-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-549"><a href="#cb60-549" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Geospatial Data Integration</span></span>
<span id="cb60-550"><a href="#cb60-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-551"><a href="#cb60-551" aria-hidden="true" tabindex="-1"></a>Now that we have prepared our geospatial and aspatial data frames, we'll need to join them. A quick look at their headers tell us what their common fields are:</span>
<span id="cb60-552"><a href="#cb60-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-555"><a href="#cb60-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-556"><a href="#cb60-556" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(jkt2019)</span>
<span id="cb60-557"><a href="#cb60-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-558"><a href="#cb60-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-561"><a href="#cb60-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-562"><a href="#cb60-562" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df)</span>
<span id="cb60-563"><a href="#cb60-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-564"><a href="#cb60-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-565"><a href="#cb60-565" aria-hidden="true" tabindex="-1"></a>Analyzing the columns headers, columns related to the city, district and subdistrictshould match.</span>
<span id="cb60-566"><a href="#cb60-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-569"><a href="#cb60-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-570"><a href="#cb60-570" aria-hidden="true" tabindex="-1"></a><span class="co"># joins based on district, Sub_District and City</span></span>
<span id="cb60-571"><a href="#cb60-571" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(jkt2019, combined_df,</span>
<span id="cb60-572"><a href="#cb60-572" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(</span>
<span id="cb60-573"><a href="#cb60-573" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"City"</span><span class="ot">=</span><span class="st">"CITY_AREA"</span>, </span>
<span id="cb60-574"><a href="#cb60-574" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"District"</span><span class="ot">=</span><span class="st">"DISTRICT"</span>,</span>
<span id="cb60-575"><a href="#cb60-575" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Sub_District"</span><span class="ot">=</span><span class="st">"SUBDISTRICT"</span>)</span>
<span id="cb60-576"><a href="#cb60-576" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb60-577"><a href="#cb60-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-578"><a href="#cb60-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-579"><a href="#cb60-579" aria-hidden="true" tabindex="-1"></a>Now, let's visualise our combined_jakarta and with its target and to be vaccinated values count.</span>
<span id="cb60-580"><a href="#cb60-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-583"><a href="#cb60-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-584"><a href="#cb60-584" aria-hidden="true" tabindex="-1"></a>target_vaccines <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb60-585"><a href="#cb60-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TARGET"</span>) <span class="sc">+</span></span>
<span id="cb60-586"><a href="#cb60-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-587"><a href="#cb60-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Target Vaccinated Count"</span>)</span>
<span id="cb60-588"><a href="#cb60-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-589"><a href="#cb60-589" aria-hidden="true" tabindex="-1"></a>yet_to_be_vaccines <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb60-590"><a href="#cb60-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"YET_TO_BE_VACINATED"</span>) <span class="sc">+</span></span>
<span id="cb60-591"><a href="#cb60-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-592"><a href="#cb60-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Yet To Be Vaccinated Count"</span>)</span>
<span id="cb60-593"><a href="#cb60-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-594"><a href="#cb60-594" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(target_vaccines, yet_to_be_vaccines)</span>
<span id="cb60-595"><a href="#cb60-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-596"><a href="#cb60-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-597"><a href="#cb60-597" aria-hidden="true" tabindex="-1"></a>Both our maps show that there are missing values even though both dataframes missing values were removed earlier.</span>
<span id="cb60-598"><a href="#cb60-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-599"><a href="#cb60-599" aria-hidden="true" tabindex="-1"></a>Thus, we need to look deeper into our values. Some of my observations looking at the <span class="in">`SUBDISTRICT`</span> and <span class="in">`Sub_District`</span> values directly were that there were alternate ways of calling the same sub district. For example, "KRAMAT JATI" in combined_df, but "KRAMAT ATI" in jkt2019.</span>
<span id="cb60-600"><a href="#cb60-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-601"><a href="#cb60-601" aria-hidden="true" tabindex="-1"></a>The code chunk below further explores the unique values of sub districts found in count_subdistrict but not in bd_subdistrict and vice versa.</span>
<span id="cb60-602"><a href="#cb60-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-605"><a href="#cb60-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-606"><a href="#cb60-606" aria-hidden="true" tabindex="-1"></a>count_subdistrict <span class="ot">&lt;-</span> <span class="fu">c</span>(combined_df<span class="sc">$</span>SUBDISTRICT)</span>
<span id="cb60-607"><a href="#cb60-607" aria-hidden="true" tabindex="-1"></a>bd_subdistrict <span class="ot">&lt;-</span> <span class="fu">c</span>(jkt2019<span class="sc">$</span>Sub_District)</span>
<span id="cb60-608"><a href="#cb60-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-609"><a href="#cb60-609" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Aspatial SUBDISTRICT:</span><span class="sc">\n</span><span class="st">__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-610"><a href="#cb60-610" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(count_subdistrict[<span class="sc">!</span>(count_subdistrict <span class="sc">%in%</span> bd_subdistrict)])</span>
<span id="cb60-611"><a href="#cb60-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-612"><a href="#cb60-612" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-613"><a href="#cb60-613" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Unique Geospatial Sub_District:</span><span class="sc">\n</span><span class="st">__________________________________________________________</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-614"><a href="#cb60-614" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bd_subdistrict[<span class="sc">!</span>(bd_subdistrict <span class="sc">%in%</span> count_subdistrict)])</span>
<span id="cb60-615"><a href="#cb60-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-616"><a href="#cb60-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-617"><a href="#cb60-617" aria-hidden="true" tabindex="-1"></a>The table below compiles the mismatched records of the subdistricts between the two dataframes.</span>
<span id="cb60-618"><a href="#cb60-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-621"><a href="#cb60-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-622"><a href="#cb60-622" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise a dataframe of our cases vs bd subdistrict spelling</span></span>
<span id="cb60-623"><a href="#cb60-623" aria-hidden="true" tabindex="-1"></a>spelling <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-624"><a href="#cb60-624" aria-hidden="true" tabindex="-1"></a>  <span class="at">Aspatial_Count=</span><span class="fu">c</span>(<span class="st">"BALE KAMBANG"</span>, <span class="st">"HALIM PERDANA KUSUMAH"</span>, <span class="st">"JATI PULO"</span>, <span class="st">"KALI BARU"</span>, <span class="st">"KAMPUNG TENGAH"</span>, <span class="st">"KRAMAT JATI"</span>, <span class="st">"KERENDANG"</span>, <span class="st">"PAL MERIAM"</span>, <span class="st">"PINANG RANTI"</span>, <span class="st">"RAWA JATI"</span>),</span>
<span id="cb60-625"><a href="#cb60-625" aria-hidden="true" tabindex="-1"></a>  <span class="at">Geospatial_BD=</span><span class="fu">c</span>(<span class="st">"BALEKAMBAG"</span>, <span class="st">"HALIM PERDANA KUSUMA"</span>, <span class="st">"JATIPULO"</span>, <span class="st">"KALIBARU"</span>, <span class="st">"TENGAH"</span>, <span class="st">"KRAMATJATI"</span>, <span class="st">"KRENDANG"</span>, <span class="st">"PALMERIAM"</span>, <span class="st">"PINANGRANTI"</span>, <span class="st">"RAWAJATI"</span>)</span>
<span id="cb60-626"><a href="#cb60-626" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-627"><a href="#cb60-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-628"><a href="#cb60-628" aria-hidden="true" tabindex="-1"></a>spelling</span>
<span id="cb60-629"><a href="#cb60-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-630"><a href="#cb60-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-631"><a href="#cb60-631" aria-hidden="true" tabindex="-1"></a>Next, we need to rectify the mismatched subdistricts names.</span>
<span id="cb60-632"><a href="#cb60-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-635"><a href="#cb60-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-636"><a href="#cb60-636" aria-hidden="true" tabindex="-1"></a><span class="co"># where jkt2019 is a mismatched value, replace with the correct value</span></span>
<span id="cb60-637"><a href="#cb60-637" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'BALEKAMBANG'</span>] <span class="ot">&lt;-</span> <span class="st">'BALE KAMBANG'</span></span>
<span id="cb60-638"><a href="#cb60-638" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'HALIM PERDANA KUSUMA'</span>] <span class="ot">&lt;-</span> <span class="st">'HALIM PERDANA KUSUMAH'</span></span>
<span id="cb60-639"><a href="#cb60-639" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'JATIPULO'</span>] <span class="ot">&lt;-</span> <span class="st">'JATI PULO'</span></span>
<span id="cb60-640"><a href="#cb60-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-641"><a href="#cb60-641" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KALI BARU'</span>] <span class="ot">&lt;-</span> <span class="st">'KALIBARU'</span></span>
<span id="cb60-642"><a href="#cb60-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-643"><a href="#cb60-643" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'TENGAH'</span>] <span class="ot">&lt;-</span> <span class="st">'KAMPUNG TENGAH'</span></span>
<span id="cb60-644"><a href="#cb60-644" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KRAMATJATI'</span>] <span class="ot">&lt;-</span> <span class="st">'KRAMAT JATI'</span></span>
<span id="cb60-645"><a href="#cb60-645" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'KRENDANG'</span>] <span class="ot">&lt;-</span> <span class="st">'KERENDANG'</span></span>
<span id="cb60-646"><a href="#cb60-646" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'PALMERIAM'</span>] <span class="ot">&lt;-</span> <span class="st">'PAL MERIAM'</span></span>
<span id="cb60-647"><a href="#cb60-647" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'PINANGRANTI'</span>] <span class="ot">&lt;-</span> <span class="st">'PINANG RANTI'</span></span>
<span id="cb60-648"><a href="#cb60-648" aria-hidden="true" tabindex="-1"></a>jkt2019<span class="sc">$</span>Sub_District[jkt2019<span class="sc">$</span>Sub_District <span class="sc">==</span> <span class="st">'RAWAJATI'</span>] <span class="ot">&lt;-</span> <span class="st">'RAWA JATI'</span></span>
<span id="cb60-649"><a href="#cb60-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-650"><a href="#cb60-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-651"><a href="#cb60-651" aria-hidden="true" tabindex="-1"></a>Rejoining the two dataframes</span>
<span id="cb60-652"><a href="#cb60-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-655"><a href="#cb60-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-656"><a href="#cb60-656" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(jkt2019, combined_df,</span>
<span id="cb60-657"><a href="#cb60-657" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Sub_District"</span><span class="ot">=</span><span class="st">"SUBDISTRICT"</span>)</span>
<span id="cb60-658"><a href="#cb60-658" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb60-659"><a href="#cb60-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-660"><a href="#cb60-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-663"><a href="#cb60-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-664"><a href="#cb60-664" aria-hidden="true" tabindex="-1"></a><span class="co"># double check of any missing values</span></span>
<span id="cb60-665"><a href="#cb60-665" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(combined_jakarta))</span>
<span id="cb60-666"><a href="#cb60-666" aria-hidden="true" tabindex="-1"></a><span class="co">#which(is.na(combined_jakarta))</span></span>
<span id="cb60-667"><a href="#cb60-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-668"><a href="#cb60-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-669"><a href="#cb60-669" aria-hidden="true" tabindex="-1"></a>Once again, let's visualise it!\</span>
<span id="cb60-670"><a href="#cb60-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-673"><a href="#cb60-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-674"><a href="#cb60-674" aria-hidden="true" tabindex="-1"></a>updated_target_count <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb60-675"><a href="#cb60-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TARGET"</span>) <span class="sc">+</span></span>
<span id="cb60-676"><a href="#cb60-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-677"><a href="#cb60-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Updated Target Vacinated Count"</span>)</span>
<span id="cb60-678"><a href="#cb60-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-679"><a href="#cb60-679" aria-hidden="true" tabindex="-1"></a>updated_yet_to_be_count <span class="ot">=</span> <span class="fu">tm_shape</span>(combined_jakarta)<span class="sc">+</span></span>
<span id="cb60-680"><a href="#cb60-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"YET_TO_BE_VACINATED"</span>) <span class="sc">+</span></span>
<span id="cb60-681"><a href="#cb60-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-682"><a href="#cb60-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Updated TO Be Vaccinated Count"</span>)</span>
<span id="cb60-683"><a href="#cb60-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-684"><a href="#cb60-684" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(updated_target_count, updated_yet_to_be_count)</span>
<span id="cb60-685"><a href="#cb60-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-686"><a href="#cb60-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-687"><a href="#cb60-687" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. Calculation: Monthly Vaccination Rates</span></span>
<span id="cb60-688"><a href="#cb60-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-689"><a href="#cb60-689" aria-hidden="true" tabindex="-1"></a>To calculate the monthly vaccination rates, I will be using this formula:</span>
<span id="cb60-690"><a href="#cb60-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-691"><a href="#cb60-691" aria-hidden="true" tabindex="-1"></a>$Vaccination Rate (\%) =\frac{Target - Yet To Be Vaccinated}{Target} * 100$</span>
<span id="cb60-692"><a href="#cb60-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-693"><a href="#cb60-693" aria-hidden="true" tabindex="-1"></a>where Target refers to target population to get vaccinated and YetToBeVacinated refers to population who have not been vaccinated yet. Essentially, the vaccination rate is derived from taking count of people who are vaccinated over count of people who are supposed to be vaccinated.</span>
<span id="cb60-694"><a href="#cb60-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-697"><a href="#cb60-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-698"><a href="#cb60-698" aria-hidden="true" tabindex="-1"></a><span class="co"># grouping based on the sub-district and time_period</span></span>
<span id="cb60-699"><a href="#cb60-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-700"><a href="#cb60-700" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb60-701"><a href="#cb60-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(jkt2019, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"SUBDISTRICT"</span> <span class="ot">=</span> <span class="st">"Sub_District"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-702"><a href="#cb60-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SUBDISTRICT, TIME_PERIOD) <span class="sc">%&gt;%</span></span>
<span id="cb60-703"><a href="#cb60-703" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">vaccination_rates</span><span class="st">`</span> <span class="ot">=</span> ((<span class="fu">sum</span>(TARGET<span class="sc">-</span>YET_TO_BE_VACINATED)<span class="sc">/</span><span class="fu">sum</span>(TARGET))<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-704"><a href="#cb60-704" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-705"><a href="#cb60-705" aria-hidden="true" tabindex="-1"></a>  <span class="co">#afterwards, pivots the table based on the Dates, showing the cumulative death rate</span></span>
<span id="cb60-706"><a href="#cb60-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> TIME_PERIOD,</span>
<span id="cb60-707"><a href="#cb60-707" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> vaccination_rates)</span>
<span id="cb60-708"><a href="#cb60-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-709"><a href="#cb60-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-710"><a href="#cb60-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-711"><a href="#cb60-711" aria-hidden="true" tabindex="-1"></a>The output of the code chunk below shows monthly vaccination rates across each sub-district from a study period of July 2021 to June 2022.</span>
<span id="cb60-712"><a href="#cb60-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-713"><a href="#cb60-713" aria-hidden="true" tabindex="-1"></a>Convert our dataframes into sf objects</span>
<span id="cb60-714"><a href="#cb60-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-717"><a href="#cb60-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-718"><a href="#cb60-718" aria-hidden="true" tabindex="-1"></a>combined_jakarta <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(combined_jakarta)</span>
<span id="cb60-719"><a href="#cb60-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-720"><a href="#cb60-720" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> vr<span class="sc">%&gt;%</span> <span class="fu">left_join</span>(jkt2019, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"SUBDISTRICT"</span><span class="ot">=</span><span class="st">"Sub_District"</span>))</span>
<span id="cb60-721"><a href="#cb60-721" aria-hidden="true" tabindex="-1"></a>vr <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(vr)</span>
<span id="cb60-722"><a href="#cb60-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-723"><a href="#cb60-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-724"><a href="#cb60-724" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6. Mapping of Monthly Vaccination Rates</span></span>
<span id="cb60-725"><a href="#cb60-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-726"><a href="#cb60-726" aria-hidden="true" tabindex="-1"></a>There are different <span class="co">[</span><span class="ot">methods</span><span class="co">](https://storymaps.arcgis.com/stories/bcb8e509f319436786a2481c722bc218)</span> to classify the vaccination rates in choropleth maps. Initially, I considered Jenks classification method as it can minimize variation in each group which allows map readers to easily witness the trends presented by the map. However, this method is not very suitable for our data as it has low variance.</span>
<span id="cb60-727"><a href="#cb60-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-728"><a href="#cb60-728" aria-hidden="true" tabindex="-1"></a>The code chunk below shows the decreasing variance as time passes through the period of July 2021 to June 2022.</span>
<span id="cb60-729"><a href="#cb60-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-732"><a href="#cb60-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-733"><a href="#cb60-733" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-07-01</span><span class="st">`</span>)</span>
<span id="cb60-734"><a href="#cb60-734" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-10-01</span><span class="st">`</span>)</span>
<span id="cb60-735"><a href="#cb60-735" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-02-01</span><span class="st">`</span>)</span>
<span id="cb60-736"><a href="#cb60-736" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-06-01</span><span class="st">`</span>)</span>
<span id="cb60-737"><a href="#cb60-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-738"><a href="#cb60-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-739"><a href="#cb60-739" aria-hidden="true" tabindex="-1"></a>To get a clearer visualization of a specific month, I decided to use the classification method, cont as it creates a smooth, linear gradient in which the change in values is proportionally related to the change in colors. For the color palette, i decided to go with a sequential scheme from yellow to green as it more suited for ordered data that progress from low to high.</span>
<span id="cb60-740"><a href="#cb60-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-741"><a href="#cb60-741" aria-hidden="true" tabindex="-1"></a>The code chunk below is an interactive map of vaccination rates in July 2021. By clicking on a certain location, it will show us the district name and respective vaccination rates. The darker the green, the higher the vaccination rates.</span>
<span id="cb60-742"><a href="#cb60-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-745"><a href="#cb60-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-746"><a href="#cb60-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb60-747"><a href="#cb60-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb60-748"><a href="#cb60-748" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">"2021-07-01"</span>, </span>
<span id="cb60-749"><a href="#cb60-749" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb60-750"><a href="#cb60-750" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb60-751"><a href="#cb60-751" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb60-752"><a href="#cb60-752" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb60-753"><a href="#cb60-753" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb60-754"><a href="#cb60-754" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb60-755"><a href="#cb60-755" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Vaccination Rates in July 2021"</span>,</span>
<span id="cb60-756"><a href="#cb60-756" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb60-757"><a href="#cb60-757" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb60-758"><a href="#cb60-758" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height =</span> <span class="fl">0.5</span>, </span>
<span id="cb60-759"><a href="#cb60-759" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb60-760"><a href="#cb60-760" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-761"><a href="#cb60-761" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb60-762"><a href="#cb60-762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb60-763"><a href="#cb60-763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>))</span>
<span id="cb60-764"><a href="#cb60-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-765"><a href="#cb60-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-768"><a href="#cb60-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-769"><a href="#cb60-769" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-770"><a href="#cb60-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-771"><a href="#cb60-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-772"><a href="#cb60-772" aria-hidden="true" tabindex="-1"></a>Insights:</span>
<span id="cb60-773"><a href="#cb60-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-774"><a href="#cb60-774" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The sub-district with the lowest vaccination rate is CIPINANG BESAR UTARA (23.15%).</span>
<span id="cb60-775"><a href="#cb60-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-776"><a href="#cb60-776" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The sub-district with the highest vaccination rate is HALIM PERDANA KUSUMAH (55.24%).</span>
<span id="cb60-777"><a href="#cb60-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-778"><a href="#cb60-778" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Not much clusters can be identified.</span>
<span id="cb60-779"><a href="#cb60-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-780"><a href="#cb60-780" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Sub-districts with lower vaccination rates can try to learn/adopt strategies from sub districts with higher vaccination rates' to increase their own vaccination rates.</span>
<span id="cb60-781"><a href="#cb60-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-782"><a href="#cb60-782" aria-hidden="true" tabindex="-1"></a>The code chunk below is an interactive map of vaccination rates in June 2022.</span>
<span id="cb60-783"><a href="#cb60-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-786"><a href="#cb60-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-787"><a href="#cb60-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb60-788"><a href="#cb60-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb60-789"><a href="#cb60-789" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="st">"2022-06-01"</span>, </span>
<span id="cb60-790"><a href="#cb60-790" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb60-791"><a href="#cb60-791" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">"cont"</span>,</span>
<span id="cb60-792"><a href="#cb60-792" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb60-793"><a href="#cb60-793" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb60-794"><a href="#cb60-794" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb60-795"><a href="#cb60-795" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb60-796"><a href="#cb60-796" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Vaccination Rates in June 2022"</span>,</span>
<span id="cb60-797"><a href="#cb60-797" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb60-798"><a href="#cb60-798" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb60-799"><a href="#cb60-799" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.height =</span> <span class="fl">0.5</span>, </span>
<span id="cb60-800"><a href="#cb60-800" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb60-801"><a href="#cb60-801" aria-hidden="true" tabindex="-1"></a>              <span class="at">frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-802"><a href="#cb60-802" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb60-803"><a href="#cb60-803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb60-804"><a href="#cb60-804" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>))</span>
<span id="cb60-805"><a href="#cb60-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-806"><a href="#cb60-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-809"><a href="#cb60-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-810"><a href="#cb60-810" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-811"><a href="#cb60-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-812"><a href="#cb60-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-813"><a href="#cb60-813" aria-hidden="true" tabindex="-1"></a>Insights (as compared to July 2021):</span>
<span id="cb60-814"><a href="#cb60-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-815"><a href="#cb60-815" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The sub-district with the lowest vaccination rate is no longer CIPINANG BESAR UTARA(81.79%) but KEBON MELATI (78.13%). However, the lowest vaccination rate in June 2022 is still much higher than the the highest vaccination rate in July 2021 (55.24%).</span>
<span id="cb60-816"><a href="#cb60-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-817"><a href="#cb60-817" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The sub-district with highest vaccination rate is the same, HALIM PERDANA KUSUMAH (89.76%).</span>
<span id="cb60-818"><a href="#cb60-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-819"><a href="#cb60-819" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The bottom half sub-districts tend to have a higher vaccination rate than the top half sub-districts.</span>
<span id="cb60-820"><a href="#cb60-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-821"><a href="#cb60-821" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Thus, we can infer that within a span of 1 year, the vaccination rates across the sub-districts in Jakarta have increased.</span>
<span id="cb60-822"><a href="#cb60-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-823"><a href="#cb60-823" aria-hidden="true" tabindex="-1"></a>The code chunk below plots the vaccination rate across the our study period of July 2021 to June 2022. The data is classified using manually. The breakpoints are 20, 40, 60, 80, 100.</span>
<span id="cb60-824"><a href="#cb60-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-827"><a href="#cb60-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-828"><a href="#cb60-828" aria-hidden="true" tabindex="-1"></a>rate_cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(<span class="fu">st_set_geometry</span>(vr[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>], <span class="cn">NULL</span>))</span>
<span id="cb60-829"><a href="#cb60-829" aria-hidden="true" tabindex="-1"></a>rate_cols</span>
<span id="cb60-830"><a href="#cb60-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-831"><a href="#cb60-831" aria-hidden="true" tabindex="-1"></a>map_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(rate_cols))</span>
<span id="cb60-832"><a href="#cb60-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-833"><a href="#cb60-833" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rate_cols)) {</span>
<span id="cb60-834"><a href="#cb60-834" aria-hidden="true" tabindex="-1"></a>  cmap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(vr)<span class="sc">+</span></span>
<span id="cb60-835"><a href="#cb60-835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(rate_cols[[i]], </span>
<span id="cb60-836"><a href="#cb60-836" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span> <span class="dv">6</span>,</span>
<span id="cb60-837"><a href="#cb60-837" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb60-838"><a href="#cb60-838" aria-hidden="true" tabindex="-1"></a>            <span class="co">#style = "cont",</span></span>
<span id="cb60-839"><a href="#cb60-839" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Vaccination Rate(%)"</span>,</span>
<span id="cb60-840"><a href="#cb60-840" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"YlGn"</span>,</span>
<span id="cb60-841"><a href="#cb60-841" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb60-842"><a href="#cb60-842" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tm_text("SUBDISTRICT")+</span></span>
<span id="cb60-843"><a href="#cb60-843" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(</span>
<span id="cb60-844"><a href="#cb60-844" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-845"><a href="#cb60-845" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.labels =</span> rate_cols[[i]],</span>
<span id="cb60-846"><a href="#cb60-846" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.label.color =</span> <span class="st">'gray12'</span>,</span>
<span id="cb60-847"><a href="#cb60-847" aria-hidden="true" tabindex="-1"></a>              <span class="at">panel.label.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb60-848"><a href="#cb60-848" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.show =</span> <span class="cn">FALSE</span></span>
<span id="cb60-849"><a href="#cb60-849" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb60-850"><a href="#cb60-850" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-851"><a href="#cb60-851" aria-hidden="true" tabindex="-1"></a>  map_list[[i]] <span class="ot">&lt;-</span> cmap</span>
<span id="cb60-852"><a href="#cb60-852" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-853"><a href="#cb60-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-854"><a href="#cb60-854" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map_list, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb60-855"><a href="#cb60-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-856"><a href="#cb60-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-857"><a href="#cb60-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-858"><a href="#cb60-858" aria-hidden="true" tabindex="-1"></a>Insights:</span>
<span id="cb60-859"><a href="#cb60-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-860"><a href="#cb60-860" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We can actually see Jakarta's vaccination rate increase steadily across the period of July 2021 to February 2022.</span>
<span id="cb60-861"><a href="#cb60-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-862"><a href="#cb60-862" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>However, from February 2022 to June 2022, there is not much difference in the vaccination rates across all sub-districts.</span>
<span id="cb60-863"><a href="#cb60-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-864"><a href="#cb60-864" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Local Gi\* Analysis</span></span>
<span id="cb60-865"><a href="#cb60-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-866"><a href="#cb60-866" aria-hidden="true" tabindex="-1"></a>Computing local Gi<span class="sc">\*</span> statistics</span>
<span id="cb60-867"><a href="#cb60-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-868"><a href="#cb60-868" aria-hidden="true" tabindex="-1"></a>To detect hot spot areas with high vaccination rates, and cold spot areas with high vaccination rates in Jakarta, we will be using Getis-Ord Gi<span class="sc">\*</span> statistics. Time-series analysis will also be conducted to understand the evolution of spatial hot spots and cold spots across the time period of July 2021 to June 2022.</span>
<span id="cb60-869"><a href="#cb60-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-870"><a href="#cb60-870" aria-hidden="true" tabindex="-1"></a>For Interpretation of Gi<span class="sc">\*</span> values:</span>
<span id="cb60-871"><a href="#cb60-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-872"><a href="#cb60-872" aria-hidden="true" tabindex="-1"></a>$Gi∗&gt;0$ : indicates grouping of areas with values higher than average</span>
<span id="cb60-873"><a href="#cb60-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-874"><a href="#cb60-874" aria-hidden="true" tabindex="-1"></a>$Gi∗&lt;0$ : indicates grouping of areas with values lower than average</span>
<span id="cb60-875"><a href="#cb60-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-876"><a href="#cb60-876" aria-hidden="true" tabindex="-1"></a>A larger magnitude represents a greater intensity of grouping.</span>
<span id="cb60-877"><a href="#cb60-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-878"><a href="#cb60-878" aria-hidden="true" tabindex="-1"></a>For significant Gi<span class="sc">\*</span> statistic values, two spatial associations can be inferred:</span>
<span id="cb60-879"><a href="#cb60-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-880"><a href="#cb60-880" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Hot spot areas:** where $Gi∗&gt;0$, significant and positive, if location is associated with relatively high values of the surrounding locations.</span>
<span id="cb60-881"><a href="#cb60-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-882"><a href="#cb60-882" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cold spot areas:** where $Gi∗&lt;0$, significant and negative, if location is associated with relatively low values in surrounding locations</span>
<span id="cb60-883"><a href="#cb60-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-884"><a href="#cb60-884" aria-hidden="true" tabindex="-1"></a>**Compute local Gi\* of vaccination rates in July 2022**</span>
<span id="cb60-885"><a href="#cb60-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-888"><a href="#cb60-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-889"><a href="#cb60-889" aria-hidden="true" tabindex="-1"></a>wm_idw <span class="ot">&lt;-</span> vr <span class="sc">%&gt;%</span></span>
<span id="cb60-890"><a href="#cb60-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">st_contiguity</span>(geometry),</span>
<span id="cb60-891"><a href="#cb60-891" aria-hidden="true" tabindex="-1"></a>         <span class="at">wts =</span> <span class="fu">st_inverse_distance</span>(nb, geometry,</span>
<span id="cb60-892"><a href="#cb60-892" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb60-893"><a href="#cb60-893" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb60-894"><a href="#cb60-894" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb60-895"><a href="#cb60-895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-896"><a href="#cb60-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-899"><a href="#cb60-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-900"><a href="#cb60-900" aria-hidden="true" tabindex="-1"></a><span class="co">#monthly vaccination rate for July_2021</span></span>
<span id="cb60-901"><a href="#cb60-901" aria-hidden="true" tabindex="-1"></a>HCSA_july2021 <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span> </span>
<span id="cb60-902"><a href="#cb60-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb60-903"><a href="#cb60-903" aria-hidden="true" tabindex="-1"></a>    vr<span class="sc">$</span><span class="st">`</span><span class="at">2021-07-01</span><span class="st">`</span>, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb60-904"><a href="#cb60-904" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-905"><a href="#cb60-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb60-906"><a href="#cb60-906" aria-hidden="true" tabindex="-1"></a>HCSA_july2021</span>
<span id="cb60-907"><a href="#cb60-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-908"><a href="#cb60-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-911"><a href="#cb60-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-912"><a href="#cb60-912" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-913"><a href="#cb60-913" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb60-914"><a href="#cb60-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb60-915"><a href="#cb60-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-916"><a href="#cb60-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb60-917"><a href="#cb60-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of "</span>,<span class="st">"July 2021"</span>),</span>
<span id="cb60-918"><a href="#cb60-918" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb60-919"><a href="#cb60-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-920"><a href="#cb60-920" aria-hidden="true" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb60-921"><a href="#cb60-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb60-922"><a href="#cb60-922" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb60-923"><a href="#cb60-923" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb60-924"><a href="#cb60-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-925"><a href="#cb60-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"p-value of Gi*"</span>,</span>
<span id="cb60-926"><a href="#cb60-926" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb60-927"><a href="#cb60-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-928"><a href="#cb60-928" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map1, map2, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb60-929"><a href="#cb60-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-930"><a href="#cb60-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-931"><a href="#cb60-931" aria-hidden="true" tabindex="-1"></a>Now, we are ready to plot the significant (i.e. p-values less than 0.05) hot spot and cold spot areas by using appropriate tmap functions as shown below.</span>
<span id="cb60-932"><a href="#cb60-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-935"><a href="#cb60-935" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-936"><a href="#cb60-936" aria-hidden="true" tabindex="-1"></a>HCSA_sig_july2021 <span class="ot">&lt;-</span> HCSA_july2021  <span class="sc">%&gt;%</span></span>
<span id="cb60-937"><a href="#cb60-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-938"><a href="#cb60-938" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-939"><a href="#cb60-939" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_july2021) <span class="sc">+</span></span>
<span id="cb60-940"><a href="#cb60-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb60-941"><a href="#cb60-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-942"><a href="#cb60-942" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_sig_july2021) <span class="sc">+</span></span>
<span id="cb60-943"><a href="#cb60-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb60-944"><a href="#cb60-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-945"><a href="#cb60-945" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Hot and Cold Spot Areas of Vaccination Rates in July 2021"</span>, <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb60-946"><a href="#cb60-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-947"><a href="#cb60-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-948"><a href="#cb60-948" aria-hidden="true" tabindex="-1"></a>Observation:</span>
<span id="cb60-949"><a href="#cb60-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-950"><a href="#cb60-950" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The are 6 hot spot areas and 1 cold spot area.</span>
<span id="cb60-951"><a href="#cb60-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-952"><a href="#cb60-952" aria-hidden="true" tabindex="-1"></a>Perform the same steps as above to compute local Gi<span class="sc">\*</span> in June 2022.</span>
<span id="cb60-953"><a href="#cb60-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-956"><a href="#cb60-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-957"><a href="#cb60-957" aria-hidden="true" tabindex="-1"></a>HCSA_june2022 <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span> </span>
<span id="cb60-958"><a href="#cb60-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb60-959"><a href="#cb60-959" aria-hidden="true" tabindex="-1"></a>    vr<span class="sc">$</span><span class="st">`</span><span class="at">2022-06-01</span><span class="st">`</span>, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb60-960"><a href="#cb60-960" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-961"><a href="#cb60-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb60-962"><a href="#cb60-962" aria-hidden="true" tabindex="-1"></a>HCSA_june2022</span>
<span id="cb60-963"><a href="#cb60-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-964"><a href="#cb60-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-965"><a href="#cb60-965" aria-hidden="true" tabindex="-1"></a>Now, we are ready to plot the significant (i.e. p-values less than 0.05) hot spot and cold spot areas in June 2022 by using appropriate tmap functions as shown below.</span>
<span id="cb60-966"><a href="#cb60-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-969"><a href="#cb60-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-970"><a href="#cb60-970" aria-hidden="true" tabindex="-1"></a>HCSA_sig_june2022 <span class="ot">&lt;-</span> HCSA_june2022  <span class="sc">%&gt;%</span></span>
<span id="cb60-971"><a href="#cb60-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-972"><a href="#cb60-972" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-973"><a href="#cb60-973" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_june2022) <span class="sc">+</span></span>
<span id="cb60-974"><a href="#cb60-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb60-975"><a href="#cb60-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-976"><a href="#cb60-976" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_sig_june2022) <span class="sc">+</span></span>
<span id="cb60-977"><a href="#cb60-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span> </span>
<span id="cb60-978"><a href="#cb60-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-979"><a href="#cb60-979" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Hot and Cold Spot Areas of Vaccination Rates in June 2022"</span>, <span class="at">main.title.size =</span> <span class="fl">0.8</span>)</span>
<span id="cb60-980"><a href="#cb60-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-981"><a href="#cb60-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-982"><a href="#cb60-982" aria-hidden="true" tabindex="-1"></a>Observation:</span>
<span id="cb60-983"><a href="#cb60-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-984"><a href="#cb60-984" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>There is only 1 hot spot area and 1 cold spot area.</span>
<span id="cb60-985"><a href="#cb60-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-986"><a href="#cb60-986" aria-hidden="true" tabindex="-1"></a>Comparison:</span>
<span id="cb60-987"><a href="#cb60-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-988"><a href="#cb60-988" aria-hidden="true" tabindex="-1"></a>Comparing both maps of Hot and Cold Spot Areas of Vaccination Rates in July 2021 and June 2022, we can observe that</span>
<span id="cb60-989"><a href="#cb60-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-990"><a href="#cb60-990" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The intensity of Gi<span class="sc">\*</span> value has changed. The lowest range of Gi<span class="sc">\*</span> value change from -4 to -2 to -6 to -4.</span>
<span id="cb60-991"><a href="#cb60-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-992"><a href="#cb60-992" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The significant hot and cold spot locations have changed. Over 1 year, the hot spot shifted downwards while the cold spot locations lessened and becomes more clustered in the center of Jakarta.</span>
<span id="cb60-993"><a href="#cb60-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-994"><a href="#cb60-994" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>In June 2022, the hot spot location is associated with relatively higher values of the surrounding locations as compared to July 2021.</span>
<span id="cb60-995"><a href="#cb60-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-996"><a href="#cb60-996" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>The no. of hot spot areas has decreased from 6 to 1.</span>
<span id="cb60-997"><a href="#cb60-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-998"><a href="#cb60-998" aria-hidden="true" tabindex="-1"></a><span class="fu"># 8. Emerging Hot Spot Analysis(EHSA)</span></span>
<span id="cb60-999"><a href="#cb60-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1000"><a href="#cb60-1000" aria-hidden="true" tabindex="-1"></a>To organise our data, we first have to create a df with the data organised in the following format: Date, Sub_District and Vaccination_Rate.</span>
<span id="cb60-1001"><a href="#cb60-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1004"><a href="#cb60-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1005"><a href="#cb60-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract relevant columns</span></span>
<span id="cb60-1006"><a href="#cb60-1006" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> combined_jakarta[<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb60-1007"><a href="#cb60-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1008"><a href="#cb60-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate vaccination rates</span></span>
<span id="cb60-1009"><a href="#cb60-1009" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> </span>
<span id="cb60-1010"><a href="#cb60-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-1011"><a href="#cb60-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">VACCINATION_RATES =</span> (TARGET <span class="sc">-</span> YET_TO_BE_VACINATED)<span class="sc">/</span>TARGET <span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb60-1012"><a href="#cb60-1012" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-1013"><a href="#cb60-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1014"><a href="#cb60-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#drop target and yet to be vaccinated</span></span>
<span id="cb60-1015"><a href="#cb60-1015" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">=</span> <span class="fu">subset</span>(copy_cjkt_df, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Total_Population,CITY_AREA,DISTRICT,TARGET,YET_TO_BE_VACINATED) )</span>
<span id="cb60-1016"><a href="#cb60-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1017"><a href="#cb60-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#for clarity, reorder the columns to time period, subdistrict, vaccination rates</span></span>
<span id="cb60-1018"><a href="#cb60-1018" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df<span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(VACCINATION_RATES, <span class="at">.after=</span>Sub_District)</span>
<span id="cb60-1019"><a href="#cb60-1019" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df<span class="ot">&lt;-</span> copy_cjkt_df <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(TIME_PERIOD)</span>
<span id="cb60-1020"><a href="#cb60-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1021"><a href="#cb60-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(copy_cjkt_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Sub_District"</span>,<span class="st">"Vaccination_Rate"</span>,<span class="st">"geometry"</span>)</span>
<span id="cb60-1022"><a href="#cb60-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1023"><a href="#cb60-1023" aria-hidden="true" tabindex="-1"></a>copy_cjkt_df <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(copy_cjkt_df)</span>
<span id="cb60-1024"><a href="#cb60-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1025"><a href="#cb60-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1028"><a href="#cb60-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1029"><a href="#cb60-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(copy_cjkt_df)</span>
<span id="cb60-1030"><a href="#cb60-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#class(copy_cjkt_df$TIME_PERIOD)</span></span>
<span id="cb60-1031"><a href="#cb60-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#typeof(copy_cjkt_df$TIME_PERIOD)</span></span>
<span id="cb60-1032"><a href="#cb60-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1033"><a href="#cb60-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1034"><a href="#cb60-1034" aria-hidden="true" tabindex="-1"></a>The code chunk below creates a time series cube using spacetime() of sfdep package:</span>
<span id="cb60-1035"><a href="#cb60-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1038"><a href="#cb60-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1039"><a href="#cb60-1039" aria-hidden="true" tabindex="-1"></a>vr_st<span class="ot">&lt;-</span> <span class="fu">as_spacetime</span>(copy_cjkt_df,</span>
<span id="cb60-1040"><a href="#cb60-1040" aria-hidden="true" tabindex="-1"></a>                                <span class="at">.loc_col =</span> <span class="st">"Sub_District"</span>,</span>
<span id="cb60-1041"><a href="#cb60-1041" aria-hidden="true" tabindex="-1"></a>                                <span class="at">.time_col =</span> <span class="st">"Date"</span>)</span>
<span id="cb60-1042"><a href="#cb60-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1043"><a href="#cb60-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1044"><a href="#cb60-1044" aria-hidden="true" tabindex="-1"></a>By using is_spacetime_cube() of sfdep package, we can check if vacc_rate_st is indeed a space-time cube object.</span>
<span id="cb60-1045"><a href="#cb60-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1048"><a href="#cb60-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1049"><a href="#cb60-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(vr_st)</span>
<span id="cb60-1050"><a href="#cb60-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1051"><a href="#cb60-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1054"><a href="#cb60-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1055"><a href="#cb60-1055" aria-hidden="true" tabindex="-1"></a>vr_nb <span class="ot">&lt;-</span> vr_st <span class="sc">%&gt;%</span></span>
<span id="cb60-1056"><a href="#cb60-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-1057"><a href="#cb60-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(<span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb60-1058"><a href="#cb60-1058" aria-hidden="true" tabindex="-1"></a>         <span class="at">wt =</span> <span class="fu">st_inverse_distance</span>(nb, geometry,</span>
<span id="cb60-1059"><a href="#cb60-1059" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">scale=</span><span class="dv">1</span>,</span>
<span id="cb60-1060"><a href="#cb60-1060" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alpha=</span><span class="dv">1</span>),</span>
<span id="cb60-1061"><a href="#cb60-1061" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-1062"><a href="#cb60-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-1063"><a href="#cb60-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span>
<span id="cb60-1064"><a href="#cb60-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1065"><a href="#cb60-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1068"><a href="#cb60-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1069"><a href="#cb60-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vr_nb)</span>
<span id="cb60-1070"><a href="#cb60-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1071"><a href="#cb60-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1074"><a href="#cb60-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1075"><a href="#cb60-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-1076"><a href="#cb60-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1077"><a href="#cb60-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1080"><a href="#cb60-1080" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1081"><a href="#cb60-1081" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> vr_nb <span class="sc">|&gt;</span></span>
<span id="cb60-1082"><a href="#cb60-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">|&gt;</span></span>
<span id="cb60-1083"><a href="#cb60-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb60-1084"><a href="#cb60-1084" aria-hidden="true" tabindex="-1"></a>    Vaccination_Rate, nb, wt, <span class="at">nsim=</span><span class="dv">99</span>)) <span class="sc">|&gt;</span></span>
<span id="cb60-1085"><a href="#cb60-1085" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span>
<span id="cb60-1086"><a href="#cb60-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1087"><a href="#cb60-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>