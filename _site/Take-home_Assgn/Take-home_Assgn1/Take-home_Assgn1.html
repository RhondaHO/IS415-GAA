<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rhonda Ho Kah Yee">
<meta name="dcterms.date" content="2023-02-06">

<title>IS415-GAA - Take-home Assignment 1: Application of Spatial Point Patterns Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-1.12.4/jquery.min.js"></script>
<link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="../../site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Week 1&amp;2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Week 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Week 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Week 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Week 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Week 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-assignment" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Assignment</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-assignment">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Assgn/Take-home_Assgn1/Take-home_Assgn1.html">
 <span class="dropdown-text">Take-home Assignment 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Assgn/Take-home_Assgn2/Take-home_Assgn2.html">
 <span class="dropdown-text">Take-home Assignment 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Take-home Assignment 1: Application of Spatial Point Patterns Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rhonda Ho Kah Yee </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 6, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">February 13, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.1 Objectives</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.2 The Data</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">1.3 Tasks</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting Started</a></li>
  <li><a href="#handling-of-data" id="toc-handling-of-data" class="nav-link" data-scroll-target="#handling-of-data">3. Handling of Data</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">3.1 Importing Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#the-geoboundaries-dataset" id="toc-the-geoboundaries-dataset" class="nav-link" data-scroll-target="#the-geoboundaries-dataset">3.1.1 The Geoboundaries Dataset</a></li>
  <li><a href="#the-nga-dataset" id="toc-the-nga-dataset" class="nav-link" data-scroll-target="#the-nga-dataset">3.1.2 The NGA Dataset</a></li>
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">3.2 Importing Aspatial Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geospatial-data-cleaning" id="toc-geospatial-data-cleaning" class="nav-link" data-scroll-target="#geospatial-data-cleaning">4. Geospatial Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#exclude-redundant-fields" id="toc-exclude-redundant-fields" class="nav-link" data-scroll-target="#exclude-redundant-fields">4.1 Exclude redundant fields</a></li>
  <li><a href="#check-for-duplicate-names" id="toc-check-for-duplicate-names" class="nav-link" data-scroll-target="#check-for-duplicate-names">4.2 Check for duplicate names</a></li>
  </ul></li>
  <li><a href="#data-wrangling-for-water-point-data" id="toc-data-wrangling-for-water-point-data" class="nav-link" data-scroll-target="#data-wrangling-for-water-point-data">5. Data Wrangling for Water Point Data</a>
  <ul class="collapse">
  <li><a href="#converting-sf-data-frames-to-sps-spatial-class" id="toc-converting-sf-data-frames-to-sps-spatial-class" class="nav-link" data-scroll-target="#converting-sf-data-frames-to-sps-spatial-class">5.1 Converting sf data frames to sp’s Spatial* class</a></li>
  <li><a href="#converting-the-spatial-class-into-generic-sp-format" id="toc-converting-the-spatial-class-into-generic-sp-format" class="nav-link" data-scroll-target="#converting-the-spatial-class-into-generic-sp-format">5.2 Converting the Spatial* class into generic sp format</a></li>
  <li><a href="#converting-the-generic-sp-format-into-spatstats-ppp-format" id="toc-converting-the-generic-sp-format-into-spatstats-ppp-format" class="nav-link" data-scroll-target="#converting-the-generic-sp-format-into-spatstats-ppp-format">5.3 Converting the generic sp format into spatstat’s ppp format</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">5.4 Creating owin object</a></li>
  <li><a href="#combining-point-events-object-and-owin-object" id="toc-combining-point-events-object-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-object-and-owin-object">5.5 Combining point events object and owin object</a></li>
  </ul></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis">6. First-order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">6.1 Kernel Density Estimation</a>
  <ul class="collapse">
  <li><a href="#automatic-bandwidth-selection-methods" id="toc-automatic-bandwidth-selection-methods" class="nav-link" data-scroll-target="#automatic-bandwidth-selection-methods">6.1.1 Automatic bandwidth selection methods</a></li>
  <li><a href="#rescalling-kde-values" id="toc-rescalling-kde-values" class="nav-link" data-scroll-target="#rescalling-kde-values">6.1.2 Rescalling KDE values</a></li>
  <li><a href="#kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" id="toc-kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" class="nav-link" data-scroll-target="#kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun">6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</a></li>
  </ul></li>
  <li><a href="#converting-kde-output-into-grid-object" id="toc-converting-kde-output-into-grid-object" class="nav-link" data-scroll-target="#converting-kde-output-into-grid-object">6.2 Converting KDE output into grid object</a>
  <ul class="collapse">
  <li><a href="#converting-gridded-output-into-raster" id="toc-converting-gridded-output-into-raster" class="nav-link" data-scroll-target="#converting-gridded-output-into-raster">6.2.1 Converting gridded output into raster</a></li>
  <li><a href="#assigning-projection-systems" id="toc-assigning-projection-systems" class="nav-link" data-scroll-target="#assigning-projection-systems">6.2.2 Assigning projection systems</a></li>
  <li><a href="#visualising-the-output-in-tmap" id="toc-visualising-the-output-in-tmap" class="nav-link" data-scroll-target="#visualising-the-output-in-tmap">6.2.3 Visualising the output in tmap</a></li>
  <li><a href="#advantage-of-kernel-density-map-over-point-map" id="toc-advantage-of-kernel-density-map-over-point-map" class="nav-link" data-scroll-target="#advantage-of-kernel-density-map-over-point-map">6.2.4 Advantage of Kernel Density map over Point map</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#second-order-spatial-point-patterns-analysis" id="toc-second-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#second-order-spatial-point-patterns-analysis">7. Second-order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#functional-waterpoints-in-nigeria-ossun" id="toc-functional-waterpoints-in-nigeria-ossun" class="nav-link" data-scroll-target="#functional-waterpoints-in-nigeria-ossun">7.1 Functional Waterpoints in Nigeria, Ossun</a>
  <ul class="collapse">
  <li><a href="#hypothesis-test" id="toc-hypothesis-test" class="nav-link" data-scroll-target="#hypothesis-test">7.1.1 Hypothesis Test</a></li>
  <li><a href="#computing-l-function-estimation" id="toc-computing-l-function-estimation" class="nav-link" data-scroll-target="#computing-l-function-estimation">7.1.2 Computing L Function estimation</a></li>
  <li><a href="#performing-complete-spatial-randomness-test" id="toc-performing-complete-spatial-randomness-test" class="nav-link" data-scroll-target="#performing-complete-spatial-randomness-test">7.1.3 Performing Complete Spatial Randomness Test</a></li>
  </ul></li>
  <li><a href="#non-functional-waterpoints-in-nigeria-ossun" id="toc-non-functional-waterpoints-in-nigeria-ossun" class="nav-link" data-scroll-target="#non-functional-waterpoints-in-nigeria-ossun">7.2 Non-functional Waterpoints in Nigeria, Ossun</a>
  <ul class="collapse">
  <li><a href="#hypothesis-test-1" id="toc-hypothesis-test-1" class="nav-link" data-scroll-target="#hypothesis-test-1">7.2.1 Hypothesis Test</a></li>
  <li><a href="#computing-l-function-estimation-1" id="toc-computing-l-function-estimation-1" class="nav-link" data-scroll-target="#computing-l-function-estimation-1">7.2.2 Computing L Function estimation</a></li>
  <li><a href="#performing-complete-spatial-randomness-test-1" id="toc-performing-complete-spatial-randomness-test-1" class="nav-link" data-scroll-target="#performing-complete-spatial-randomness-test-1">7.1.3 Performing Complete Spatial Randomness Test</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  <li><a href="#spatial-correlation-analysis" id="toc-spatial-correlation-analysis" class="nav-link" data-scroll-target="#spatial-correlation-analysis">8. Spatial Correlation Analysis</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>Hello! This is Rhonda Ho’s take-home Assignment 1 for IS415 module.</p>
<p>To view/hide all the code at once, please click on the “&lt;/&gt; code” tab beside the title of this html document and select the option to view/hide the code.</p>
<p>The full details of this assignment can be found <a href="https://is415-ay2022-23t2.netlify.app/th_ex1.html#the-task">here</a>.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.1 Objectives</h2>
<p>Geospatial analytics hold tremendous potential to address complex problems facing society. In this study, I am tasked to apply appropriate spatial point patterns analysis methods to discover the geographical distribution of functional and non-function water points and their co-locations if any in Osun State, Nigeria.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.2 The Data</h2>
<ol type="1">
<li><strong>Apstial data</strong></li>
</ol>
<p>For the purpose of this assignment, data from <a href="https://www.waterpointdata.org/access-data/">WPdx Global Data Repositories</a> will be used. There are two versions of the data. They are: WPdx-Basic and WPdx+. You are required to use <strong>WPdx+</strong> data set.</p>
<ol start="2" type="1">
<li><strong>Geospatial data</strong></li>
</ol>
<p>This study will focus of Osun State, Nigeria. The state boundary GIS data of Nigeria can be downloaded either from The <a href="https://data.humdata.org/">Humanitarian Data Exchange</a> portal or <a href="https://www.geoboundaries.org/">geoBoundaries</a>.</p>
</section>
<section id="tasks" class="level2">
<h2 class="anchored" data-anchor-id="tasks">1.3 Tasks</h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ol type="1">
<li><p><strong>Exploratory Spatial Data Analysis (ESDA)</strong></p>
<ul>
<li><p>Derive kernel density maps of functional and non-functional water points. Using appropriate tmap functions,</p></li>
<li><p>Display the kernel density maps on openstreetmap of Osub State, Nigeria.</p></li>
<li><p>Describe the spatial patterns revealed by the kernel density maps. Highlight the advantage of kernel density map over point map.</p></li>
</ul></li>
<li><p><strong>Second-order Spatial Point Patterns Analysis</strong></p>
<p>With reference to the spatial point patterns observed in ESDA:</p>
<ul>
<li><p>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</p></li>
<li><p>Perform the test by using appropriate Second order spatial point patterns analysis technique.</p></li>
<li><p>With reference to the analysis results, draw statistical conclusions.</p></li>
</ul></li>
<li><p><strong>Spatial Correlation Analysis</strong></p>
<p>In this section, you are required to confirm statistically if the spatial distribution of functional and non-functional water points are independent from each other.</p>
<ul>
<li><p>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</p></li>
<li><p>Perform the test by using appropriate Second order spatial point patterns analysis technique.</p></li>
<li><p>With reference to the analysis results, draw statistical conclusions.</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2. Getting Started</h1>
<p>For the purpose of this assignment, the following packages will be used:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a>: used for importing, managing, and processing geospatial data</p></li>
<li><p><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a>: a collection of packages for data science tasks</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a>: used for creating thematic maps, such as choropleth and bubble maps</p></li>
<li><p><a href="https://spatstat.org/"><strong>spatstat</strong></a>: used for point pattern analysis</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/raster/"><strong>raster</strong></a>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/funModeling/index.html"><strong>funModeling</strong></a>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/maptools/index.html"><strong>maptools</strong></a>: a set of tools for manipulating geographic data and</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/spdep/index.html"><strong>sfdep</strong></a>: for performing geospatial data wrangling and local colocation quotient analysis.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, spatstat, raster, funModeling, maptools, sfdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="handling-of-data" class="level1">
<h1>3. Handling of Data</h1>
<section id="importing-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-data">3.1 Importing Geospatial Data</h2>
<p>In this section, <a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a> of sf package will be used to import the 2 geospatial data sets into R.</p>
<section id="the-geoboundaries-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-geoboundaries-dataset">3.1.1 The Geoboundaries Dataset</h3>
<p>For Nigeria, there are <a href="https://epsg.io/?q=Nigeria%20kind%3APROJCRS">three</a> Projected Coordinate Systems of Nigeria, which is EPSG: 26391, 26392, and 26303. For this assignment, I will be using EPSG:26392.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">layer =</span> <span class="st">"geoBoundaries-NGA-ADM2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `geoBoundaries-NGA-ADM2' from data source 
  `C:\RhondaHO\IS415-GAA\Take-home_Assgn\Take-home_Assgn1\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 774 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.668534 ymin: 4.273007 xmax: 14.67882 ymax: 13.89442
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>To understand more about the columns and data across our dataset, I used the function <a href="https://dplyr.tidyverse.org/reference/glimpse.html#:~:text=glimpse()%20is%20like%20a,as%20much%20data%20as%20possible.">glimpse()</a> as shown in the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(geoNGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 774
Columns: 6
$ shapeName  &lt;chr&gt; "Aba North", "Aba South", "Abadam", "Abaji", "Abak", "Abaka…
$ Level      &lt;chr&gt; "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "AD…
$ shapeID    &lt;chr&gt; "NGA-ADM2-72505758B79815894", "NGA-ADM2-72505758B67905963",…
$ shapeGroup &lt;chr&gt; "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NG…
$ shapeType  &lt;chr&gt; "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "ADM2", "AD…
$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((548795.5 11..., MULTIPOLYGON (…</code></pre>
</div>
</div>
</section>
<section id="the-nga-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-nga-dataset">3.1.2 The NGA Dataset</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2_osgof_20190417"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nga_admbnda_adm2_osgof_20190417' from data source 
  `C:\RhondaHO\IS415-GAA\Take-home_Assgn\Take-home_Assgn1\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 774 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.668534 ymin: 4.273007 xmax: 14.67882 ymax: 13.89442
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 774
Columns: 17
$ Shape_Leng &lt;dbl&gt; 0.2370744, 0.2624772, 3.0753158, 2.5379842, 0.6871498, 1.06…
$ Shape_Area &lt;dbl&gt; 0.0015239210, 0.0035311037, 0.3268678399, 0.0683785064, 0.0…
$ ADM2_EN    &lt;chr&gt; "Aba North", "Aba South", "Abadam", "Abaji", "Abak", "Abaka…
$ ADM2_PCODE &lt;chr&gt; "NG001001", "NG001002", "NG008001", "NG015001", "NG003001",…
$ ADM2_REF   &lt;chr&gt; "Aba North", "Aba South", "Abadam", "Abaji", "Abak", "Abaka…
$ ADM2ALT1EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM2ALT2EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1_EN    &lt;chr&gt; "Abia", "Abia", "Borno", "Federal Capital Territory", "Akwa…
$ ADM1_PCODE &lt;chr&gt; "NG001", "NG001", "NG008", "NG015", "NG003", "NG011", "NG02…
$ ADM0_EN    &lt;chr&gt; "Nigeria", "Nigeria", "Nigeria", "Nigeria", "Nigeria", "Nig…
$ ADM0_PCODE &lt;chr&gt; "NG", "NG", "NG", "NG", "NG", "NG", "NG", "NG", "NG", "NG",…
$ date       &lt;date&gt; 2016-11-29, 2016-11-29, 2016-11-29, 2016-11-29, 2016-11-29…
$ validOn    &lt;date&gt; 2019-04-17, 2019-04-17, 2019-04-17, 2019-04-17, 2019-04-17…
$ validTo    &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ SD_EN      &lt;chr&gt; "Abia South", "Abia South", "Borno North", "Federal Capital…
$ SD_PCODE   &lt;chr&gt; "NG00103", "NG00103", "NG00802", "NG01501", "NG00302", "NG0…
$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((548795.5 11..., MULTIPOLYGON (…</code></pre>
</div>
</div>
<p>By examining both of the sf dataframes closely, we can observe that the NGA dataset provides us with more information with regards to the state i.e Osun which we require to perform our tasks. Hence, NGA data.frame will be used for the subsequent processing.</p>
</section>
<section id="importing-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data">3.2 Importing Aspatial Data</h3>
<p>Moving on to the Aspatial data, as it is in an excel format, I decided to use <a href="https://swcarpentry.github.io/r-novice-inflammation/11-supp-read-write-csv/">read_csv()</a>function. As the area of study for this task is focused on Osun State, Nigeria, I then filtered out the values accordingly using the <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter">filter()</a> function. But how do we know which column to filter by? First, I read up on the description of the metadata in the Aspatial data <a href="https://data.waterpointdata.org/dataset/Water-Point-Data-Exchange-Plus-WPdx-/eqje-vguj">here</a> and discovered that I needed to filter out the country, Nigeria under the ‘clean_country_name’.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_country_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nigeria"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I took a closer look at the data and discovered that the states of Nigeria are splitted in to 4 divisions. To determine where Osun is, I used the function, any() to check which column Osun belonged to.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm1<span class="sc">==</span><span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm2<span class="sc">==</span><span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm3<span class="sc">==</span><span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm4<span class="sc">==</span><span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Based on the output above, Osun only exists under the column ‘clean_adm1’, so I filtered out the Osun state in that specific column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_adm1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we need to convert the aspatial data into sf data.frame.</p>
<p>To do so, it requires two steps. First, we need to convert the <a href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry">wkt</a> field into sfc field by using <code>st_as_sfc()</code> data type.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wp_nga<span class="sc">$</span>Geometry <span class="ot">=</span> <span class="fu">st_as_sfc</span>(wp_nga<span class="sc">$</span><span class="st">`</span><span class="at">new_georeferenced_column_</span><span class="st">`</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wp_nga</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 75
   row_id source     lat_deg lon_deg report_date         statu…¹ water…² water…³
    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 225950 Federal M…    7.43    4.26 2015-05-05 00:00:00 Yes     Boreho… Well   
 2 225524 Federal M…    7.78    4.56 2015-04-22 00:00:00 Yes     Protec… Well   
 3 197014 Federal M…    7.49    4.53 2015-04-30 00:00:00 Yes     Boreho… Well   
 4 225173 Federal M…    7.93    4.73 2015-05-02 00:00:00 Yes     Boreho… Well   
 5 225843 Federal M…    7.74    4.44 2015-05-08 00:00:00 Yes     Boreho… Well   
 6 235508 Federal M…    7.15    4.64 2015-04-27 00:00:00 Yes     Protec… Well   
 7 197708 Federal M…    7.87    4.72 2015-05-13 00:00:00 Yes     Boreho… Well   
 8 195041 Federal M…    7.73    4.45 2015-06-17 00:00:00 Yes     Protec… Spring 
 9 225222 Federal M…    7.81    4.15 2015-05-14 00:00:00 Yes     Protec… Spring 
10 460770 GRID3         7.4     4.33 2018-06-13 00:00:00 Unknown Boreho… Well   
# … with 25 more rows, 67 more variables: water_tech_clean &lt;chr&gt;,
#   `_water_tech_category` &lt;chr&gt;, facility_type &lt;chr&gt;,
#   clean_country_name &lt;chr&gt;, clean_adm1 &lt;chr&gt;, clean_adm2 &lt;chr&gt;,
#   clean_adm3 &lt;lgl&gt;, clean_adm4 &lt;lgl&gt;, install_year &lt;dbl&gt;, installer &lt;chr&gt;,
#   rehab_year &lt;lgl&gt;, rehabilitator &lt;chr&gt;, management_clean &lt;chr&gt;,
#   status_clean &lt;chr&gt;, pay &lt;chr&gt;, fecal_coliform_presence &lt;lgl&gt;,
#   fecal_coliform_value &lt;dbl&gt;, subjective_quality &lt;chr&gt;, activity_id &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Next, we will convert the tibble data.frame into an sf object by using <a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf()</a>. It is also important for us to include the referencing system of the data into the sf object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(wp_nga, <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wp_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 35 features and 74 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4.146705 ymin: 7.153846 xmax: 5 ymax: 8.031187
Geodetic CRS:  WGS 84
# A tibble: 35 × 75
   row_id source     lat_deg lon_deg report_date         statu…¹ water…² water…³
 *  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 225950 Federal M…    7.43    4.26 2015-05-05 00:00:00 Yes     Boreho… Well   
 2 225524 Federal M…    7.78    4.56 2015-04-22 00:00:00 Yes     Protec… Well   
 3 197014 Federal M…    7.49    4.53 2015-04-30 00:00:00 Yes     Boreho… Well   
 4 225173 Federal M…    7.93    4.73 2015-05-02 00:00:00 Yes     Boreho… Well   
 5 225843 Federal M…    7.74    4.44 2015-05-08 00:00:00 Yes     Boreho… Well   
 6 235508 Federal M…    7.15    4.64 2015-04-27 00:00:00 Yes     Protec… Well   
 7 197708 Federal M…    7.87    4.72 2015-05-13 00:00:00 Yes     Boreho… Well   
 8 195041 Federal M…    7.73    4.45 2015-06-17 00:00:00 Yes     Protec… Spring 
 9 225222 Federal M…    7.81    4.15 2015-05-14 00:00:00 Yes     Protec… Spring 
10 460770 GRID3         7.4     4.33 2018-06-13 00:00:00 Unknown Boreho… Well   
# … with 25 more rows, 67 more variables: water_tech_clean &lt;chr&gt;,
#   `_water_tech_category` &lt;chr&gt;, facility_type &lt;chr&gt;,
#   clean_country_name &lt;chr&gt;, clean_adm1 &lt;chr&gt;, clean_adm2 &lt;chr&gt;,
#   clean_adm3 &lt;lgl&gt;, clean_adm4 &lt;lgl&gt;, install_year &lt;dbl&gt;, installer &lt;chr&gt;,
#   rehab_year &lt;lgl&gt;, rehabilitator &lt;chr&gt;, management_clean &lt;chr&gt;,
#   status_clean &lt;chr&gt;, pay &lt;chr&gt;, fecal_coliform_presence &lt;lgl&gt;,
#   fecal_coliform_value &lt;dbl&gt;, subjective_quality &lt;chr&gt;, activity_id &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Afterwards, we need to transform the projection from wgs84 to appropriate projected coordinate system of Nigeria i.e 26392.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="geospatial-data-cleaning" class="level1">
<h1>4. Geospatial Data Cleaning</h1>
<p>Data cleaning is the process of fixing or removing incorrect, corrupted, incorrectly formatted, duplicate, or incomplete data within a dataset. This is important to improve the data quality which will allow us to analyse and infer better quality information.</p>
<section id="exclude-redundant-fields" class="level2">
<h2 class="anchored" data-anchor-id="exclude-redundant-fields">4.1 Exclude redundant fields</h2>
<p>NGA sf data.frame consists of many redundent fields. Thus, I used <a href="https://sparkbyexamples.com/r-programming/r-select-function-from-dplyr/">select()</a> of dplyr to retain the relevant columns which contain the values under the state of Osun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: using select function</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr:: is used as there may be library conflicts which prevents me from using the code</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: keeping the column by name</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#keeps &lt;- c("ADM2_EN","ADM2_PCODE","ADM1_EN","ADM1_PCODE")</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA = NGA[keeps]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Afterwards, I filtered the column ‘ADM1_EN’ to only include Osun Values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>NGA<span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-for-duplicate-names" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicate-names">4.2 Check for duplicate names</h2>
<p>For the code chunk below, the function <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/duplicated">duplicate()</a> is used to check for any duplicated values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>NGA<span class="sc">$</span>ADM2_EN[<span class="fu">duplicated</span>(NGA<span class="sc">$</span>ADM2_EN)<span class="sc">==</span><span class="cn">TRUE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
<p>Hence, based on the output above, there is no duplicated values.</p>
</section>
</section>
<section id="data-wrangling-for-water-point-data" class="level1">
<h1>5. Data Wrangling for Water Point Data</h1>
<p>In this section, I would like to perform data wrangling to improve the data usability as it transforms raw data into more readily used formats.</p>
<p>First off, I discovered that the column ‘status_clean’ shows the type of waterpoints in Nigeria, Osun. To display the frequencies and have a closer look at the unique values of the type ofwaterpoints, I used the function <a href="https://rdrr.io/cran/summarytools/man/freq.html#:~:text=format_number%3A%20format_number-,freq%3A%20Frequency%20Tables%20for%20Factors%20and%20Other%20Discrete%20Data,From%20Arguments%20Passed%20to%20Functions">freq()</a> .</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>funModeling<span class="sc">::</span><span class="fu">freq</span>(<span class="at">data =</span> wp_sf,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_clean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              status_clean frequency percentage cumulative_perc
1 Abandoned/Decommissioned        15      42.86           42.86
2                     &lt;NA&gt;        11      31.43           74.29
3               Functional         8      22.86           97.15
4 Functional, needs repair         1       2.86          100.00</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(wp_sf$status_clean)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As you can see from the output above, there are 4 classes in the ‘status_clean’ field.</p>
<p>Next, we select ‘status_clean’ and the <a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a> function to replace NA values into ‘Unknown’.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>wp_sf_nga <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(status_clean) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_clean =</span> <span class="fu">replace_na</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    status_clean, <span class="st">"Unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can start to extract the water data points base on its status which is functional, non-functional and unknown using the <a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional, needs repair"</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>wp_unknown <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="converting-sf-data-frames-to-sps-spatial-class" class="level2">
<h2 class="anchored" data-anchor-id="converting-sf-data-frames-to-sps-spatial-class">5.1 Converting sf data frames to sp’s Spatial* class</h2>
<p>Next, since the task requires us to perform exploratory spatial data analysis (ESDA), we need to convert simple feature data frame to sp’s Spatial* class using the <a href="https://www.google.com/search?q=as_Spatial%28%29++in+r&amp;ei=5uroY5m5IoiA3LUP5ISEkAQ&amp;ved=0ahUKEwiZxLLSjJD9AhUIALcAHWQCAUIQ4dUDCA8&amp;uact=5&amp;oq=as_Spatial%28%29++in+r&amp;gs_lcp=Cgxnd3Mtd2l6LXNlcnAQAzIJCAAQHhANEPEEMgYIABAWEB4yCAgAEBYQHhAPOgcIABAeEPEEOgYIABAeEA86CQgAEB4QDxDxBDoJCAAQFhAeEPEEOgsIABAWEB4QDxDxBEoECEEYAEoECEYYAFAAWNYFYOgGaABwAXgAgAFIiAH9ApIBATaYAQCgAQKgAQHAAQE&amp;sclient=gws-wiz-serp">as_Spatial()</a> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#overview of wp in Ossun state</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wp_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_sf)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#only functional wp in Ossun state</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>wp_func_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_functional)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#only non-functional wp in Ossun state</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_nonfunctional)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA dataset</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>NGA_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(NGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To further understand our data, we run the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wp_spatial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 35 
extent      : 190156.4, 284643.8, 350391.9, 447614.1  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=4 +lon_0=8.5 +k=0.99975 +x_0=670553.98 +y_0=0 +a=6378249.145 +rf=293.465 +towgs84=-92,-93,122,0,0,0,0 +units=m +no_defs 
variables   : 74
names       : row_id,                                       source,   lat_deg,  lon_deg, report_date, status_id,      water_source_clean, water_source_category, water_tech_clean, X_water_tech_category, facility_type, clean_country_name, clean_adm1, clean_adm2, clean_adm3, ... 
min values  : 194558, Federal Ministry of Water Resources, Nigeria,  7.153846, 4.146705,  1429660800,        No,                Borehole,                Spring,        Hand Pump,             Hand Pump,      Improved,            Nigeria,       Osun,   Aiyedade,         NA, ... 
max values  : 684595,                                        GRID3, 8.0311867,        5,  1535500800,       Yes, Undefined Hand Dug Well,                  Well,  Mechanized Pump,       Mechanized Pump,      Improved,            Nigeria,       Osun,     Osogbo,         NA, ... </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>NGA_spatial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 30 
extent      : 176503.2, 291043.8, 331434.7, 454520.1  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=4 +lon_0=8.5 +k=0.99975 +x_0=670553.98 +y_0=0 +a=6378249.145 +rf=293.465 +towgs84=-92,-93,122,0,0,0,0 +units=m +no_defs 
variables   : 4
names       :  ADM2_EN, ADM2_PCODE, ADM1_EN, ADM1_PCODE 
min values  : Aiyedade,   NG030001,    Osun,      NG030 
max values  :   Osogbo,   NG030030,    Osun,      NG030 </code></pre>
</div>
</div>
<p>Looking at the output above, we understand that wp_spatial belongs to the SpatialPointsDataFrame while NGA_spatial belongs to SpatialPolygonsDataFrame class. This will help us in the next section which is the conversion of Spatial* class into generic sp format.</p>
</section>
<section id="converting-the-spatial-class-into-generic-sp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-spatial-class-into-generic-sp-format">5.2 Converting the Spatial* class into generic sp format</h2>
<p>As spatstat requires the analytical data in ppp object form. We need to convert the Spatial classes* into Spatial object first. The codes chunk below converts the Spatial* classes into generic sp objects.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>wp_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>wp_func_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>NGA_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_spatial, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-the-generic-sp-format-into-spatstats-ppp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-generic-sp-format-into-spatstats-ppp-format">5.3 Converting the generic sp format into spatstat’s ppp format</h2>
<p>Now, we will use <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/as.ppp">as.ppp()</a> function of spatstat to convert the spatial data into spatstat’s ppp object format.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>wp_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_sp, <span class="st">"ppp"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>wp_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern: 35 points
window: rectangle = [190156.37, 284643.78] x [350391.9, 447614.1] units</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>wp_func_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_sp, <span class="st">"ppp"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_sp, <span class="st">"ppp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To further understand our data, let’s look at its summary statistics.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wp_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  35 points
Average intensity 3.810031e-09 points per square unit

Coordinates are given to 2 decimal places
i.e. rounded to the nearest multiple of 0.01 units

Window: rectangle = [190156.37, 284643.78] x [350391.9, 447614.1] units
                    (94490 x 97220 units)
Window area = 9186280000 square units</code></pre>
</div>
</div>
<p>Based on the output above, fortunately, we do not see a warning messages about duplicates. The code chunk below shows an alternate method of checking for duplicates. If it return FALSE, that means there is no duplicated values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_func_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_nonfunc_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="creating-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="creating-owin-object">5.4 Creating owin object</h2>
<p>When analysing spatial point patterns, it is a good practice to confine the analysis with a geographical area, for example, Nigeria’s boundary. In spatstat, an object called owin is specially designed to represent this polygonal region.</p>
<p>The code chunk below is used to convert Nigera, Ossun stats SpatialPolygon object into owin object of spatstat.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>NGA_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_sp, <span class="st">"owin"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(NGA_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NGA_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Window: polygonal boundary
30 separate polygons (no holes)
            vertices      area relative.area
polygon 1        204 766084000       0.08870
polygon 2         81 304399000       0.03520
polygon 3         97 465688000       0.05390
polygon 4        124 373051000       0.04320
polygon 5         60 149473000       0.01730
polygon 6         84 144820000       0.01680
polygon 7         50 102243000       0.01180
polygon 8         72 216002000       0.02500
polygon 9        112 269897000       0.03130
polygon 10       125 365142000       0.04230
polygon 11        83 111191000       0.01290
polygon 12       126 192557000       0.02230
polygon 13       219 904397000       0.10500
polygon 14       174 741131000       0.08580
polygon 15        81 138742000       0.01610
polygon 16        65 119452000       0.01380
polygon 17        90 280205000       0.03240
polygon 18        69  69814600       0.00808
polygon 19        69  42727500       0.00495
polygon 20        49  30458800       0.00353
polygon 21        62 263505000       0.03050
polygon 22        93 438930000       0.05080
polygon 23        87 274127000       0.03170
polygon 24       105 509979000       0.05910
polygon 25        98 292058000       0.03380
polygon 26        64 327765000       0.03800
polygon 27       133 108945000       0.01260
polygon 28       122 462169000       0.05350
polygon 29        94 109715000       0.01270
polygon 30        95  61239800       0.00709
enclosing rectangle: [176503.22, 291043.82] x [331434.7, 454520.1] units
                     (114500 x 123100 units)
Window area = 8635910000 square units
Fraction of frame area: 0.613</code></pre>
</div>
</div>
</section>
<section id="combining-point-events-object-and-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="combining-point-events-object-and-owin-object">5.5 Combining point events object and owin object</h2>
<p>In this last step of geospatial data wrangling, we will extract <em>all waterpoints</em> that are located within Nigeria Ossun by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp <span class="ot">=</span> wp_ppp[NGA_owin]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  34 points
Average intensity 3.937051e-09 points per square unit

Coordinates are given to 2 decimal places
i.e. rounded to the nearest multiple of 0.01 units

Window: polygonal boundary
30 separate polygons (no holes)
            vertices      area relative.area
polygon 1        204 766084000       0.08870
polygon 2         81 304399000       0.03520
polygon 3         97 465688000       0.05390
polygon 4        124 373051000       0.04320
polygon 5         60 149473000       0.01730
polygon 6         84 144820000       0.01680
polygon 7         50 102243000       0.01180
polygon 8         72 216002000       0.02500
polygon 9        112 269897000       0.03130
polygon 10       125 365142000       0.04230
polygon 11        83 111191000       0.01290
polygon 12       126 192557000       0.02230
polygon 13       219 904397000       0.10500
polygon 14       174 741131000       0.08580
polygon 15        81 138742000       0.01610
polygon 16        65 119452000       0.01380
polygon 17        90 280205000       0.03240
polygon 18        69  69814600       0.00808
polygon 19        69  42727500       0.00495
polygon 20        49  30458800       0.00353
polygon 21        62 263505000       0.03050
polygon 22        93 438930000       0.05080
polygon 23        87 274127000       0.03170
polygon 24       105 509979000       0.05910
polygon 25        98 292058000       0.03380
polygon 26        64 327765000       0.03800
polygon 27       133 108945000       0.01260
polygon 28       122 462169000       0.05350
polygon 29        94 109715000       0.01270
polygon 30        95  61239800       0.00709
enclosing rectangle: [176503.22, 291043.82] x [331434.7, 454520.1] units
                     (114500 x 123100 units)
Window area = 8635910000 square units
Fraction of frame area: 0.613</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The code chunk below extract <em>functional waterpoints</em> that are located within Nigeria, Ossun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp <span class="ot">=</span> wp_func_ppp[NGA_owin]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  9 points
Average intensity 1.04216e-09 points per square unit

Coordinates are given to 2 decimal places
i.e. rounded to the nearest multiple of 0.01 units

Window: polygonal boundary
30 separate polygons (no holes)
            vertices      area relative.area
polygon 1        204 766084000       0.08870
polygon 2         81 304399000       0.03520
polygon 3         97 465688000       0.05390
polygon 4        124 373051000       0.04320
polygon 5         60 149473000       0.01730
polygon 6         84 144820000       0.01680
polygon 7         50 102243000       0.01180
polygon 8         72 216002000       0.02500
polygon 9        112 269897000       0.03130
polygon 10       125 365142000       0.04230
polygon 11        83 111191000       0.01290
polygon 12       126 192557000       0.02230
polygon 13       219 904397000       0.10500
polygon 14       174 741131000       0.08580
polygon 15        81 138742000       0.01610
polygon 16        65 119452000       0.01380
polygon 17        90 280205000       0.03240
polygon 18        69  69814600       0.00808
polygon 19        69  42727500       0.00495
polygon 20        49  30458800       0.00353
polygon 21        62 263505000       0.03050
polygon 22        93 438930000       0.05080
polygon 23        87 274127000       0.03170
polygon 24       105 509979000       0.05910
polygon 25        98 292058000       0.03380
polygon 26        64 327765000       0.03800
polygon 27       133 108945000       0.01260
polygon 28       122 462169000       0.05350
polygon 29        94 109715000       0.01270
polygon 30        95  61239800       0.00709
enclosing rectangle: [176503.22, 291043.82] x [331434.7, 454520.1] units
                     (114500 x 123100 units)
Window area = 8635910000 square units
Fraction of frame area: 0.613</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The code chunk below extract <em>non-functional waterpoints</em> that are located within Nigeria, Ossun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp <span class="ot">=</span> wp_nonfunc_ppp[NGA_owin]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpnonfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  14 points
Average intensity 1.621139e-09 points per square unit

Coordinates are given to 2 decimal places
i.e. rounded to the nearest multiple of 0.01 units

Window: polygonal boundary
30 separate polygons (no holes)
            vertices      area relative.area
polygon 1        204 766084000       0.08870
polygon 2         81 304399000       0.03520
polygon 3         97 465688000       0.05390
polygon 4        124 373051000       0.04320
polygon 5         60 149473000       0.01730
polygon 6         84 144820000       0.01680
polygon 7         50 102243000       0.01180
polygon 8         72 216002000       0.02500
polygon 9        112 269897000       0.03130
polygon 10       125 365142000       0.04230
polygon 11        83 111191000       0.01290
polygon 12       126 192557000       0.02230
polygon 13       219 904397000       0.10500
polygon 14       174 741131000       0.08580
polygon 15        81 138742000       0.01610
polygon 16        65 119452000       0.01380
polygon 17        90 280205000       0.03240
polygon 18        69  69814600       0.00808
polygon 19        69  42727500       0.00495
polygon 20        49  30458800       0.00353
polygon 21        62 263505000       0.03050
polygon 22        93 438930000       0.05080
polygon 23        87 274127000       0.03170
polygon 24       105 509979000       0.05910
polygon 25        98 292058000       0.03380
polygon 26        64 327765000       0.03800
polygon 27       133 108945000       0.01260
polygon 28       122 462169000       0.05350
polygon 29        94 109715000       0.01270
polygon 30        95  61239800       0.00709
enclosing rectangle: [176503.22, 291043.82] x [331434.7, 454520.1] units
                     (114500 x 123100 units)
Window area = 8635910000 square units
Fraction of frame area: 0.613</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpnonfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level1">
<h1>6. First-order Spatial Point Patterns Analysis</h1>
<section id="kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation">6.1 Kernel Density Estimation</h2>
<p>In this section, I will be computing the kernel density estimation (KDE) of waterpoints in Singapore.</p>
<section id="automatic-bandwidth-selection-methods" class="level3">
<h3 class="anchored" data-anchor-id="automatic-bandwidth-selection-methods">6.1.1 Automatic bandwidth selection methods</h3>
<p>The code chunk below computes a kernel density by using the following configurations of <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density">density()</a> of spatstat:</p>
<ul>
<li><p>bw.diggle() automatic bandwidth selection method. Other recommended methods are <em>bw.CvL(), bw.scott() or bw.ppl().</em></p></li>
<li><p>The smoothing kernel used is gaussian, which is the default. Other smoothing methods are: “epanechnikov”, “quartic” or “disc”.</p></li>
<li><p>The intensity estimate is corrected for edge effect bias by using method described by Jones (1993) and Diggle (2010, equation 18.9). The default is FALSE.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA_bw, <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (m^2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can observe from the above, the density values of the output range from 0 to 0.00000004 which is way too small to comprehend. This is because the default unit of measurement of WGS 84 is in meter. As a result, the density values computed is in “number of points per square meter”. Thus, for a better visualisation, we need to rescale the KDE values.</p>
</section>
<section id="rescalling-kde-values" class="level3">
<h3 class="anchored" data-anchor-id="rescalling-kde-values">6.1.2 Rescalling KDE values</h3>
<p>In the code chunk below, <a href="https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/rescale">rescale()</a> is used to covert the unit of measurement from meter to kilometer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can re-run density() using the resale data set and plot the output kde map.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (km^2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>According to Baddeley et. (2016), they suggested the use of the bw.ppl() algorithm because in ther experience it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters. But they also insist that if the purpose of once study is to detect a single tight cluster in the midst of random noise then the bw.diggle() method seems to work best.</p>
<p>Hence, I decided to look at the output for both.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.ppl, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" class="level3">
<h3 class="anchored" data-anchor-id="kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun">6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</h3>
<p>Next, I performed the same actions as above the code chunk to derive the KDE for functional and non functional waterpoints respectively.</p>
<section id="kde-for-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="kde-for-functional-waterpoints-in-nigeria-osun"><strong>6.1.3.1 KDE for Functional Waterpoints in Nigeria, Osun</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="kde-for-non-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="kde-for-non-functional-waterpoints-in-nigeria-osun"><strong>6.1.3.2 KDE for Non-functional Waterpoints in Nigeria, Osun</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpnonfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="converting-kde-output-into-grid-object" class="level2">
<h2 class="anchored" data-anchor-id="converting-kde-output-into-grid-object">6.2 Converting KDE output into grid object</h2>
<p>Next, for mapping purposes, I need to convert the KDE output into a grid object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpNGA.bw)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of All Waterpoints, bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="converting-gridded-output-into-raster" class="level3">
<h3 class="anchored" data-anchor-id="converting-gridded-output-into-raster">6.2.1 Converting gridded output into raster</h3>
<p>Next, we will convert the gridded kernal density objects into RasterLayer object by using raster() of raster package.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpNGA_bw)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8948485, 0.9616045  (x, y)
extent     : 176.5032, 291.0438, 331.4347, 454.5201  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -3.469473e-18, 0.0596219  (min, max)</code></pre>
</div>
</div>
<p>Based on the output, the crs property is NA. Hence, we need to assign it.</p>
</section>
<section id="assigning-projection-systems" class="level3">
<h3 class="anchored" data-anchor-id="assigning-projection-systems">6.2.2 Assigning projection systems</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8948485, 0.9616045  (x, y)
extent     : 176.5032, 291.0438, 331.4347, 454.5201  (xmin, xmax, ymin, ymax)
crs        : +init=EPSG:26392 
source     : memory
names      : v 
values     : -3.469473e-18, 0.0596219  (min, max)</code></pre>
</div>
</div>
<p>Based on the output above, the CRS information has been sucessfully added in.</p>
</section>
<section id="visualising-the-output-in-tmap" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-output-in-tmap">6.2.3 Visualising the output in tmap</h3>
<p>Finally, we will display the raster in cartographic quality map using tmap package.</p>
<section id="raster-of-kde-all-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-all-waterpoints-in-nigeria-osun">6.2.3.1 Raster of KDE All Waterpoints in Nigeria, Osun</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the KDE graphs, most of the waterpoints are clustered around the top middle section. Upon further research on the <a href="https://www.google.com/maps/place/Osun,+Nigeria/data=!4m2!3m1!1s0x10381b1492f19919:0x4444a9d7e31afcd3?sa=X&amp;ved=2ahUKEwiFpO3Fyo_9AhVZTWwGHSTkBBIQ8gF6BAh-EAE">cities in Nigeria</a>, State of Osun, I discovered that most of waterpoints are clustered around the city called Osogbo where the Osun river resides.</p>
</section>
<section id="raster-of-kde-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-functional-waterpoints-in-nigeria-osun">6.2.3.2 Raster of KDE Functional Waterpoints in Nigeria, Osun</h4>
<p>To display raster of KDE of functional waterpoints in Nigeria, Osun, simply repeat the steps in section 6.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the same steps in section 6.2</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpfuncNGA.bw)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Functional Waterpoints, bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpfuncNGA_bw)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Functional Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.8</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at the KDE graph for functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the functional waterpoints are mainly clustered in 6 areas. Roughly gauging based on the <a href="https://www.google.com/maps/place/Osun,+Nigeria/@7.500196,4.6687999,9.46z/data=!4m6!3m5!1s0x10381b1492f19919:0x4444a9d7e31afcd3!8m2!3d7.5628964!4d4.5199593!16zL20vMDZ4anFk">cities</a> in Nigeria, Ossun, the most densely populated area of functional waterpoints area is found in the city of Osogbo, followed by Ikirun/Ota, Isero/Ikonifin and Okeigbo. The less densely populated area of functional waterpoints but we are still able to see a cluster are around the city of Ife and Ikire.</p>
</section>
<section id="raster-of-kde-non-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-non-functional-waterpoints-in-nigeria-osun">6.2.3.3 Raster of KDE Non-functional Waterpoints in Nigeria, Osun</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpnonfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpnonfuncNGA.bw)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpnonfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Non-functional Waterpoints, bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpnonfuncNGA_bw)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpnonfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpnonfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Non-functional Waterpoints in Nigeria, Osun"</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.7</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at the KDE graph for non-functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the non-functional waterpoints are roughly clustered in 9 areas. As compared to the functional waterpoints clusters, there are a larger number of non-functional waterpoints clusters but each cluster are much smaller. It also seems that the most densely populated non-functional waterpoints area is quite near, on the right of, the city of Osogbo, where most of the functional waterpoints are.</p>
</section>
<section id="raster-of-kde-all-waterpoints-in-nigeria-osun-openstreetmap" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-all-waterpoints-in-nigeria-osun-openstreetmap">6.2.3.4 Raster of KDE All Waterpoints in Nigeria, Osun (Openstreetmap)</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">29</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0f70a6bfac305bd9d8e2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0f70a6bfac305bd9d8e2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"minZoom":18,"maxZoom":29},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":18,"maxZoom":29,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAACHCAYAAAA7iVZaAAAGTUlEQVR4nO2dvXLbOBCAVx6X+SmUKkmRxp3TpvfL5KH8Mu6vjTs1KeyroiKxS8/wihs4EASQC2Cx2AX2m8kksSWRxIddgEtQ3IEhhmW5W9y/d7ubXavtNPtgIx9fegyqjmDSEzw83b4K+Pz2O0s7bUl31Mq/rHmzccqy3C1OSEpgShhWeLgdzGvD7Zr0ANdIj88H1GtDyVvyQgk5slPbXttOjOmlxxoHI7zFdks/I5Qf+2y/k0wvHUNsfMdGNjeY/THpmTw83S6f3lz13o0zluVueXw+vGaptX284NqpUZAoHOB8SPI7AMDpEGDSAzjGc2rWUvrj8+FszJ8+vfuS16JYaoRvEasxTC/d5/H5oFZuDtOnd65qmySml+6fjs3C1NJD4ZpTe86+s47psajqkV5nie5U27I1+FpDc4pP1dY1R7mPO661NhUhHaCdeK4yqaROtHUFjkV6Tjqtkd+jDr5WzOkhHnPJVdxELne8XZa7xf1ptU8ptqp3Uqt7TSO9ZsKUE/EShftwRTx2YYW4SC+h5SLCHA6/f3bZ7m53s8tpA3LpVOlW22mVE84tvqTDi450bMfhTu9hag9Fh/9vMbbnRrdPU+k1Y9nae3tN3EqhHtNrhzNy6eEOlRxw6j1aZF+9/9LssynmL00nQL4gbIqLCd/tbnbSZMeO5/D7Z1Q4VaRTTVjZau/+gUuqXlHSUjglZJEuLRI5wGQvaVEOgJBes6i+FzEZrSKOqwzLLp1qY62pmTdIh016Sjh2MSE3pefDko4hBnXFsVo6gIxGoyqASDiWGJTik7N3TWl9DUxZ1J91z7AitniChrl9hovUOXMJrgNIOC4fljFdU6Rv1cIBAH78Om5+ztcPewCQKZ4lvWsBM5aHwu+PL2evud5fwo9fx1fx7rMliadC9FW2LTBp3Rd+f3yJCne/c6/vdV2cC7WRXiLc8c+/f87e++3jO7g/vsD1Xm2ToFEZ6TUTt5jw8OeY8V8zUemaJnEA2xO3VErXAnVxRmWkt+Dbx3e9d4GNqHQpCw0xYNK6P07H5IY/82fwvWnhYthZy9cP+5MUf72/fE3zqai+3l+KEt4KlcUZTDHGkZqUuQ7gZwFf+NX7L93P0VtlXJXSAfLEO1IdIJTtmE46gGzxqUpcTWFFknAAZumSZTtKLqX6HWJtxerIwgEC6Rpk+1DfRCBBtoNFujbhPjXyJYn2aS5ds3DHaOvjWkq/GEE4FhP+Pxeaqm81aBHOwQVA3R2QEpD6jQ9SOSnDSrxnbI0RZXME31ntXYP4EWVzou4qmwmvJ3k9XeI4P4NwjiyrZhHFiAWYFK3FFz3bq/d3vOSgTbhPl6tsKTilzyrc0UJ8dno34fpBL5eylD4OWalDepSPKrvrEmiuUzgT3pbsMV3auTuACc8lewm0pBLtLLJzHp2NofqDqDsB59d0aYJSenVFrmRnbGbeF9Y7XHzZNlnrh5ra++zCKYdRNdINOtikz3BZtDVU0V4tXdIpnIFDRXqffTz3oQgyNukmTg5V0i2196G23cWnd8sQ9BRLtyjvS81DjMRHurFOiXhW6bmp2lI7jlzxFumDkJPui6TXjOcWvW3BuOkS6Z/eXG3Kt87Rjq7pPSXfhLdF/M0OBh7sgpZhvyZUK1viwlvMirZR8iaL9Dp6rygu3riJz6e3bIeldwakyHawn6cb/bGK3ISY9MZIS+0ANqY3Q6Jsh0X6hJj0CTHpEyL6O2eMNogqw6bugtF41W2oiRy38K3fGfmoGdNNPB3oFNRyLM8RqiXVD5XeDf2gpEuJcoOGTel2ijYeq9JNeBmSx3MAG9PJkS4cQID0nNm49Jm7BuEAAqRjkS5cE+Kvp5tsesRKN9ntSI5B2Jl7r+e6SETLmI66m+LsTZGDG1V6rHj0+e13FXJTJNN7TKKWnmysszp7d5IlPpivJw9Pt6qz2uoTGP2/jb8Mm95z0fBg3lq0y3aoKc70wp06jiIcQPB5uhRGHN4s0iekS6RrOc8fMcoBOkR6qiGlNbC0/aGEVPpWQ9X+3qCBLb1jhYavk5j2tcOS3qu+Ccminxxy6aEkkyaPJundRMtGjRyusX2GDjtVRW4GoRhUNAJFlJvwv0xRhjXhp6iXbgs88lHTWNjlW+HrrEMop+axVIYxNf8BbpRZR4RnM1gAAAAASUVORK5CYII=",[[3.98263255221117,2.47233210623881],[3.9815098213762,2.47337418758891]],1,null,"tmap401","kde_wpNGA_bw_raster"]},{"method":"addLegend","args":[{"colors":["#FFFFBF","#E4F39A","#BFE47A","#92D067","#66BD63","#30A355"],"labels":["0.00 to 0.01","0.01 to 0.02","0.02 to 0.03","0.03 to 0.04","0.04 to 0.05","0.05 to 0.06"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_wpNGA_bw_raster","group":"kde_wpNGA_bw_raster"}]},{"method":"addLayersControl","args":[[],"kde_wpNGA_bw_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[3.9815098213762,3.98263255221117],"lng":[2.47233210623881,2.47337418758891]},"setView":[[3.98207118679369,2.47285314691386],18,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="advantage-of-kernel-density-map-over-point-map" class="level3">
<h3 class="anchored" data-anchor-id="advantage-of-kernel-density-map-over-point-map">6.2.4 Advantage of Kernel Density map over Point map</h3>
<p>KDE map takes into account the location of features relative to each other while for a point map, it shows the quantity specified by the population field that falls within the identified neighborhood and divide that quantity by the area of the neighborhood.</p>
<p>The disadvantages of a point map includes:</p>
<ul>
<li><p>Overcrowding of points, when the scale is small, which makes it harder for the user to analyse the map</p></li>
<li><p>Subjected to distortion of shape, distance, direction, scale, and area</p></li>
</ul>
<p>Thus, using KDE map would be a more accurate representation than a point map as it tackles the disadvantages of a point map.</p>
</section>
</section>
</section>
<section id="second-order-spatial-point-patterns-analysis" class="level1">
<h1>7. Second-order Spatial Point Patterns Analysis</h1>
<p>For this section, I intend to analyse the spatial point processes using L-Function by using <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/Lest">Lest()</a> of spatstat package and testing if it is significantly different from a complete spatial randomness process. Two hypothesis test will be conducted for functional and non-functional waterpoints in Nigeria, Osun respectively.</p>
<p><strong>What is <a href="https://rdrr.io/cran/spatstat.core/man/Lest.html">L-function</a>?</strong></p>
<p>A brief description of the L-function is that it is a variance-normalized version of the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley's%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.">Ripley’s K statistic</a> where it is used to determine whether points have a random, dispersed or clustered distribution pattern at certain scale. Thus, this allows us to compare a given point distribution with a random distribution that is the point distribution under investigation is tested against the null hypothesis that the points are distributed randomly and independently.</p>
<p><strong>What is a <a href="https://link.springer.com/article/10.1007/s10182-021-00434-4#:~:text=Complete%20spatial%20randomness%20(CSR)%20describes,is%20to%20test%20for%20CSR.">Complete spatial randomness (CSR)</a>?</strong></p>
<p>It refers to a point process whereby point events occur within a given study area in a completely random fashion. It is synonymous with a homogeneous spatial Poisson process. If the hypothesis is not rejected, one can assume that the given point pattern is random, and we refer to it as a homogeneous Poisson point pattern.</p>
<section id="functional-waterpoints-in-nigeria-ossun" class="level2">
<h2 class="anchored" data-anchor-id="functional-waterpoints-in-nigeria-ossun">7.1 Functional Waterpoints in Nigeria, Ossun</h2>
<section id="hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test">7.1.1 Hypothesis Test</h3>
<ul>
<li><p>Null hypothesis, H0: The distribution of <em>functional waterpoints</em> in Nigeria, Osun is <em>randomly distributed.</em></p></li>
<li><p>Alternative hypothesis, H1: The distribution of <em>functional waterpoints</em> in Nigeria, Osun is <em>not randomly distributed.</em></p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
</ul>
</section>
<section id="computing-l-function-estimation" class="level3">
<h3 class="anchored" data-anchor-id="computing-l-function-estimation">7.1.2 Computing L Function estimation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>L_func <span class="ot">=</span> <span class="fu">Lest</span>(wpfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="performing-complete-spatial-randomness-test" class="level3">
<h3 class="anchored" data-anchor-id="performing-complete-spatial-randomness-test">7.1.3 Performing Complete Spatial Randomness Test</h3>
<p>Next, we perform the function <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/envelope">envelope()</a> to compute simulation envelopes of the summary function i.e L function. The following arguments are used:</p>
<ul>
<li><p>nsim : Number of simulated point patterns to be generated when computing the envelopes.</p>
<p>As we have chosen the significance level to be 0.05, following this formula from the documentation, significance level alpha = 2 * nrank / (1 + nsim), nsim would be 39.</p></li>
<li><p>rank: Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.</p></li>
<li><p>Logical flag indicating whether envelopes should be pointwise (global=FALSE) or simultaneous (global=TRUE).</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>L_func.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,  39.

Done.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the graph, we can see that the L function is within the randomisation (greyed area). Hence, we cannot reject the null hypothesis as there is insufficient evidence that the distribution of functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</p>
</section>
</section>
<section id="non-functional-waterpoints-in-nigeria-ossun" class="level2">
<h2 class="anchored" data-anchor-id="non-functional-waterpoints-in-nigeria-ossun">7.2 Non-functional Waterpoints in Nigeria, Ossun</h2>
<section id="hypothesis-test-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-1">7.2.1 Hypothesis Test</h3>
<ul>
<li><p>Null hypothesis, H0: The distribution of <em>non-functional waterpoints</em> in Nigeria, Osun is <em>randomly distributed.</em></p></li>
<li><p>Alternative hypothesis, H1: The distribution of <em>non-functional waterpoints</em> in Nigeria, Osun is <em>not randomly distributed.</em></p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
</ul>
</section>
<section id="computing-l-function-estimation-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-l-function-estimation-1">7.2.2 Computing L Function estimation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>L_nonfunc <span class="ot">=</span> <span class="fu">Lest</span>(wpnonfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="performing-complete-spatial-randomness-test-1" class="level3">
<h3 class="anchored" data-anchor-id="performing-complete-spatial-randomness-test-1">7.1.3 Performing Complete Spatial Randomness Test</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>L_nonfunc.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpnonfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,  39.

Done.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Assgn1_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence to prove that the distribution of non-functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</p>
</section>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
</section>
<section id="spatial-correlation-analysis" class="level1">
<h1>8. Spatial Correlation Analysis</h1>
<p>To look into the spatial correlation analysis between functional and non-functional waterpoints, I decided to perform Local Colocation Quotient Analysis <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/learnmorecolocationanalysis.htm">(LCQA)</a> as it measures local patterns of spatial association between two categories of point features using the colocation quotient statistic. The output of this analysis will be a map representing the likelihood of the spatial association between the two categories (i.e functional and non-functional waterpoints) analyzed with added fields including the colocation quotient value and p-value.</p>
<p>If the p-value is less than our selected significance level (i.e 0.05), it means that there is sufficent evidence to reject the null hypothesis.</p>
<p>For this hypothesis testing, the hypothesis are as follows:</p>
<ul>
<li><p>Null hypothesis, H0: The spatial distribution of functional and non-functional water points are <em>independent</em> from each other.</p></li>
<li><p>Alternative hypothesis, H1: The spatial distribution of functional and non-functional water points are <em>not independent</em> from each other.</p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
</ul>
<p>To start off, I need to retrieve the polygon features of functional and non-functional waterpoints in Nigeria, Osun which i had extracted earlier and combined together into one dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">rbind</span>(wp_functional, wp_nonfunctional)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(wpNGA_funct_nonfunct<span class="sc">$</span>status_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Functional"               "Functional, needs repair"
[3] "Abandoned/Decommissioned"</code></pre>
</div>
</div>
<p>Looking at the df of wpNGA_funct_nonfunct, functional waterpoints consist of “Functional” and “Functional, needs repair” and non-functional waterpoints consist of “Abandoned/Decommissioned”. Thus, to make things clearer, I decided to make it so that the df only contains “Functional” or “Non-functional” in the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Functional, needs repair"</span>] <span class="ot">&lt;-</span> <span class="st">"Functional"</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Abandoned/Decommissioned"</span>] <span class="ot">&lt;-</span> <span class="st">"Non-functional"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, <a href="https://sfdep.josiahparry.com/reference/st_knn.html">st_knn()</a> of sfdep package is used to determine the k (i.e.&nbsp;6) nearest neighbours for given point geometry.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">include_self</span>(</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_knn</span>(<span class="fu">st_geometry</span>(wpNGA_funct_nonfunct), <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, <a href="https://sfdep.josiahparry.com/reference/st_kernel_weights.html">st_kernel_weights()</a> of sfdep package is used to derive a weights list by using a kernel function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">st_kernel_weights</span>(nb, </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                        wpNGA_funct_nonfunct, </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"gaussian"</span>, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">adaptive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To compute LCLQ by using sfdep package, the reference point data must be in either character or vector list. The code chunks below are used to prepare two vector lists i.e functional and non-functional waterpoints which are called A and B respectively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>wpfunc <span class="ot">&lt;-</span> wpNGA_funct_nonfunct <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Functional"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> wpfunc<span class="sc">$</span>status_clean</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>wpnonfunc <span class="ot">&lt;-</span> wpNGA_funct_nonfunct <span class="sc">%&gt;%</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Non-functional"</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> wpnonfunc<span class="sc">$</span>status_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below <a href="https://sfdep.josiahparry.com/reference/local_colocation.html">local_colocation()</a> us used to compute the LCLQ values for each functional waterpoint event.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>LCLQ <span class="ot">&lt;-</span> <span class="fu">local_colocation</span>(A, B, nb, wt, <span class="dv">39</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before we can plot the LCLQ values their p-values, we need to join the output of local_colocation() to the stores sf data.frame. However, a quick check of LCLQ data-frame, we can’t find any field can be used as the join field. As a result, <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cbind">cbind()</a> of Base R is useed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>LCLQ_wp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(wpNGA_funct_nonfunct, LCLQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To plot LCLQ values</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co">#qtm(NGA)</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(st_geometry(NGA))</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA is multipolygon, need to change polygon</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(<span class="fu">st_geometry</span>(NGA)) <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(LCLQ_wp)<span class="sc">+</span> </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"X7.Eleven"</span>,</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.01</span>,</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">border.col =</span> <span class="st">"black"</span>,</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">border.lwd =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="acknowledgements" class="level1">
<h1>Acknowledgements</h1>
<p>To conclude, I would like to thank Prof.&nbsp;Kam for our IS415 Geospatial Analytics and Applications course materials &amp; resources.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb102" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Assignment 1: Application of Spatial Point Patterns Analysis"</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "6 february 2023"</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Rhonda Ho Kah Yee"</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co">      code-fold: true</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co">      code-tools: true</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Overview</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>Hello! This is Rhonda Ho's take-home Assignment 1 for IS415 module.</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>To view/hide all the code at once, please click on the "<span class="sc">\&lt;</span>/<span class="sc">\&gt;</span> code" tab beside the title of this html document and select the option to view/hide the code.</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>The full details of this assignment can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://is415-ay2022-23t2.netlify.app/th_ex1.html#the-task)</span>.</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Objectives</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>Geospatial analytics hold tremendous potential to address complex problems facing society. In this study, I am tasked to apply appropriate spatial point patterns analysis methods to discover the geographical distribution of functional and non-function water points and their co-locations if any in Osun State, Nigeria.</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 The Data</span></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Apstial data**</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>For the purpose of this assignment, data from <span class="co">[</span><span class="ot">WPdx Global Data Repositories</span><span class="co">](https://www.waterpointdata.org/access-data/)</span> will be used. There are two versions of the data. They are: WPdx-Basic and WPdx+. You are required to use **WPdx+** data set.</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Geospatial data**</span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>This study will focus of Osun State, Nigeria. The state boundary GIS data of Nigeria can be downloaded either from The <span class="co">[</span><span class="ot">Humanitarian Data Exchange</span><span class="co">](https://data.humdata.org/)</span> portal or <span class="co">[</span><span class="ot">geoBoundaries</span><span class="co">](https://www.geoboundaries.org/)</span>.</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 Tasks</span></span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a>The specific tasks of this take-home exercise are as follows:</span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Exploratory Spatial Data Analysis (ESDA)**</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Derive kernel density maps of functional and non-functional water points. Using appropriate tmap functions,</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Display the kernel density maps on openstreetmap of Osub State, Nigeria.</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Describe the spatial patterns revealed by the kernel density maps. Highlight the advantage of kernel density map over point map.</span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Second-order Spatial Point Patterns Analysis**</span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>    With reference to the spatial point patterns observed in ESDA:</span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Perform the test by using appropriate Second order spatial point patterns analysis technique.</span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the analysis results, draw statistical conclusions.</span>
<span id="cb102-65"><a href="#cb102-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-66"><a href="#cb102-66" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Spatial Correlation Analysis**</span>
<span id="cb102-67"><a href="#cb102-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-68"><a href="#cb102-68" aria-hidden="true" tabindex="-1"></a>    In this section, you are required to confirm statistically if the spatial distribution of functional and non-functional water points are independent from each other.</span>
<span id="cb102-69"><a href="#cb102-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-70"><a href="#cb102-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</span>
<span id="cb102-71"><a href="#cb102-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-72"><a href="#cb102-72" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Perform the test by using appropriate Second order spatial point patterns analysis technique.</span>
<span id="cb102-73"><a href="#cb102-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-74"><a href="#cb102-74" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the analysis results, draw statistical conclusions.</span>
<span id="cb102-75"><a href="#cb102-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-76"><a href="#cb102-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Getting Started</span></span>
<span id="cb102-77"><a href="#cb102-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-78"><a href="#cb102-78" aria-hidden="true" tabindex="-1"></a>For the purpose of this assignment, the following packages will be used:</span>
<span id="cb102-79"><a href="#cb102-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-80"><a href="#cb102-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sf**</span><span class="co">](https://cran.r-project.org/web/packages/sf/index.html)</span>: used for importing, managing, and processing geospatial data</span>
<span id="cb102-81"><a href="#cb102-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-82"><a href="#cb102-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tidyverse**</span><span class="co">](https://www.tidyverse.org/)</span>: a collection of packages for data science tasks</span>
<span id="cb102-83"><a href="#cb102-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-84"><a href="#cb102-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tmap**</span><span class="co">](https://cran.r-project.org/web/packages/tmap/index.html)</span>: used for creating thematic maps, such as choropleth and bubble maps</span>
<span id="cb102-85"><a href="#cb102-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-86"><a href="#cb102-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**spatstat**</span><span class="co">](https://spatstat.org/)</span>: used for point pattern analysis</span>
<span id="cb102-87"><a href="#cb102-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-88"><a href="#cb102-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**raster**</span><span class="co">](https://cran.r-project.org/web/packages/raster/)</span>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</span>
<span id="cb102-89"><a href="#cb102-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-90"><a href="#cb102-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**funModeling**</span><span class="co">](https://cran.r-project.org/web/packages/funModeling/index.html)</span>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</span>
<span id="cb102-91"><a href="#cb102-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-92"><a href="#cb102-92" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**maptools**</span><span class="co">](https://cran.r-project.org/web/packages/maptools/index.html)</span>: a set of tools for manipulating geographic data and</span>
<span id="cb102-93"><a href="#cb102-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-94"><a href="#cb102-94" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sfdep**</span><span class="co">](https://cran.r-project.org/web/packages/spdep/index.html)</span>: for performing geospatial data wrangling and local colocation quotient analysis.</span>
<span id="cb102-95"><a href="#cb102-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-98"><a href="#cb102-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-99"><a href="#cb102-99" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, spatstat, raster, funModeling, maptools, sfdep)</span>
<span id="cb102-100"><a href="#cb102-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-101"><a href="#cb102-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-102"><a href="#cb102-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Handling of Data</span></span>
<span id="cb102-103"><a href="#cb102-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-104"><a href="#cb102-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Importing Geospatial Data</span></span>
<span id="cb102-105"><a href="#cb102-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-106"><a href="#cb102-106" aria-hidden="true" tabindex="-1"></a>In this section, <span class="co">[</span><span class="ot">st_read()</span><span class="co">](https://r-spatial.github.io/sf/reference/st_read.html)</span> of sf package will be used to import the 2 geospatial data sets into R.</span>
<span id="cb102-107"><a href="#cb102-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-108"><a href="#cb102-108" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.1 The Geoboundaries Dataset</span></span>
<span id="cb102-109"><a href="#cb102-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-110"><a href="#cb102-110" aria-hidden="true" tabindex="-1"></a>For Nigeria, there are <span class="co">[</span><span class="ot">three</span><span class="co">](https://epsg.io/?q=Nigeria%20kind%3APROJCRS)</span> Projected Coordinate Systems of Nigeria, which is EPSG: 26391, 26392, and 26303. For this assignment, I will be using EPSG:26392.</span>
<span id="cb102-111"><a href="#cb102-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-114"><a href="#cb102-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-115"><a href="#cb102-115" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb102-116"><a href="#cb102-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">layer =</span> <span class="st">"geoBoundaries-NGA-ADM2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-117"><a href="#cb102-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb102-118"><a href="#cb102-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-119"><a href="#cb102-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-120"><a href="#cb102-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-121"><a href="#cb102-121" aria-hidden="true" tabindex="-1"></a>To understand more about the columns and data across our dataset, I used the function <span class="co">[</span><span class="ot">glimpse()</span><span class="co">]</span>(https://dplyr.tidyverse.org/reference/glimpse.html#:~:text=glimpse()%20is%20like%20a,as%20much%20data%20as%20possible.) as shown in the code chunk below.</span>
<span id="cb102-122"><a href="#cb102-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-125"><a href="#cb102-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-126"><a href="#cb102-126" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(geoNGA)</span>
<span id="cb102-127"><a href="#cb102-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-128"><a href="#cb102-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-129"><a href="#cb102-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.2 The NGA Dataset</span></span>
<span id="cb102-130"><a href="#cb102-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-133"><a href="#cb102-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-134"><a href="#cb102-134" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb102-135"><a href="#cb102-135" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2_osgof_20190417"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-136"><a href="#cb102-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb102-137"><a href="#cb102-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-138"><a href="#cb102-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-139"><a href="#cb102-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-142"><a href="#cb102-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-143"><a href="#cb102-143" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NGA)</span>
<span id="cb102-144"><a href="#cb102-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-145"><a href="#cb102-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-146"><a href="#cb102-146" aria-hidden="true" tabindex="-1"></a>By examining both of the sf dataframes closely, we can observe that the NGA dataset provides us with more information with regards to the state i.e Osun which we require to perform our tasks. Hence, NGA data.frame will be used for the subsequent processing.</span>
<span id="cb102-147"><a href="#cb102-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-148"><a href="#cb102-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 Importing Aspatial Data</span></span>
<span id="cb102-149"><a href="#cb102-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-150"><a href="#cb102-150" aria-hidden="true" tabindex="-1"></a>Moving on to the Aspatial data, as it is in an excel format, I decided to use <span class="co">[</span><span class="ot">read_csv()</span><span class="co">](https://swcarpentry.github.io/r-novice-inflammation/11-supp-read-write-csv/)</span>function. As the area of study for this task is focused on Osun State, Nigeria, I then filtered out the values accordingly using the <span class="co">[</span><span class="ot">filter()</span><span class="co">](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter)</span> function. But how do we know which column to filter by? First, I read up on the description of the metadata in the Aspatial data <span class="co">[</span><span class="ot">here</span><span class="co">](https://data.waterpointdata.org/dataset/Water-Point-Data-Exchange-Plus-WPdx-/eqje-vguj)</span> and discovered that I needed to filter out the country, Nigeria under the 'clean_country_name'.</span>
<span id="cb102-151"><a href="#cb102-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-154"><a href="#cb102-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-155"><a href="#cb102-155" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-156"><a href="#cb102-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_country_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nigeria"</span>))</span>
<span id="cb102-157"><a href="#cb102-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-158"><a href="#cb102-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-159"><a href="#cb102-159" aria-hidden="true" tabindex="-1"></a>Next, I took a closer look at the data and discovered that the states of Nigeria are splitted in to 4 divisions. To determine where Osun is, I used the function, any() to check which column Osun belonged to.</span>
<span id="cb102-160"><a href="#cb102-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-163"><a href="#cb102-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-164"><a href="#cb102-164" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm1<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb102-165"><a href="#cb102-165" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm2<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb102-166"><a href="#cb102-166" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm3<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb102-167"><a href="#cb102-167" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm4<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb102-168"><a href="#cb102-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-169"><a href="#cb102-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-170"><a href="#cb102-170" aria-hidden="true" tabindex="-1"></a>Based on the output above, Osun only exists under the column 'clean_adm1', so I filtered out the Osun state in that specific column.</span>
<span id="cb102-171"><a href="#cb102-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-174"><a href="#cb102-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-175"><a href="#cb102-175" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-176"><a href="#cb102-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_adm1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span>
<span id="cb102-177"><a href="#cb102-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-178"><a href="#cb102-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-179"><a href="#cb102-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-180"><a href="#cb102-180" aria-hidden="true" tabindex="-1"></a>Next, we need to convert the aspatial data into sf data.frame.</span>
<span id="cb102-181"><a href="#cb102-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-182"><a href="#cb102-182" aria-hidden="true" tabindex="-1"></a>To do so, it requires two steps. First, we need to convert the <span class="co">[</span><span class="ot">wkt</span><span class="co">](https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry)</span> field into sfc field by using <span class="in">`st_as_sfc()`</span> data type.</span>
<span id="cb102-183"><a href="#cb102-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-186"><a href="#cb102-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-187"><a href="#cb102-187" aria-hidden="true" tabindex="-1"></a>wp_nga<span class="sc">$</span>Geometry <span class="ot">=</span> <span class="fu">st_as_sfc</span>(wp_nga<span class="sc">$</span><span class="st">`</span><span class="at">new_georeferenced_column_</span><span class="st">`</span>)</span>
<span id="cb102-188"><a href="#cb102-188" aria-hidden="true" tabindex="-1"></a>wp_nga</span>
<span id="cb102-189"><a href="#cb102-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-190"><a href="#cb102-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-191"><a href="#cb102-191" aria-hidden="true" tabindex="-1"></a>Next, we will convert the tibble data.frame into an sf object by using <span class="co">[</span><span class="ot">st_sf()</span><span class="co">](https://r-spatial.github.io/sf/reference/sf.html)</span>. It is also important for us to include the referencing system of the data into the sf object.</span>
<span id="cb102-192"><a href="#cb102-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-195"><a href="#cb102-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-196"><a href="#cb102-196" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(wp_nga, <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb102-197"><a href="#cb102-197" aria-hidden="true" tabindex="-1"></a>wp_sf</span>
<span id="cb102-198"><a href="#cb102-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-199"><a href="#cb102-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-200"><a href="#cb102-200" aria-hidden="true" tabindex="-1"></a>Afterwards, we need to transform the projection from wgs84 to appropriate projected coordinate system of Nigeria i.e 26392.</span>
<span id="cb102-201"><a href="#cb102-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-204"><a href="#cb102-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-205"><a href="#cb102-205" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span></span>
<span id="cb102-206"><a href="#cb102-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb102-207"><a href="#cb102-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-208"><a href="#cb102-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-209"><a href="#cb102-209" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Geospatial Data Cleaning</span></span>
<span id="cb102-210"><a href="#cb102-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-211"><a href="#cb102-211" aria-hidden="true" tabindex="-1"></a>Data cleaning is the process of fixing or removing incorrect, corrupted, incorrectly formatted, duplicate, or incomplete data within a dataset. This is important to improve the data quality which will allow us to analyse and infer better quality information.</span>
<span id="cb102-212"><a href="#cb102-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-213"><a href="#cb102-213" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Exclude redundant fields</span></span>
<span id="cb102-214"><a href="#cb102-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-215"><a href="#cb102-215" aria-hidden="true" tabindex="-1"></a>NGA sf data.frame consists of many redundent fields. Thus, I used <span class="co">[</span><span class="ot">select()</span><span class="co">](https://sparkbyexamples.com/r-programming/r-select-function-from-dplyr/)</span> of dplyr to retain the relevant columns which contain the values under the state of Osun.</span>
<span id="cb102-216"><a href="#cb102-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-219"><a href="#cb102-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-220"><a href="#cb102-220" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: using select function</span></span>
<span id="cb102-221"><a href="#cb102-221" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb102-222"><a href="#cb102-222" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span>
<span id="cb102-223"><a href="#cb102-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-224"><a href="#cb102-224" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr:: is used as there may be library conflicts which prevents me from using the code</span></span>
<span id="cb102-225"><a href="#cb102-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-226"><a href="#cb102-226" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: keeping the column by name</span></span>
<span id="cb102-227"><a href="#cb102-227" aria-hidden="true" tabindex="-1"></a><span class="co">#keeps &lt;- c("ADM2_EN","ADM2_PCODE","ADM1_EN","ADM1_PCODE")</span></span>
<span id="cb102-228"><a href="#cb102-228" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA = NGA[keeps]</span></span>
<span id="cb102-229"><a href="#cb102-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-230"><a href="#cb102-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-231"><a href="#cb102-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-232"><a href="#cb102-232" aria-hidden="true" tabindex="-1"></a>Afterwards, I filtered the column 'ADM1_EN' to only include Osun Values.</span>
<span id="cb102-233"><a href="#cb102-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-236"><a href="#cb102-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-237"><a href="#cb102-237" aria-hidden="true" tabindex="-1"></a>NGA<span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb102-238"><a href="#cb102-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span>
<span id="cb102-239"><a href="#cb102-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-240"><a href="#cb102-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-241"><a href="#cb102-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Check for duplicate names</span></span>
<span id="cb102-242"><a href="#cb102-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-243"><a href="#cb102-243" aria-hidden="true" tabindex="-1"></a>For the code chunk below, the function <span class="co">[</span><span class="ot">duplicate()</span><span class="co">](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/duplicated)</span> is used to check for any duplicated values.</span>
<span id="cb102-244"><a href="#cb102-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-247"><a href="#cb102-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-248"><a href="#cb102-248" aria-hidden="true" tabindex="-1"></a>NGA<span class="sc">$</span>ADM2_EN[<span class="fu">duplicated</span>(NGA<span class="sc">$</span>ADM2_EN)<span class="sc">==</span><span class="cn">TRUE</span>]</span>
<span id="cb102-249"><a href="#cb102-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-250"><a href="#cb102-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-251"><a href="#cb102-251" aria-hidden="true" tabindex="-1"></a>Hence, based on the output above, there is no duplicated values.</span>
<span id="cb102-252"><a href="#cb102-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-253"><a href="#cb102-253" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. Data Wrangling for Water Point Data</span></span>
<span id="cb102-254"><a href="#cb102-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-255"><a href="#cb102-255" aria-hidden="true" tabindex="-1"></a>In this section, I would like to perform data wrangling to improve the data usability as it transforms raw data into more readily used formats.</span>
<span id="cb102-256"><a href="#cb102-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-257"><a href="#cb102-257" aria-hidden="true" tabindex="-1"></a>First off, I discovered that the column 'status_clean' shows the type of waterpoints in Nigeria, Osun. To display the frequencies and have a closer look at the unique values of the type ofwaterpoints, I used the function <span class="co">[</span><span class="ot">freq()</span><span class="co">](https://rdrr.io/cran/summarytools/man/freq.html#:~:text=format_number%3A%20format_number-,freq%3A%20Frequency%20Tables%20for%20Factors%20and%20Other%20Discrete%20Data,From%20Arguments%20Passed%20to%20Functions)</span> .</span>
<span id="cb102-258"><a href="#cb102-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-261"><a href="#cb102-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-262"><a href="#cb102-262" aria-hidden="true" tabindex="-1"></a>funModeling<span class="sc">::</span><span class="fu">freq</span>(<span class="at">data =</span> wp_sf,</span>
<span id="cb102-263"><a href="#cb102-263" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_clean'</span>)</span>
<span id="cb102-264"><a href="#cb102-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-265"><a href="#cb102-265" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(wp_sf$status_clean)</span></span>
<span id="cb102-266"><a href="#cb102-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-267"><a href="#cb102-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-268"><a href="#cb102-268" aria-hidden="true" tabindex="-1"></a>As you can see from the output above, there are 4 classes in the 'status_clean' field.</span>
<span id="cb102-269"><a href="#cb102-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-270"><a href="#cb102-270" aria-hidden="true" tabindex="-1"></a>Next, we select 'status_clean' and the <span class="co">[</span><span class="ot">replace_na()</span><span class="co">](https://tidyr.tidyverse.org/reference/replace_na.html)</span> function to replace NA values into 'Unknown'.</span>
<span id="cb102-271"><a href="#cb102-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-274"><a href="#cb102-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-275"><a href="#cb102-275" aria-hidden="true" tabindex="-1"></a>wp_sf_nga <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span> </span>
<span id="cb102-276"><a href="#cb102-276" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(status_clean) <span class="sc">%&gt;%</span></span>
<span id="cb102-277"><a href="#cb102-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_clean =</span> <span class="fu">replace_na</span>(</span>
<span id="cb102-278"><a href="#cb102-278" aria-hidden="true" tabindex="-1"></a>    status_clean, <span class="st">"Unknown"</span>))</span>
<span id="cb102-279"><a href="#cb102-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-280"><a href="#cb102-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-281"><a href="#cb102-281" aria-hidden="true" tabindex="-1"></a>Now, we can start to extract the water data points base on its status which is functional, non-functional and unknown using the <span class="co">[</span><span class="ot">filter()</span><span class="co">](https://dplyr.tidyverse.org/reference/filter.html)</span> function.</span>
<span id="cb102-282"><a href="#cb102-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-285"><a href="#cb102-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-286"><a href="#cb102-286" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb102-287"><a href="#cb102-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb102-288"><a href="#cb102-288" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb102-289"><a href="#cb102-289" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional, needs repair"</span>))</span>
<span id="cb102-290"><a href="#cb102-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-291"><a href="#cb102-291" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb102-292"><a href="#cb102-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb102-293"><a href="#cb102-293" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>))</span>
<span id="cb102-294"><a href="#cb102-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-295"><a href="#cb102-295" aria-hidden="true" tabindex="-1"></a>wp_unknown <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb102-296"><a href="#cb102-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb102-297"><a href="#cb102-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-298"><a href="#cb102-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-299"><a href="#cb102-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.1 Converting sf data frames to sp's Spatial\* class</span></span>
<span id="cb102-300"><a href="#cb102-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-301"><a href="#cb102-301" aria-hidden="true" tabindex="-1"></a>Next, since the task requires us to perform exploratory spatial data analysis (ESDA), we need to convert simple feature data frame to sp's Spatial<span class="sc">\*</span> class using the <span class="co">[</span><span class="ot">as_Spatial()</span><span class="co">](https://www.google.com/search?q=as_Spatial%28%29++in+r&amp;ei=5uroY5m5IoiA3LUP5ISEkAQ&amp;ved=0ahUKEwiZxLLSjJD9AhUIALcAHWQCAUIQ4dUDCA8&amp;uact=5&amp;oq=as_Spatial%28%29++in+r&amp;gs_lcp=Cgxnd3Mtd2l6LXNlcnAQAzIJCAAQHhANEPEEMgYIABAWEB4yCAgAEBYQHhAPOgcIABAeEPEEOgYIABAeEA86CQgAEB4QDxDxBDoJCAAQFhAeEPEEOgsIABAWEB4QDxDxBEoECEEYAEoECEYYAFAAWNYFYOgGaABwAXgAgAFIiAH9ApIBATaYAQCgAQKgAQHAAQE&amp;sclient=gws-wiz-serp)</span> function.</span>
<span id="cb102-302"><a href="#cb102-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-305"><a href="#cb102-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-306"><a href="#cb102-306" aria-hidden="true" tabindex="-1"></a><span class="co">#overview of wp in Ossun state</span></span>
<span id="cb102-307"><a href="#cb102-307" aria-hidden="true" tabindex="-1"></a>wp_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_sf)</span>
<span id="cb102-308"><a href="#cb102-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-309"><a href="#cb102-309" aria-hidden="true" tabindex="-1"></a><span class="co">#only functional wp in Ossun state</span></span>
<span id="cb102-310"><a href="#cb102-310" aria-hidden="true" tabindex="-1"></a>wp_func_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_functional)</span>
<span id="cb102-311"><a href="#cb102-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-312"><a href="#cb102-312" aria-hidden="true" tabindex="-1"></a><span class="co">#only non-functional wp in Ossun state</span></span>
<span id="cb102-313"><a href="#cb102-313" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_nonfunctional)</span>
<span id="cb102-314"><a href="#cb102-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-315"><a href="#cb102-315" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA dataset</span></span>
<span id="cb102-316"><a href="#cb102-316" aria-hidden="true" tabindex="-1"></a>NGA_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(NGA)</span>
<span id="cb102-317"><a href="#cb102-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-318"><a href="#cb102-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-319"><a href="#cb102-319" aria-hidden="true" tabindex="-1"></a>To further understand our data, we run the code chunk below.</span>
<span id="cb102-320"><a href="#cb102-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-323"><a href="#cb102-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-324"><a href="#cb102-324" aria-hidden="true" tabindex="-1"></a>wp_spatial</span>
<span id="cb102-325"><a href="#cb102-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-326"><a href="#cb102-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-329"><a href="#cb102-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-330"><a href="#cb102-330" aria-hidden="true" tabindex="-1"></a>NGA_spatial</span>
<span id="cb102-331"><a href="#cb102-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-332"><a href="#cb102-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-333"><a href="#cb102-333" aria-hidden="true" tabindex="-1"></a>Looking at the output above, we understand that wp_spatial belongs to the SpatialPointsDataFrame while NGA_spatial belongs to SpatialPolygonsDataFrame class. This will help us in the next section which is the conversion of Spatial<span class="sc">\*</span> class into generic sp format.</span>
<span id="cb102-334"><a href="#cb102-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-335"><a href="#cb102-335" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.2 Converting the Spatial\* class into generic sp format</span></span>
<span id="cb102-336"><a href="#cb102-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-337"><a href="#cb102-337" aria-hidden="true" tabindex="-1"></a>As spatstat requires the analytical data in ppp object form. We need to convert the Spatial classes<span class="sc">\*</span> into Spatial object first. The codes chunk below converts the Spatial<span class="sc">\*</span> classes into generic sp objects.</span>
<span id="cb102-338"><a href="#cb102-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-341"><a href="#cb102-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-342"><a href="#cb102-342" aria-hidden="true" tabindex="-1"></a>wp_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb102-343"><a href="#cb102-343" aria-hidden="true" tabindex="-1"></a>wp_func_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb102-344"><a href="#cb102-344" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb102-345"><a href="#cb102-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-346"><a href="#cb102-346" aria-hidden="true" tabindex="-1"></a>NGA_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_spatial, <span class="st">"SpatialPolygons"</span>)</span>
<span id="cb102-347"><a href="#cb102-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-348"><a href="#cb102-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-349"><a href="#cb102-349" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.3 Converting the generic sp format into spatstat's ppp format</span></span>
<span id="cb102-350"><a href="#cb102-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-351"><a href="#cb102-351" aria-hidden="true" tabindex="-1"></a>Now, we will use <span class="co">[</span><span class="ot">as.ppp()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/as.ppp)</span> function of spatstat to convert the spatial data into spatstat's ppp object format.</span>
<span id="cb102-352"><a href="#cb102-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-355"><a href="#cb102-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-356"><a href="#cb102-356" aria-hidden="true" tabindex="-1"></a>wp_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_sp, <span class="st">"ppp"</span>)</span>
<span id="cb102-357"><a href="#cb102-357" aria-hidden="true" tabindex="-1"></a>wp_ppp</span>
<span id="cb102-358"><a href="#cb102-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-359"><a href="#cb102-359" aria-hidden="true" tabindex="-1"></a>wp_func_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_sp, <span class="st">"ppp"</span>)</span>
<span id="cb102-360"><a href="#cb102-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-361"><a href="#cb102-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-362"><a href="#cb102-362" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_sp, <span class="st">"ppp"</span>)</span>
<span id="cb102-363"><a href="#cb102-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-364"><a href="#cb102-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-365"><a href="#cb102-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-366"><a href="#cb102-366" aria-hidden="true" tabindex="-1"></a>To further understand our data, let's look at its summary statistics.</span>
<span id="cb102-367"><a href="#cb102-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-370"><a href="#cb102-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-371"><a href="#cb102-371" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wp_ppp)</span>
<span id="cb102-372"><a href="#cb102-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-373"><a href="#cb102-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-374"><a href="#cb102-374" aria-hidden="true" tabindex="-1"></a>Based on the output above, fortunately, we do not see a warning messages about duplicates. The code chunk below shows an alternate method of checking for duplicates. If it return FALSE, that means there is no duplicated values.</span>
<span id="cb102-375"><a href="#cb102-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-378"><a href="#cb102-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-379"><a href="#cb102-379" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_ppp))</span>
<span id="cb102-380"><a href="#cb102-380" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_func_ppp))</span>
<span id="cb102-381"><a href="#cb102-381" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_nonfunc_ppp))</span>
<span id="cb102-382"><a href="#cb102-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-383"><a href="#cb102-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-384"><a href="#cb102-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.4 Creating owin object</span></span>
<span id="cb102-385"><a href="#cb102-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-386"><a href="#cb102-386" aria-hidden="true" tabindex="-1"></a>When analysing spatial point patterns, it is a good practice to confine the analysis with a geographical area, for example, Nigeria's boundary. In spatstat, an object called owin is specially designed to represent this polygonal region.</span>
<span id="cb102-387"><a href="#cb102-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-388"><a href="#cb102-388" aria-hidden="true" tabindex="-1"></a>The code chunk below is used to convert Nigera, Ossun stats SpatialPolygon object into owin object of spatstat.</span>
<span id="cb102-389"><a href="#cb102-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-392"><a href="#cb102-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-393"><a href="#cb102-393" aria-hidden="true" tabindex="-1"></a>NGA_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_sp, <span class="st">"owin"</span>)</span>
<span id="cb102-394"><a href="#cb102-394" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(NGA_owin)</span>
<span id="cb102-395"><a href="#cb102-395" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NGA_owin)</span>
<span id="cb102-396"><a href="#cb102-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-397"><a href="#cb102-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-398"><a href="#cb102-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.5 Combining point events object and owin object</span></span>
<span id="cb102-399"><a href="#cb102-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-400"><a href="#cb102-400" aria-hidden="true" tabindex="-1"></a>In this last step of geospatial data wrangling, we will extract *all waterpoints* that are located within Nigeria Ossun by using the code chunk below.</span>
<span id="cb102-401"><a href="#cb102-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-404"><a href="#cb102-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-405"><a href="#cb102-405" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp <span class="ot">=</span> wp_ppp[NGA_owin]</span>
<span id="cb102-406"><a href="#cb102-406" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpNGA_ppp)</span>
<span id="cb102-407"><a href="#cb102-407" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_ppp)</span>
<span id="cb102-408"><a href="#cb102-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-409"><a href="#cb102-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-410"><a href="#cb102-410" aria-hidden="true" tabindex="-1"></a>The code chunk below extract *functional waterpoints* that are located within Nigeria, Ossun.</span>
<span id="cb102-411"><a href="#cb102-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-414"><a href="#cb102-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-415"><a href="#cb102-415" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp <span class="ot">=</span> wp_func_ppp[NGA_owin]</span>
<span id="cb102-416"><a href="#cb102-416" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpfuncNGA_ppp)</span>
<span id="cb102-417"><a href="#cb102-417" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpfuncNGA_ppp)</span>
<span id="cb102-418"><a href="#cb102-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-419"><a href="#cb102-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-420"><a href="#cb102-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-421"><a href="#cb102-421" aria-hidden="true" tabindex="-1"></a>The code chunk below extract *non-functional waterpoints* that are located within Nigeria, Ossun.</span>
<span id="cb102-422"><a href="#cb102-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-425"><a href="#cb102-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-426"><a href="#cb102-426" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp <span class="ot">=</span> wp_nonfunc_ppp[NGA_owin]</span>
<span id="cb102-427"><a href="#cb102-427" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpnonfuncNGA_ppp)</span>
<span id="cb102-428"><a href="#cb102-428" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpnonfuncNGA_ppp)</span>
<span id="cb102-429"><a href="#cb102-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-430"><a href="#cb102-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-431"><a href="#cb102-431" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6. First-order Spatial Point Patterns Analysis</span></span>
<span id="cb102-432"><a href="#cb102-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-433"><a href="#cb102-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.1 Kernel Density Estimation</span></span>
<span id="cb102-434"><a href="#cb102-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-435"><a href="#cb102-435" aria-hidden="true" tabindex="-1"></a>In this section, I will be computing the kernel density estimation (KDE) of waterpoints in Singapore.</span>
<span id="cb102-436"><a href="#cb102-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-437"><a href="#cb102-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.1 Automatic bandwidth selection methods</span></span>
<span id="cb102-438"><a href="#cb102-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-439"><a href="#cb102-439" aria-hidden="true" tabindex="-1"></a>The code chunk below computes a kernel density by using the following configurations of <span class="co">[</span><span class="ot">density()</span><span class="co">](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density)</span> of spatstat:</span>
<span id="cb102-440"><a href="#cb102-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-441"><a href="#cb102-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>bw.diggle() automatic bandwidth selection method. Other recommended methods are *bw.CvL(), bw.scott() or bw.ppl().*</span>
<span id="cb102-442"><a href="#cb102-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-443"><a href="#cb102-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The smoothing kernel used is gaussian, which is the default. Other smoothing methods are: "epanechnikov", "quartic" or "disc".</span>
<span id="cb102-444"><a href="#cb102-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-445"><a href="#cb102-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intensity estimate is corrected for edge effect bias by using method described by Jones (1993) and Diggle (2010, equation 18.9). The default is FALSE.</span>
<span id="cb102-446"><a href="#cb102-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-449"><a href="#cb102-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-450"><a href="#cb102-450" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp,</span>
<span id="cb102-451"><a href="#cb102-451" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb102-452"><a href="#cb102-452" aria-hidden="true" tabindex="-1"></a>                              <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb102-453"><a href="#cb102-453" aria-hidden="true" tabindex="-1"></a>                            <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-454"><a href="#cb102-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-455"><a href="#cb102-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-456"><a href="#cb102-456" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA_bw, <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (m^2)"</span>)</span>
<span id="cb102-457"><a href="#cb102-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-458"><a href="#cb102-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-459"><a href="#cb102-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-460"><a href="#cb102-460" aria-hidden="true" tabindex="-1"></a>As we can observe from the above, the density values of the output range from 0 to 0.00000004 which is way too small to comprehend. This is because the default unit of measurement of WGS 84 is in meter. As a result, the density values computed is in "number of points per square meter". Thus, for a better visualisation, we need to rescale the KDE values.</span>
<span id="cb102-461"><a href="#cb102-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-462"><a href="#cb102-462" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.2 Rescalling KDE values</span></span>
<span id="cb102-463"><a href="#cb102-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-464"><a href="#cb102-464" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="co">[</span><span class="ot">rescale()</span><span class="co">](https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/rescale)</span> is used to covert the unit of measurement from meter to kilometer.</span>
<span id="cb102-465"><a href="#cb102-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-468"><a href="#cb102-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-469"><a href="#cb102-469" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb102-470"><a href="#cb102-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-471"><a href="#cb102-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-472"><a href="#cb102-472" aria-hidden="true" tabindex="-1"></a>Now, we can re-run density() using the resale data set and plot the output kde map.</span>
<span id="cb102-473"><a href="#cb102-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-476"><a href="#cb102-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-477"><a href="#cb102-477" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-478"><a href="#cb102-478" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, </span>
<span id="cb102-479"><a href="#cb102-479" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (km^2)"</span>)</span>
<span id="cb102-480"><a href="#cb102-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-481"><a href="#cb102-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-482"><a href="#cb102-482" aria-hidden="true" tabindex="-1"></a>According to Baddeley et. (2016), they suggested the use of the bw.ppl() algorithm because in ther experience it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters. But they also insist that if the purpose of once study is to detect a single tight cluster in the midst of random noise then the bw.diggle() method seems to work best.</span>
<span id="cb102-483"><a href="#cb102-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-484"><a href="#cb102-484" aria-hidden="true" tabindex="-1"></a>Hence, I decided to look at the output for both.</span>
<span id="cb102-485"><a href="#cb102-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-488"><a href="#cb102-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-489"><a href="#cb102-489" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, </span>
<span id="cb102-490"><a href="#cb102-490" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb102-491"><a href="#cb102-491" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb102-492"><a href="#cb102-492" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-493"><a href="#cb102-493" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb102-494"><a href="#cb102-494" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb102-495"><a href="#cb102-495" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.ppl, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.ppl"</span>)</span>
<span id="cb102-496"><a href="#cb102-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-497"><a href="#cb102-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-498"><a href="#cb102-498" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb102-499"><a href="#cb102-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-500"><a href="#cb102-500" aria-hidden="true" tabindex="-1"></a>Next, I performed the same actions as above the code chunk to derive the KDE for functional and non functional waterpoints respectively.</span>
<span id="cb102-501"><a href="#cb102-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-502"><a href="#cb102-502" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **6.1.3.1 KDE for Functional Waterpoints in Nigeria, Osun**</span></span>
<span id="cb102-503"><a href="#cb102-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-506"><a href="#cb102-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-507"><a href="#cb102-507" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb102-508"><a href="#cb102-508" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb102-509"><a href="#cb102-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-510"><a href="#cb102-510" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb102-511"><a href="#cb102-511" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-512"><a href="#cb102-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-513"><a href="#cb102-513" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb102-514"><a href="#cb102-514" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-515"><a href="#cb102-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-516"><a href="#cb102-516" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb102-517"><a href="#cb102-517" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb102-518"><a href="#cb102-518" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.ppl"</span>)</span>
<span id="cb102-519"><a href="#cb102-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-520"><a href="#cb102-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-521"><a href="#cb102-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-522"><a href="#cb102-522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **6.1.3.2 KDE for Non-functional Waterpoints in Nigeria, Osun**</span></span>
<span id="cb102-523"><a href="#cb102-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-526"><a href="#cb102-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-527"><a href="#cb102-527" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb102-528"><a href="#cb102-528" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpnonfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb102-529"><a href="#cb102-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-530"><a href="#cb102-530" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb102-531"><a href="#cb102-531" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-532"><a href="#cb102-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-533"><a href="#cb102-533" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb102-534"><a href="#cb102-534" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb102-535"><a href="#cb102-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-536"><a href="#cb102-536" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb102-537"><a href="#cb102-537" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb102-538"><a href="#cb102-538" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.ppl"</span>)</span>
<span id="cb102-539"><a href="#cb102-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-540"><a href="#cb102-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-541"><a href="#cb102-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.2 Converting KDE output into grid object</span></span>
<span id="cb102-542"><a href="#cb102-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-543"><a href="#cb102-543" aria-hidden="true" tabindex="-1"></a>Next, for mapping purposes, I need to convert the KDE output into a grid object.</span>
<span id="cb102-544"><a href="#cb102-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-547"><a href="#cb102-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-548"><a href="#cb102-548" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpNGA.bw)</span>
<span id="cb102-549"><a href="#cb102-549" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb102-550"><a href="#cb102-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-551"><a href="#cb102-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-552"><a href="#cb102-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-553"><a href="#cb102-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.1 Converting gridded output into raster</span></span>
<span id="cb102-554"><a href="#cb102-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-555"><a href="#cb102-555" aria-hidden="true" tabindex="-1"></a>Next, we will convert the gridded kernal density objects into RasterLayer object by using raster() of raster package.</span>
<span id="cb102-556"><a href="#cb102-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-559"><a href="#cb102-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-560"><a href="#cb102-560" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpNGA_bw)</span>
<span id="cb102-561"><a href="#cb102-561" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span>
<span id="cb102-562"><a href="#cb102-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-563"><a href="#cb102-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-564"><a href="#cb102-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-565"><a href="#cb102-565" aria-hidden="true" tabindex="-1"></a>Based on the output, the crs property is NA. Hence, we need to assign it.</span>
<span id="cb102-566"><a href="#cb102-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-567"><a href="#cb102-567" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.2 Assigning projection systems</span></span>
<span id="cb102-568"><a href="#cb102-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-571"><a href="#cb102-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-572"><a href="#cb102-572" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb102-573"><a href="#cb102-573" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span>
<span id="cb102-574"><a href="#cb102-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-575"><a href="#cb102-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-576"><a href="#cb102-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-577"><a href="#cb102-577" aria-hidden="true" tabindex="-1"></a>Based on the output above, the CRS information has been sucessfully added in.</span>
<span id="cb102-578"><a href="#cb102-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-579"><a href="#cb102-579" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.3 Visualising the output in tmap</span></span>
<span id="cb102-580"><a href="#cb102-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-581"><a href="#cb102-581" aria-hidden="true" tabindex="-1"></a>Finally, we will display the raster in cartographic quality map using tmap package.</span>
<span id="cb102-582"><a href="#cb102-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-583"><a href="#cb102-583" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.1 Raster of KDE All Waterpoints in Nigeria, Osun</span></span>
<span id="cb102-584"><a href="#cb102-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-587"><a href="#cb102-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-588"><a href="#cb102-588" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb102-589"><a href="#cb102-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb102-590"><a href="#cb102-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb102-591"><a href="#cb102-591" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb102-592"><a href="#cb102-592" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-593"><a href="#cb102-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-594"><a href="#cb102-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-595"><a href="#cb102-595" aria-hidden="true" tabindex="-1"></a>Based on the KDE graphs, most of the waterpoints are clustered around the top middle section. Upon further research on the <span class="co">[</span><span class="ot">cities in Nigeria</span><span class="co">](https://www.google.com/maps/place/Osun,+Nigeria/data=!4m2!3m1!1s0x10381b1492f19919:0x4444a9d7e31afcd3?sa=X&amp;ved=2ahUKEwiFpO3Fyo_9AhVZTWwGHSTkBBIQ8gF6BAh-EAE)</span>, State of Osun, I discovered that most of waterpoints are clustered around the city called Osogbo where the Osun river resides.</span>
<span id="cb102-596"><a href="#cb102-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-597"><a href="#cb102-597" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.2 Raster of KDE Functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb102-598"><a href="#cb102-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-599"><a href="#cb102-599" aria-hidden="true" tabindex="-1"></a>To display raster of KDE of functional waterpoints in Nigeria, Osun, simply repeat the steps in section 6.</span>
<span id="cb102-600"><a href="#cb102-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-603"><a href="#cb102-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-604"><a href="#cb102-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the same steps in section 6.2</span></span>
<span id="cb102-605"><a href="#cb102-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-606"><a href="#cb102-606" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb102-607"><a href="#cb102-607" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpfuncNGA.bw)</span>
<span id="cb102-608"><a href="#cb102-608" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb102-609"><a href="#cb102-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-610"><a href="#cb102-610" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb102-611"><a href="#cb102-611" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpfuncNGA_bw)</span>
<span id="cb102-612"><a href="#cb102-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-613"><a href="#cb102-613" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb102-614"><a href="#cb102-614" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb102-615"><a href="#cb102-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-616"><a href="#cb102-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-617"><a href="#cb102-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-618"><a href="#cb102-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-621"><a href="#cb102-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-622"><a href="#cb102-622" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb102-623"><a href="#cb102-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb102-624"><a href="#cb102-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Functional Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb102-625"><a href="#cb102-625" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.8</span>,</span>
<span id="cb102-626"><a href="#cb102-626" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-627"><a href="#cb102-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-628"><a href="#cb102-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-629"><a href="#cb102-629" aria-hidden="true" tabindex="-1"></a>Looking at the KDE graph for functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the functional waterpoints are mainly clustered in 6 areas. Roughly gauging based on the <span class="co">[</span><span class="ot">cities</span><span class="co">](https://www.google.com/maps/place/Osun,+Nigeria/@7.500196,4.6687999,9.46z/data=!4m6!3m5!1s0x10381b1492f19919:0x4444a9d7e31afcd3!8m2!3d7.5628964!4d4.5199593!16zL20vMDZ4anFk)</span> in Nigeria, Ossun, the most densely populated area of functional waterpoints area is found in the city of Osogbo, followed by Ikirun/Ota, Isero/Ikonifin and Okeigbo. The less densely populated area of functional waterpoints but we are still able to see a cluster are around the city of Ife and Ikire.</span>
<span id="cb102-630"><a href="#cb102-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-631"><a href="#cb102-631" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.3 Raster of KDE Non-functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb102-632"><a href="#cb102-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-635"><a href="#cb102-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-636"><a href="#cb102-636" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb102-637"><a href="#cb102-637" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpnonfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpnonfuncNGA.bw)</span>
<span id="cb102-638"><a href="#cb102-638" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpnonfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Non-functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb102-639"><a href="#cb102-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-640"><a href="#cb102-640" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb102-641"><a href="#cb102-641" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpnonfuncNGA_bw)</span>
<span id="cb102-642"><a href="#cb102-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-643"><a href="#cb102-643" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb102-644"><a href="#cb102-644" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpnonfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb102-645"><a href="#cb102-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-646"><a href="#cb102-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-647"><a href="#cb102-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-648"><a href="#cb102-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-651"><a href="#cb102-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-652"><a href="#cb102-652" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpnonfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb102-653"><a href="#cb102-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb102-654"><a href="#cb102-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Non-functional Waterpoints in Nigeria, Osun"</span>,</span>
<span id="cb102-655"><a href="#cb102-655" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.7</span>,</span>
<span id="cb102-656"><a href="#cb102-656" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-657"><a href="#cb102-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-658"><a href="#cb102-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-659"><a href="#cb102-659" aria-hidden="true" tabindex="-1"></a>Looking at the KDE graph for non-functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the non-functional waterpoints are roughly clustered in 9 areas. As compared to the functional waterpoints clusters, there are a larger number of non-functional waterpoints clusters but each cluster are much smaller. It also seems that the most densely populated non-functional waterpoints area is quite near, on the right of, the city of Osogbo, where most of the functional waterpoints are.</span>
<span id="cb102-660"><a href="#cb102-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-661"><a href="#cb102-661" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.4 Raster of KDE All Waterpoints in Nigeria, Osun (Openstreetmap)</span></span>
<span id="cb102-662"><a href="#cb102-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-665"><a href="#cb102-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-666"><a href="#cb102-666" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb102-667"><a href="#cb102-667" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb102-668"><a href="#cb102-668" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb102-669"><a href="#cb102-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb102-670"><a href="#cb102-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb102-671"><a href="#cb102-671" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb102-672"><a href="#cb102-672" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-673"><a href="#cb102-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">29</span>)) </span>
<span id="cb102-674"><a href="#cb102-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-675"><a href="#cb102-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-676"><a href="#cb102-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-679"><a href="#cb102-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-680"><a href="#cb102-680" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb102-681"><a href="#cb102-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-682"><a href="#cb102-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-683"><a href="#cb102-683" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.4 Advantage of Kernel Density map over Point map</span></span>
<span id="cb102-684"><a href="#cb102-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-685"><a href="#cb102-685" aria-hidden="true" tabindex="-1"></a>KDE map takes into account the location of features relative to each other while for a point map, it shows the quantity specified by the population field that falls within the identified neighborhood and divide that quantity by the area of the neighborhood.</span>
<span id="cb102-686"><a href="#cb102-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-687"><a href="#cb102-687" aria-hidden="true" tabindex="-1"></a>The disadvantages of a point map includes:</span>
<span id="cb102-688"><a href="#cb102-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-689"><a href="#cb102-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overcrowding of points, when the scale is small, which makes it harder for the user to analyse the map</span>
<span id="cb102-690"><a href="#cb102-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-691"><a href="#cb102-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Subjected to distortion of shape, distance, direction, scale, and area</span>
<span id="cb102-692"><a href="#cb102-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-693"><a href="#cb102-693" aria-hidden="true" tabindex="-1"></a>Thus, using KDE map would be a more accurate representation than a point map as it tackles the disadvantages of a point map.</span>
<span id="cb102-694"><a href="#cb102-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-695"><a href="#cb102-695" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Second-order Spatial Point Patterns Analysis</span></span>
<span id="cb102-696"><a href="#cb102-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-697"><a href="#cb102-697" aria-hidden="true" tabindex="-1"></a>For this section, I intend to analyse the spatial point processes using L-Function by using <span class="co">[</span><span class="ot">Lest()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/Lest)</span> of spatstat package and testing if it is significantly different from a complete spatial randomness process. Two hypothesis test will be conducted for functional and non-functional waterpoints in Nigeria, Osun respectively.</span>
<span id="cb102-698"><a href="#cb102-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-699"><a href="#cb102-699" aria-hidden="true" tabindex="-1"></a>**What is [L-function](https://rdrr.io/cran/spatstat.core/man/Lest.html)?**</span>
<span id="cb102-700"><a href="#cb102-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-701"><a href="#cb102-701" aria-hidden="true" tabindex="-1"></a>A brief description of the L-function is that it is a variance-normalized version of the <span class="co">[</span><span class="ot">Ripley's K statistic</span><span class="co">]</span>(https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley's%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.) where it is used to determine whether points have a random, dispersed or clustered distribution pattern at certain scale. Thus, this allows us to compare a given point distribution with a random distribution that is the point distribution under investigation is tested against the null hypothesis that the points are distributed randomly and independently.</span>
<span id="cb102-702"><a href="#cb102-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-703"><a href="#cb102-703" aria-hidden="true" tabindex="-1"></a>**What is a [Complete spatial randomness (CSR)](https://link.springer.com/article/10.1007/s10182-021-00434-4#:~:text=Complete%20spatial%20randomness%20(CSR)%20describes,is%20to%20test%20for%20CSR.)?**</span>
<span id="cb102-704"><a href="#cb102-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-705"><a href="#cb102-705" aria-hidden="true" tabindex="-1"></a>It refers to a point process whereby point events occur within a given study area in a completely random fashion. It is synonymous with a homogeneous spatial Poisson process. If the hypothesis is not rejected, one can assume that the given point pattern is random, and we refer to it as a homogeneous Poisson point pattern.</span>
<span id="cb102-706"><a href="#cb102-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-707"><a href="#cb102-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.1 Functional Waterpoints in Nigeria, Ossun</span></span>
<span id="cb102-708"><a href="#cb102-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-709"><a href="#cb102-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.1 Hypothesis Test</span></span>
<span id="cb102-710"><a href="#cb102-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-711"><a href="#cb102-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The distribution of *functional waterpoints* in Nigeria, Osun is *randomly distributed.*</span>
<span id="cb102-712"><a href="#cb102-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-713"><a href="#cb102-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The distribution of *functional waterpoints* in Nigeria, Osun is *not randomly distributed.*</span>
<span id="cb102-714"><a href="#cb102-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-715"><a href="#cb102-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb102-716"><a href="#cb102-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-717"><a href="#cb102-717" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.2 Computing L Function estimation</span></span>
<span id="cb102-718"><a href="#cb102-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-721"><a href="#cb102-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-722"><a href="#cb102-722" aria-hidden="true" tabindex="-1"></a>L_func <span class="ot">=</span> <span class="fu">Lest</span>(wpfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb102-723"><a href="#cb102-723" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb102-724"><a href="#cb102-724" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span>
<span id="cb102-725"><a href="#cb102-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-726"><a href="#cb102-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-727"><a href="#cb102-727" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.3 Performing Complete Spatial Randomness Test</span></span>
<span id="cb102-728"><a href="#cb102-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-729"><a href="#cb102-729" aria-hidden="true" tabindex="-1"></a>Next, we perform the function <span class="co">[</span><span class="ot">envelope()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/envelope)</span> to compute simulation envelopes of the summary function i.e L function. The following arguments are used:</span>
<span id="cb102-730"><a href="#cb102-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-731"><a href="#cb102-731" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>nsim : Number of simulated point patterns to be generated when computing the envelopes.</span>
<span id="cb102-732"><a href="#cb102-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-733"><a href="#cb102-733" aria-hidden="true" tabindex="-1"></a>    As we have chosen the significance level to be 0.05, following this formula from the documentation, significance level alpha = 2 <span class="sc">\*</span> nrank / (1 + nsim), nsim would be 39.</span>
<span id="cb102-734"><a href="#cb102-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-735"><a href="#cb102-735" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>rank: Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.</span>
<span id="cb102-736"><a href="#cb102-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-737"><a href="#cb102-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Logical flag indicating whether envelopes should be pointwise (global=FALSE) or simultaneous (global=TRUE).</span>
<span id="cb102-738"><a href="#cb102-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-741"><a href="#cb102-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-742"><a href="#cb102-742" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb102-743"><a href="#cb102-743" aria-hidden="true" tabindex="-1"></a>L_func.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span>
<span id="cb102-744"><a href="#cb102-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-745"><a href="#cb102-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-748"><a href="#cb102-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-749"><a href="#cb102-749" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span>
<span id="cb102-750"><a href="#cb102-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-751"><a href="#cb102-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-752"><a href="#cb102-752" aria-hidden="true" tabindex="-1"></a>Based on the graph, we can see that the L function is within the randomisation (greyed area). Hence, we cannot reject the null hypothesis as there is insufficient evidence that the distribution of functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</span>
<span id="cb102-753"><a href="#cb102-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-754"><a href="#cb102-754" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.2 Non-functional Waterpoints in Nigeria, Ossun</span></span>
<span id="cb102-755"><a href="#cb102-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-756"><a href="#cb102-756" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2.1 Hypothesis Test</span></span>
<span id="cb102-757"><a href="#cb102-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-758"><a href="#cb102-758" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The distribution of *non-functional waterpoints* in Nigeria, Osun is *randomly distributed.*</span>
<span id="cb102-759"><a href="#cb102-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-760"><a href="#cb102-760" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The distribution of *non-functional waterpoints* in Nigeria, Osun is *not randomly distributed.*</span>
<span id="cb102-761"><a href="#cb102-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-762"><a href="#cb102-762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb102-763"><a href="#cb102-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-764"><a href="#cb102-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2.2 Computing L Function estimation</span></span>
<span id="cb102-765"><a href="#cb102-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-768"><a href="#cb102-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-769"><a href="#cb102-769" aria-hidden="true" tabindex="-1"></a>L_nonfunc <span class="ot">=</span> <span class="fu">Lest</span>(wpnonfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb102-770"><a href="#cb102-770" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb102-771"><a href="#cb102-771" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span>
<span id="cb102-772"><a href="#cb102-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-773"><a href="#cb102-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-774"><a href="#cb102-774" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.3 Performing Complete Spatial Randomness Test</span></span>
<span id="cb102-775"><a href="#cb102-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-778"><a href="#cb102-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-779"><a href="#cb102-779" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb102-780"><a href="#cb102-780" aria-hidden="true" tabindex="-1"></a>L_nonfunc.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpnonfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span>
<span id="cb102-781"><a href="#cb102-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-782"><a href="#cb102-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-785"><a href="#cb102-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-786"><a href="#cb102-786" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span>
<span id="cb102-787"><a href="#cb102-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-788"><a href="#cb102-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-789"><a href="#cb102-789" aria-hidden="true" tabindex="-1"></a>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence to prove that the distribution of non-functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</span>
<span id="cb102-790"><a href="#cb102-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-791"><a href="#cb102-791" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb102-792"><a href="#cb102-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-793"><a href="#cb102-793" aria-hidden="true" tabindex="-1"></a><span class="fu"># 8. Spatial Correlation Analysis</span></span>
<span id="cb102-794"><a href="#cb102-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-795"><a href="#cb102-795" aria-hidden="true" tabindex="-1"></a>To look into the spatial correlation analysis between functional and non-functional waterpoints, I decided to perform Local Colocation Quotient Analysis <span class="co">[</span><span class="ot">(LCQA)</span><span class="co">](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/learnmorecolocationanalysis.htm)</span> as it measures local patterns of spatial association between two categories of point features using the colocation quotient statistic. The output of this analysis will be a map representing the likelihood of the spatial association between the two categories (i.e functional and non-functional waterpoints) analyzed with added fields including the colocation quotient value and p-value.</span>
<span id="cb102-796"><a href="#cb102-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-797"><a href="#cb102-797" aria-hidden="true" tabindex="-1"></a>If the p-value is less than our selected significance level (i.e 0.05), it means that there is sufficent evidence to reject the null hypothesis.</span>
<span id="cb102-798"><a href="#cb102-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-799"><a href="#cb102-799" aria-hidden="true" tabindex="-1"></a>For this hypothesis testing, the hypothesis are as follows:</span>
<span id="cb102-800"><a href="#cb102-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-801"><a href="#cb102-801" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The spatial distribution of functional and non-functional water points are *independent* from each other.</span>
<span id="cb102-802"><a href="#cb102-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-803"><a href="#cb102-803" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The spatial distribution of functional and non-functional water points are *not independent* from each other.</span>
<span id="cb102-804"><a href="#cb102-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-805"><a href="#cb102-805" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb102-806"><a href="#cb102-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-807"><a href="#cb102-807" aria-hidden="true" tabindex="-1"></a>To start off, I need to retrieve the polygon features of functional and non-functional waterpoints in Nigeria, Osun which i had extracted earlier and combined together into one dataframe.</span>
<span id="cb102-808"><a href="#cb102-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-811"><a href="#cb102-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-812"><a href="#cb102-812" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">rbind</span>(wp_functional, wp_nonfunctional)</span>
<span id="cb102-813"><a href="#cb102-813" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(wpNGA_funct_nonfunct<span class="sc">$</span>status_clean)</span>
<span id="cb102-814"><a href="#cb102-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-815"><a href="#cb102-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-816"><a href="#cb102-816" aria-hidden="true" tabindex="-1"></a>Looking at the df of wpNGA_funct_nonfunct, functional waterpoints consist of "Functional" and "Functional, needs repair" and non-functional waterpoints consist of "Abandoned/Decommissioned". Thus, to make things clearer, I decided to make it so that the df only contains "Functional" or "Non-functional" in the code chunk below.</span>
<span id="cb102-817"><a href="#cb102-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-820"><a href="#cb102-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-821"><a href="#cb102-821" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Functional, needs repair"</span>] <span class="ot">&lt;-</span> <span class="st">"Functional"</span></span>
<span id="cb102-822"><a href="#cb102-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-823"><a href="#cb102-823" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Abandoned/Decommissioned"</span>] <span class="ot">&lt;-</span> <span class="st">"Non-functional"</span></span>
<span id="cb102-824"><a href="#cb102-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-825"><a href="#cb102-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-826"><a href="#cb102-826" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="co">[</span><span class="ot">st_knn()</span><span class="co">](https://sfdep.josiahparry.com/reference/st_knn.html)</span> of sfdep package is used to determine the k (i.e.&nbsp;6) nearest neighbours for given point geometry.</span>
<span id="cb102-827"><a href="#cb102-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-830"><a href="#cb102-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-831"><a href="#cb102-831" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">include_self</span>(</span>
<span id="cb102-832"><a href="#cb102-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_knn</span>(<span class="fu">st_geometry</span>(wpNGA_funct_nonfunct), <span class="dv">6</span>))</span>
<span id="cb102-833"><a href="#cb102-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-834"><a href="#cb102-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-835"><a href="#cb102-835" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="co">[</span><span class="ot">st_kernel_weights()</span><span class="co">](https://sfdep.josiahparry.com/reference/st_kernel_weights.html)</span> of sfdep package is used to derive a weights list by using a kernel function.</span>
<span id="cb102-836"><a href="#cb102-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-839"><a href="#cb102-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-840"><a href="#cb102-840" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">st_kernel_weights</span>(nb, </span>
<span id="cb102-841"><a href="#cb102-841" aria-hidden="true" tabindex="-1"></a>                        wpNGA_funct_nonfunct, </span>
<span id="cb102-842"><a href="#cb102-842" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"gaussian"</span>, </span>
<span id="cb102-843"><a href="#cb102-843" aria-hidden="true" tabindex="-1"></a>                        <span class="at">adaptive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-844"><a href="#cb102-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-845"><a href="#cb102-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-846"><a href="#cb102-846" aria-hidden="true" tabindex="-1"></a>To compute LCLQ by using sfdep package, the reference point data must be in either character or vector list. The code chunks below are used to prepare two vector lists i.e functional and non-functional waterpoints which are called A and B respectively.</span>
<span id="cb102-847"><a href="#cb102-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-850"><a href="#cb102-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-851"><a href="#cb102-851" aria-hidden="true" tabindex="-1"></a>wpfunc <span class="ot">&lt;-</span> wpNGA_funct_nonfunct <span class="sc">%&gt;%</span></span>
<span id="cb102-852"><a href="#cb102-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Functional"</span>)</span>
<span id="cb102-853"><a href="#cb102-853" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> wpfunc<span class="sc">$</span>status_clean</span>
<span id="cb102-854"><a href="#cb102-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-855"><a href="#cb102-855" aria-hidden="true" tabindex="-1"></a>wpnonfunc <span class="ot">&lt;-</span> wpNGA_funct_nonfunct <span class="sc">%&gt;%</span></span>
<span id="cb102-856"><a href="#cb102-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Non-functional"</span>)</span>
<span id="cb102-857"><a href="#cb102-857" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> wpnonfunc<span class="sc">$</span>status_clean</span>
<span id="cb102-858"><a href="#cb102-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-859"><a href="#cb102-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-860"><a href="#cb102-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-861"><a href="#cb102-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-862"><a href="#cb102-862" aria-hidden="true" tabindex="-1"></a>In the code chunk below <span class="co">[</span><span class="ot">local_colocation()</span><span class="co">](https://sfdep.josiahparry.com/reference/local_colocation.html)</span> us used to compute the LCLQ values for each functional waterpoint event.</span>
<span id="cb102-863"><a href="#cb102-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-866"><a href="#cb102-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-867"><a href="#cb102-867" aria-hidden="true" tabindex="-1"></a>LCLQ <span class="ot">&lt;-</span> <span class="fu">local_colocation</span>(A, B, nb, wt, <span class="dv">39</span>)</span>
<span id="cb102-868"><a href="#cb102-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-869"><a href="#cb102-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-870"><a href="#cb102-870" aria-hidden="true" tabindex="-1"></a>Before we can plot the LCLQ values their p-values, we need to join the output of local_colocation() to the stores sf data.frame. However, a quick check of LCLQ data-frame, we can't find any field can be used as the join field. As a result, <span class="co">[</span><span class="ot">cbind()</span><span class="co">](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cbind)</span> of Base R is useed.</span>
<span id="cb102-871"><a href="#cb102-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-874"><a href="#cb102-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-875"><a href="#cb102-875" aria-hidden="true" tabindex="-1"></a>LCLQ_wp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(wpNGA_funct_nonfunct, LCLQ)</span>
<span id="cb102-876"><a href="#cb102-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-877"><a href="#cb102-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-880"><a href="#cb102-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb102-881"><a href="#cb102-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-882"><a href="#cb102-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-883"><a href="#cb102-883" aria-hidden="true" tabindex="-1"></a><span class="co">#To plot LCLQ values</span></span>
<span id="cb102-884"><a href="#cb102-884" aria-hidden="true" tabindex="-1"></a><span class="co">#qtm(NGA)</span></span>
<span id="cb102-885"><a href="#cb102-885" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(st_geometry(NGA))</span></span>
<span id="cb102-886"><a href="#cb102-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-887"><a href="#cb102-887" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA is multipolygon, need to change polygon</span></span>
<span id="cb102-888"><a href="#cb102-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-889"><a href="#cb102-889" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb102-890"><a href="#cb102-890" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(<span class="fu">st_geometry</span>(NGA)) <span class="sc">+</span></span>
<span id="cb102-891"><a href="#cb102-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb102-892"><a href="#cb102-892" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(LCLQ_wp)<span class="sc">+</span> </span>
<span id="cb102-893"><a href="#cb102-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"X7.Eleven"</span>,</span>
<span id="cb102-894"><a href="#cb102-894" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.01</span>,</span>
<span id="cb102-895"><a href="#cb102-895" aria-hidden="true" tabindex="-1"></a>             <span class="at">border.col =</span> <span class="st">"black"</span>,</span>
<span id="cb102-896"><a href="#cb102-896" aria-hidden="true" tabindex="-1"></a>             <span class="at">border.lwd =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb102-897"><a href="#cb102-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>))</span>
<span id="cb102-898"><a href="#cb102-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-899"><a href="#cb102-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-900"><a href="#cb102-900" aria-hidden="true" tabindex="-1"></a><span class="fu"># Acknowledgements</span></span>
<span id="cb102-901"><a href="#cb102-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-902"><a href="#cb102-902" aria-hidden="true" tabindex="-1"></a>To conclude, I would like to thank Prof. Kam for our IS415 Geospatial Analytics and Applications course materials &amp; resources.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>