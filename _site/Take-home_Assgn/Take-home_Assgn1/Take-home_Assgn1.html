<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rhonda Ho Kah Yee">
<meta name="dcterms.date" content="2023-01-30">

<title>IS415-GAA - Take-home Assignment 1: Application of Spatial Point Patterns Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Week 1&amp;2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Week 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Week 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Week 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-assignment" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Assignment</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-assignment">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Assgn/Take-home_Assgn1/Take-home_Assgn1.html">
 <span class="dropdown-text">Take-home Assignment 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../home.qmd">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Take-home Assignment 1: Application of Spatial Point Patterns Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rhonda Ho Kah Yee </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 30, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">February 12, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.1 Objectives</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.2 The Data</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">1.3 Tasks</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting Started</a></li>
  <li><a href="#handling-of-data" id="toc-handling-of-data" class="nav-link" data-scroll-target="#handling-of-data">3. Handling of Data</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">3.1 Importing Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#the-geoboundaries-dataset" id="toc-the-geoboundaries-dataset" class="nav-link" data-scroll-target="#the-geoboundaries-dataset">3.1.1 The Geoboundaries Dataset</a></li>
  <li><a href="#the-nga-dataset" id="toc-the-nga-dataset" class="nav-link" data-scroll-target="#the-nga-dataset">3.1.2 The NGA Dataset</a></li>
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">3.2 Importing Aspatial Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geospatial-data-cleaning" id="toc-geospatial-data-cleaning" class="nav-link" data-scroll-target="#geospatial-data-cleaning">4 Geospatial Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#exclude-redundant-fields" id="toc-exclude-redundant-fields" class="nav-link" data-scroll-target="#exclude-redundant-fields">4.1 Exclude redundant fields</a></li>
  <li><a href="#check-for-duplicate-names" id="toc-check-for-duplicate-names" class="nav-link" data-scroll-target="#check-for-duplicate-names">4.2 Check for duplicate names</a></li>
  </ul></li>
  <li><a href="#data-wrangling-for-water-point-data" id="toc-data-wrangling-for-water-point-data" class="nav-link" data-scroll-target="#data-wrangling-for-water-point-data">5. Data Wrangling for Water Point Data</a>
  <ul class="collapse">
  <li><a href="#converting-sf-data-frames-to-sps-spatial-class" id="toc-converting-sf-data-frames-to-sps-spatial-class" class="nav-link" data-scroll-target="#converting-sf-data-frames-to-sps-spatial-class">5.1 Converting sf data frames to sp’s Spatial* class</a></li>
  <li><a href="#converting-the-spatial-class-into-generic-sp-format" id="toc-converting-the-spatial-class-into-generic-sp-format" class="nav-link" data-scroll-target="#converting-the-spatial-class-into-generic-sp-format">5.2 Converting the Spatial* class into generic sp format</a></li>
  <li><a href="#converting-the-generic-sp-format-into-spatstats-ppp-format" id="toc-converting-the-generic-sp-format-into-spatstats-ppp-format" class="nav-link" data-scroll-target="#converting-the-generic-sp-format-into-spatstats-ppp-format">5.3 Converting the generic sp format into spatstat’s ppp format</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">5.4 Creating owin object</a></li>
  <li><a href="#combining-point-events-object-and-owin-object" id="toc-combining-point-events-object-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-object-and-owin-object">5.5 Combining point events object and owin object</a></li>
  </ul></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis">6. First-order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">6.1 Kernel Density Estimation</a>
  <ul class="collapse">
  <li><a href="#automatic-bandwidth-selection-methods" id="toc-automatic-bandwidth-selection-methods" class="nav-link" data-scroll-target="#automatic-bandwidth-selection-methods">6.1.1 Automatic bandwidth selection methods</a></li>
  <li><a href="#rescalling-kde-values" id="toc-rescalling-kde-values" class="nav-link" data-scroll-target="#rescalling-kde-values">6.1.2 Rescalling KDE values</a></li>
  <li><a href="#kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" id="toc-kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" class="nav-link" data-scroll-target="#kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun">6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</a></li>
  </ul></li>
  <li><a href="#converting-kde-output-into-grid-object" id="toc-converting-kde-output-into-grid-object" class="nav-link" data-scroll-target="#converting-kde-output-into-grid-object">6.2 Converting KDE output into grid object</a>
  <ul class="collapse">
  <li><a href="#converting-gridded-output-into-raster" id="toc-converting-gridded-output-into-raster" class="nav-link" data-scroll-target="#converting-gridded-output-into-raster">6.2.1 Converting gridded output into raster</a></li>
  <li><a href="#assigning-projection-systems" id="toc-assigning-projection-systems" class="nav-link" data-scroll-target="#assigning-projection-systems">6.2.2 Assigning projection systems</a></li>
  <li><a href="#visualising-the-output-in-tmap" id="toc-visualising-the-output-in-tmap" class="nav-link" data-scroll-target="#visualising-the-output-in-tmap">6.2.3 Visualising the output in tmap</a></li>
  <li><a href="#advantage-of-kernel-density-map-over-point-map" id="toc-advantage-of-kernel-density-map-over-point-map" class="nav-link" data-scroll-target="#advantage-of-kernel-density-map-over-point-map">6.2.4 Advantage of Kernel Density map over Point map</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#second-order-spatial-point-patterns-analysis" id="toc-second-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#second-order-spatial-point-patterns-analysis">7. Second-order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#functional-waterpoints-in-nigeria-ossun" id="toc-functional-waterpoints-in-nigeria-ossun" class="nav-link" data-scroll-target="#functional-waterpoints-in-nigeria-ossun">7.1 Functional Waterpoints in Nigeria, Ossun</a>
  <ul class="collapse">
  <li><a href="#hypothesis-test" id="toc-hypothesis-test" class="nav-link" data-scroll-target="#hypothesis-test">7.1.1 Hypothesis Test</a></li>
  <li><a href="#computing-l-function-estimation" id="toc-computing-l-function-estimation" class="nav-link" data-scroll-target="#computing-l-function-estimation">7.1.2 Computing L Function estimation</a></li>
  <li><a href="#performing-complete-spatial-randomness-test" id="toc-performing-complete-spatial-randomness-test" class="nav-link" data-scroll-target="#performing-complete-spatial-randomness-test">7.1.3 Performing Complete Spatial Randomness Test</a></li>
  </ul></li>
  <li><a href="#non-functional-waterpoints-in-nigeria-ossun" id="toc-non-functional-waterpoints-in-nigeria-ossun" class="nav-link" data-scroll-target="#non-functional-waterpoints-in-nigeria-ossun">7.2 Non-functional Waterpoints in Nigeria, Ossun</a>
  <ul class="collapse">
  <li><a href="#hypothesis-test-1" id="toc-hypothesis-test-1" class="nav-link" data-scroll-target="#hypothesis-test-1">7.2.1 Hypothesis Test</a></li>
  <li><a href="#computing-l-function-estimation-1" id="toc-computing-l-function-estimation-1" class="nav-link" data-scroll-target="#computing-l-function-estimation-1">7.2.2 Computing L Function estimation</a></li>
  <li><a href="#performing-complete-spatial-randomness-test-1" id="toc-performing-complete-spatial-randomness-test-1" class="nav-link" data-scroll-target="#performing-complete-spatial-randomness-test-1">7.1.3 Performing Complete Spatial Randomness Test</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#spatial-correlation-analysis" id="toc-spatial-correlation-analysis" class="nav-link" data-scroll-target="#spatial-correlation-analysis">8. Spatial Correlation Analysis</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>Hello, this is Rhonda Ho’s Take-home Assignment 1 for IS415 module.</p>
<p>To view/hide the code, please click on the “&lt;/&gt; code” tab beside the title and select the option to view/hide the code.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.1 Objectives</h2>
<p>Geospatial analytics hold tremendous potential to address complex problems facing society. In this study, I am tasked to apply appropriate spatial point patterns analysis methods to discover the geographical distribution of functional and non-function water points and their co-locations if any in Osun State, Nigeria.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.2 The Data</h2>
</section>
<section id="tasks" class="level2">
<h2 class="anchored" data-anchor-id="tasks">1.3 Tasks</h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ol type="1">
<li><p><strong>Exploratory Spatial Data Analysis (ESDA)</strong></p>
<ul>
<li><p>Derive kernel density maps of functional and non-functional water points. Using appropriate tmap functions,</p></li>
<li><p>Display the kernel density maps on openstreetmap of Osub State, Nigeria.</p></li>
<li><p>Describe the spatial patterns revealed by the kernel density maps. Highlight the advantage of kernel density map over point map.</p></li>
</ul></li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p><strong>Second-order Spatial Point Patterns Analysis</strong></p>
<p>With reference to the spatial point patterns observed in ESDA:</p>
<ul>
<li><p>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</p></li>
<li><p>Perform the test by using appropriate Second order spatial point patterns analysis technique.</p></li>
<li><p>With reference to the analysis results, draw statistical conclusions.</p></li>
</ul></li>
<li><p><strong>Spatial Correlation Analysis</strong></p>
<p>In this section, you are required to confirm statistically if the spatial distribution of functional and non-functional water points are independent from each other.</p>
<ul>
<li><p>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</p></li>
<li><p>Perform the test by using appropriate Second order spatial point patterns analysis technique.</p></li>
<li><p>With reference to the analysis results, draw statistical conclusions.</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2. Getting Started</h1>
<p>For the purpose of this assignment, the following packages will be used:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a>: used for importing, managing, and processing geospatial data</p></li>
<li><p><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a>: a collection of packages for data science tasks</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a>: used for creating thematic maps, such as choropleth and bubble maps</p></li>
<li><p><a href="https://spatstat.org/"><strong>spatstat</strong></a>: used for point pattern analysis</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/raster/"><strong>raster</strong></a>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/funModeling/index.html"><strong>funModeling</strong></a>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/maptools/index.html"><strong>maptools</strong></a>: a set of tools for manipulating geographic data and</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/spdep/index.html"><strong>sfdep</strong></a>: for performing geospatia data wrangling and local colocation quotient analysis.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, spatstat, raster, funModeling, maptools, sfdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="handling-of-data" class="level1">
<h1>3. Handling of Data</h1>
<section id="importing-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-data">3.1 Importing Geospatial Data</h2>
<p>In this section, <a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a> of sf package will be used to import the 2 geospatial data sets into R.</p>
<section id="the-geoboundaries-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-geoboundaries-dataset">3.1.1 The Geoboundaries Dataset</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">layer =</span> <span class="st">"geoBoundaries-NGA-ADM1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To understand more about the columns and data across our dataset, I used the function <a href="https://dplyr.tidyverse.org/reference/glimpse.html#:~:text=glimpse()%20is%20like%20a,as%20much%20data%20as%20possible.">glimpse()</a> as shown in the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(geoNGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="the-nga-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-nga-dataset">3.1.2 The NGA Dataset</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2_osgof_20190417"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>By examining both of the sf dataframes closely, we can observe that the NGA dataset provides us with more information with regards to the state i.e Osun which we require to perform our tasks. Hence, NGA data.frame will be used for the subsequent processing.</p>
</section>
<section id="importing-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data">3.2 Importing Aspatial Data</h3>
<p>Moving on to the Aspatial data, as it is in an excel format, I decided to use <a href="https://swcarpentry.github.io/r-novice-inflammation/11-supp-read-write-csv/">read_csv()</a>function. As the area of study for this task is focused on Osun State, Nigeria, I then filtered out the values accordingly using the <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter">filter()</a> function. But how do we know which column to filter by? First, I read up on the description of the metadata in the Aspatial data <a href="https://data.waterpointdata.org/dataset/Water-Point-Data-Exchange-Plus-WPdx-/eqje-vguj">here</a> and discovered that I needed to filter out the country, Nigeria under the `clean_country_name`.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_country_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nigeria"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I took a closer look at the data and discovered that the states of Nigeria are splitted in to 4 divisions. To determine where Osun is, I used the function, any() to check which column Osun belonged to.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm1<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm2<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm3<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm4<span class="sc">==</span><span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output above, Osun only exists under the column ‘clean_adm1’, so I filtered out the Osun state in that specific column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_adm1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we need to convert the aspatial data into sf data.frame.</p>
<p>To do so, it requires two steps. First, we need to convert the <a href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry">wkt</a> field into sfc field by using <code>st_as_sfc()</code> data type.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>wp_nga<span class="sc">$</span>Geometry <span class="ot">=</span> <span class="fu">st_as_sfc</span>(wp_nga<span class="sc">$</span><span class="st">`</span><span class="at">new_georeferenced_column_</span><span class="st">`</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>wp_nga</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will convert the tibble data.frame into an sf object by using <a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf()</a>. It is also important for us to include the referencing system of the data into the sf object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(wp_nga, <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>wp_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Afterwards, we need to transform the projection from wgs84 to appropriate projected coordinate system of Nigeria i.e 26392.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="geospatial-data-cleaning" class="level1">
<h1>4 Geospatial Data Cleaning</h1>
<p>Data cleaning is the process of fixing or removing incorrect, corrupted, incorrectly formatted, duplicate, or incomplete data within a dataset. This is important to improve the data quality which will allow us to analyse and infer better quality information.</p>
<section id="exclude-redundant-fields" class="level2">
<h2 class="anchored" data-anchor-id="exclude-redundant-fields">4.1 Exclude redundant fields</h2>
<p>NGA sf data.frame consists of many redundent fields. Thus, I used <a href="https://sparkbyexamples.com/r-programming/r-select-function-from-dplyr/">select()</a> of dplyr to retain the relevant columns which contain the values under the state of Osun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: using select function</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr:: is used as there may be library conflicts which prevents me from using the code</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: keeping the column by name</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#keeps &lt;- c("ADM2_EN","ADM2_PCODE","ADM1_EN","ADM1_PCODE")</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA = NGA[keeps]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Afterwards, I filtered the column ‘ADM1_EN’ to only include Osun Values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>NGA<span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-for-duplicate-names" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicate-names">4.2 Check for duplicate names</h2>
<p>For the code chunk below, the function <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/duplicated">duplicate()</a> is used to check for any duplicated values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>NGA<span class="sc">$</span>ADM2_EN[<span class="fu">duplicated</span>(NGA<span class="sc">$</span>ADM2_EN)<span class="sc">==</span><span class="cn">TRUE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hence, based on the output above, there is no duplicated values.</p>
</section>
</section>
<section id="data-wrangling-for-water-point-data" class="level1">
<h1>5. Data Wrangling for Water Point Data</h1>
<p>In this section, I would like to perform data wrangling to improve the data usability as it transforms raw data into more readily used formats.</p>
<p>First off, I discovered that the column ‘status_clean’ shows the type of waterpoints in Nigeria, Osun. To display the frequencies and have a closer look at the unique values of the type ofwaterpoints, I used the function <a href="https://rdrr.io/cran/summarytools/man/freq.html#:~:text=format_number%3A%20format_number-,freq%3A%20Frequency%20Tables%20for%20Factors%20and%20Other%20Discrete%20Data,From%20Arguments%20Passed%20to%20Functions">freq()</a> .</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>funModeling<span class="sc">::</span><span class="fu">freq</span>(<span class="at">data =</span> wp_sf,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_clean'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(wp_sf$status_clean)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As you can see from the output above, there are 4 classes in the ‘status_clean’ field.</p>
<p>Next, we select ‘status_clean’ and the <a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a> function to replace NA values into ‘Unknown’.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wp_sf_nga <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(status_clean) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_clean =</span> <span class="fu">replace_na</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    status_clean, <span class="st">"Unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can start to extract the water data points base on its status which is functional, non-functional and unknown using the <a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional, needs repair"</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>wp_unknown <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="converting-sf-data-frames-to-sps-spatial-class" class="level2">
<h2 class="anchored" data-anchor-id="converting-sf-data-frames-to-sps-spatial-class">5.1 Converting sf data frames to sp’s Spatial* class</h2>
<p>Next, since the task requires us to perform exploratory spatial data analysis (ESDA), we need to convert simple feature data frame to sp’s Spatial* class using the <a href="https://www.google.com/search?q=as_Spatial%28%29++in+r&amp;ei=5uroY5m5IoiA3LUP5ISEkAQ&amp;ved=0ahUKEwiZxLLSjJD9AhUIALcAHWQCAUIQ4dUDCA8&amp;uact=5&amp;oq=as_Spatial%28%29++in+r&amp;gs_lcp=Cgxnd3Mtd2l6LXNlcnAQAzIJCAAQHhANEPEEMgYIABAWEB4yCAgAEBYQHhAPOgcIABAeEPEEOgYIABAeEA86CQgAEB4QDxDxBDoJCAAQFhAeEPEEOgsIABAWEB4QDxDxBEoECEEYAEoECEYYAFAAWNYFYOgGaABwAXgAgAFIiAH9ApIBATaYAQCgAQKgAQHAAQE&amp;sclient=gws-wiz-serp">as_Spatial()</a> function.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#overview of wp in Ossun state</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>wp_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_sf)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#only functional wp in Ossun state</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>wp_func_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_functional)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#only non-functional wp in Ossun state</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_nonfunctional)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA dataset</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>NGA_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(NGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To further understand our data, we run the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wp_spatial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>NGA_spatial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the output above, we understand that wp_spatial belongs to the SpatialPointsDataFrame while NGA_spatial belongs to SpatialPolygonsDataFrame class. This will help us in the next section which is the conversion of Spatial* class into generic sp format.</p>
</section>
<section id="converting-the-spatial-class-into-generic-sp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-spatial-class-into-generic-sp-format">5.2 Converting the Spatial* class into generic sp format</h2>
<p>As spatstat requires the analytical data in ppp object form. We need to convert the Spatial classes* into Spatial object first. The codes chunk below converts the Spatial* classes into generic sp objects.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>wp_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>wp_func_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>NGA_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_spatial, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-the-generic-sp-format-into-spatstats-ppp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-generic-sp-format-into-spatstats-ppp-format">5.3 Converting the generic sp format into spatstat’s ppp format</h2>
<p>Now, we will use <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/as.ppp">as.ppp()</a> function of spatstat to convert the spatial data into spatstat’s ppp object format.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wp_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_sp, <span class="st">"ppp"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wp_ppp</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>wp_func_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_sp, <span class="st">"ppp"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_sp, <span class="st">"ppp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To further understand our data, let’s look at its summary statistics.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wp_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output above, fortunately, we do not see a warning messages about duplicates. The code chunk below shows an alternate method of checking for duplicates. If it return FALSE, that means there is no duplicated values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_ppp))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_func_ppp))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_nonfunc_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="creating-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="creating-owin-object">5.4 Creating owin object</h2>
<p>When analysing spatial point patterns, it is a good practice to confine the analysis with a geographical area, for example, Nigeria’s boundary. In spatstat, an object called owin is specially designed to represent this polygonal region.</p>
<p>The code chunk below is used to convert Nigera, Ossun stats SpatialPolygon object into owin object of spatstat.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>NGA_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_sp, <span class="st">"owin"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(NGA_owin)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NGA_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combining-point-events-object-and-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="combining-point-events-object-and-owin-object">5.5 Combining point events object and owin object</h2>
<p>In this last step of geospatial data wrangling, we will extract <em>all waterpoints</em> that are located within Nigeria Ossun by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp <span class="ot">=</span> wp_ppp[NGA_owin]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpNGA_ppp)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below extract <em>functional waterpoints</em> that are located within Nigeria, Ossun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp <span class="ot">=</span> wp_func_ppp[NGA_owin]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpfuncNGA_ppp)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below extract <em>non-functional waterpoints</em> that are located within Nigeria, Ossun.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp <span class="ot">=</span> wp_nonfunc_ppp[NGA_owin]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpnonfuncNGA_ppp)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpnonfuncNGA_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level1">
<h1>6. First-order Spatial Point Patterns Analysis</h1>
<section id="kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation">6.1 Kernel Density Estimation</h2>
<p>In this section, I will be computing the kernel density estimation (KDE) of waterpoints in Singapore.</p>
<section id="automatic-bandwidth-selection-methods" class="level3">
<h3 class="anchored" data-anchor-id="automatic-bandwidth-selection-methods">6.1.1 Automatic bandwidth selection methods</h3>
<p>The code chunk below computes a kernel density by using the following configurations of <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density">density()</a> of spatstat:</p>
<ul>
<li><p>bw.diggle() automatic bandwidth selection method. Other recommended methods are <em>bw.CvL(), bw.scott() or bw.ppl().</em></p></li>
<li><p>The smoothing kernel used is gaussian, which is the default. Other smoothing methods are: “epanechnikov”, “quartic” or “disc”.</p></li>
<li><p>The intensity estimate is corrected for edge effect bias by using method described by Jones (1993) and Diggle (2010, equation 18.9). The default is FALSE.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA_bw, <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (m^2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As we can observe from the above, the density values of the output range from 0 to 0.00000004 which is way too small to comprehend. This is because the default unit of measurement of WGS 84 is in meter. As a result, the density values computed is in “number of points per square meter”. Thus, for a better visualisation, we need to rescale the KDE values.</p>
</section>
<section id="rescalling-kde-values" class="level3">
<h3 class="anchored" data-anchor-id="rescalling-kde-values">6.1.2 Rescalling KDE values</h3>
<p>In the code chunk below, <a href="https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/rescale">rescale()</a> is used to covert the unit of measurement from meter to kilometer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can re-run density() using the resale data set and plot the output kde map.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (km^2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>According to Baddeley et. (2016), they suggested the use of the bw.ppl() algorithm because in ther experience it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters. But they also insist that if the purpose of once study is to detect a single tight cluster in the midst of random noise then the bw.diggle() method seems to work best.</p>
<p>Hence, I decided to look at the output for both.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.ppl, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun" class="level3">
<h3 class="anchored" data-anchor-id="kde-for-functional-and-non-functional-waterpoints-in-nigeria-osun">6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</h3>
<p>Next, I performed the same actions as above the code chunk to derive the KDE for functional and non functional waterpoints respectively.</p>
<section id="kde-for-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="kde-for-functional-waterpoints-in-nigeria-osun"><strong>6.1.3.1 KDE for Functional Waterpoints in Nigeria, Osun</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="kde-for-non-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="kde-for-non-functional-waterpoints-in-nigeria-osun"><strong>6.1.3.2 KDE for Non-functional Waterpoints in Nigeria, Osun</strong></h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpnonfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.ppl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="converting-kde-output-into-grid-object" class="level2">
<h2 class="anchored" data-anchor-id="converting-kde-output-into-grid-object">6.2 Converting KDE output into grid object</h2>
<p>Next, for mapping purposes, I need to convert the KDE output into a grid object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpNGA.bw)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of All Waterpoints, bw.diggle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="converting-gridded-output-into-raster" class="level3">
<h3 class="anchored" data-anchor-id="converting-gridded-output-into-raster">6.2.1 Converting gridded output into raster</h3>
<p>Next, we will convert the gridded kernal density objects into RasterLayer object by using raster() of raster package.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpNGA_bw)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output, the crs property is NA. Hence, we need to assign it.</p>
</section>
<section id="assigning-projection-systems" class="level3">
<h3 class="anchored" data-anchor-id="assigning-projection-systems">6.2.2 Assigning projection systems</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the output above, the CRS information has been sucessfully added in.</p>
</section>
<section id="visualising-the-output-in-tmap" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-output-in-tmap">6.2.3 Visualising the output in tmap</h3>
<p>Finally, we will display the raster in cartographic quality map using tmap package.</p>
<section id="raster-of-kde-all-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-all-waterpoints-in-nigeria-osun">6.2.3.1 Raster of KDE All Waterpoints in Nigeria, Osun</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the KDE graphs, most of the waterpoints are clustered around the top middle section. Upon further research on the <a href="https://www.google.com/maps/place/Osun,+Nigeria/data=!4m2!3m1!1s0x10381b1492f19919:0x4444a9d7e31afcd3?sa=X&amp;ved=2ahUKEwiFpO3Fyo_9AhVZTWwGHSTkBBIQ8gF6BAh-EAE">cities in Nigeria</a>, State of Osun, I discovered that most of waterpoints are clustered around the city called Osogbo where the Osun river resides.</p>
</section>
<section id="raster-of-kde-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-functional-waterpoints-in-nigeria-osun">6.2.3.2 Raster of KDE Functional Waterpoints in Nigeria, Osun</h4>
<p>To display raster of KDE of functional waterpoints in Nigeria, Osun, simply repeat the steps in section 6.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the same steps in section 6.2</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpfuncNGA.bw)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpfuncNGA_bw)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Functional Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.8</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the KDE graph for functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the functional waterpoints are mainly clustered in 6 areas. Roughly gauging based on the <a href="https://www.google.com/maps/place/Osun,+Nigeria/@7.500196,4.6687999,9.46z/data=!4m6!3m5!1s0x10381b1492f19919:0x4444a9d7e31afcd3!8m2!3d7.5628964!4d4.5199593!16zL20vMDZ4anFk">cities</a> in Nigeria, Ossun, the most densely populated area of functional waterpoints area is found in the city of Osogbo, followed by Ikirun/Ota, Isero/Ikonifin and Okeigbo. The less densely populated area of functional waterpoints but we are still able to see a cluster are around the city of Ife and Ikire.</p>
</section>
<section id="raster-of-kde-non-functional-waterpoints-in-nigeria-osun" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-non-functional-waterpoints-in-nigeria-osun">6.2.3.3 Raster of KDE Non-functional Waterpoints in Nigeria, Osun</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpnonfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpnonfuncNGA.bw)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpnonfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Non-functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpnonfuncNGA_bw)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpnonfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpnonfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Non-functional Waterpoints in Nigeria, Osun"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.7</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the KDE graph for non-functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the non-functional waterpoints are roughly clustered in 9 areas. As compared to the functional waterpoints clusters, there are a larger number of non-functional waterpoints clusters but each cluster are much smaller. It also seems that the most densely populated non-functional waterpoints area is quite near, on the right of, the city of Osogbo, where most of the functional waterpoints are.</p>
</section>
<section id="raster-of-kde-all-waterpoints-in-nigeria-osun-openstreetmap" class="level4">
<h4 class="anchored" data-anchor-id="raster-of-kde-all-waterpoints-in-nigeria-osun-openstreetmap">6.2.3.4 Raster of KDE All Waterpoints in Nigeria, Osun (Openstreetmap)</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">29</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="advantage-of-kernel-density-map-over-point-map" class="level3">
<h3 class="anchored" data-anchor-id="advantage-of-kernel-density-map-over-point-map">6.2.4 Advantage of Kernel Density map over Point map</h3>
<p>KDE map takes into account the location of features relative to each other while for a point map, it shows the quantity specified by the population field that falls within the identified neighborhood and divide that quantity by the area of the neighborhood.</p>
<p>The disadvantages of a point map includes:</p>
<ul>
<li><p>Overcrowding of points, when the scale is small, which makes it harder for the user to analyse the map</p></li>
<li><p>Subjected to distortion of shape, distance, direction, scale, and area</p></li>
</ul>
<p>Thus, KDE map would be a more accurate representation.</p>
</section>
</section>
</section>
<section id="second-order-spatial-point-patterns-analysis" class="level1">
<h1>7. Second-order Spatial Point Patterns Analysis</h1>
<p>For this section, I intend to analyse the spatial point processes using L-Function by using <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/Lest">Lest()</a> of spatstat package and testing if it is significantly different from a complete spatial randomness process. Two hypothesis test will be conducted for functional and non-functional waterpoints in Nigeria, Osun respectively.</p>
<p><strong>What is <a href="https://rdrr.io/cran/spatstat.core/man/Lest.html">L-function</a>?</strong></p>
<p>A brief description of the L-function is that it is a variance-normalized version of the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley's%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.">Ripley’s K statistic</a> where it is used to determine whether points have a random, dispersed or clustered distribution pattern at certain scale. Thus, this allows us to compare a given point distribution with a random distribution that is the point distribution under investigation is tested against the null hypothesis that the points are distributed randomly and independently.</p>
<p><strong>What is a <a href="https://link.springer.com/article/10.1007/s10182-021-00434-4#:~:text=Complete%20spatial%20randomness%20(CSR)%20describes,is%20to%20test%20for%20CSR.">Complete spatial randomness (CSR)</a>?</strong></p>
<p>It refers to a point process whereby point events occur within a given study area in a completely random fashion. It is synonymous with a homogeneous spatial Poisson process. If the hypothesis is not rejected, one can assume that the given point pattern is random, and we refer to it as a homogeneous Poisson point pattern.</p>
<section id="functional-waterpoints-in-nigeria-ossun" class="level2">
<h2 class="anchored" data-anchor-id="functional-waterpoints-in-nigeria-ossun">7.1 Functional Waterpoints in Nigeria, Ossun</h2>
<section id="hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test">7.1.1 Hypothesis Test</h3>
<ul>
<li><p>Null hypothesis, H0: The distribution of <em>functional waterpoints</em> in Nigeria, Osun is <em>randomly distributed.</em></p></li>
<li><p>Alternative hypothesis, H1: The distribution of <em>functional waterpoints</em> in Nigeria, Osun is <em>not randomly distributed.</em></p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
</ul>
</section>
<section id="computing-l-function-estimation" class="level3">
<h3 class="anchored" data-anchor-id="computing-l-function-estimation">7.1.2 Computing L Function estimation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>L_func <span class="ot">=</span> <span class="fu">Lest</span>(wpfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="performing-complete-spatial-randomness-test" class="level3">
<h3 class="anchored" data-anchor-id="performing-complete-spatial-randomness-test">7.1.3 Performing Complete Spatial Randomness Test</h3>
<p>Next, we perform the function <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/envelope">envelope()</a> to compute simulation envelopes of the summary function i.e L function. The following arguments are used:</p>
<ul>
<li><p>nsim : Number of simulated point patterns to be generated when computing the envelopes.</p>
<p>As we have chosen the significance level to be 0.05, following this formula from the documentation, significance level alpha = 2 * nrank / (1 + nsim), nsim would be 39.</p></li>
<li><p>rank: Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.</p></li>
<li><p>Logical flag indicating whether envelopes should be pointwise (global=FALSE) or simultaneous (global=TRUE).</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>L_func.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence that the distribution of functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</p>
</section>
</section>
<section id="non-functional-waterpoints-in-nigeria-ossun" class="level2">
<h2 class="anchored" data-anchor-id="non-functional-waterpoints-in-nigeria-ossun">7.2 Non-functional Waterpoints in Nigeria, Ossun</h2>
<section id="hypothesis-test-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-1">7.2.1 Hypothesis Test</h3>
<ul>
<li><p>Null hypothesis, H0: The distribution of <em>non-functional waterpoints</em> in Nigeria, Osun is <em>randomly distributed.</em></p></li>
<li><p>Alternative hypothesis, H1: The distribution of <em>non-functional waterpoints</em> in Nigeria, Osun is <em>not randomly distributed.</em></p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
</ul>
</section>
<section id="computing-l-function-estimation-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-l-function-estimation-1">7.2.2 Computing L Function estimation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>L_nonfunc <span class="ot">=</span> <span class="fu">Lest</span>(wpnonfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="performing-complete-spatial-randomness-test-1" class="level3">
<h3 class="anchored" data-anchor-id="performing-complete-spatial-randomness-test-1">7.1.3 Performing Complete Spatial Randomness Test</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>L_nonfunc.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpnonfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence to prove that the distribution of non-functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</p>
</section>
</section>
</section>
<section id="spatial-correlation-analysis" class="level1">
<h1>8. Spatial Correlation Analysis</h1>
<p>To look into the spatial correlation analysis between functional and non-functional waterpoints, I decided to perform Local Colocation Quotient Analysis <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/learnmorecolocationanalysis.htm">(LCQA)</a> as it measures local patterns of spatial association between two categories of point features using the colocation quotient statistic. The output of this analysis will be a map representing the likelihood of the spatial association between the two categories (i.e functional and non-functional waterpoints) analyzed with added fields including the colocation quotient value and p-value.</p>
<p>If the p-value is less that our selected significance level (i.e 0.05), it means that there is sufficent evidence to reject the null hypothesis.</p>
<p>For this hypothesis testing, the hypothesis are as follows:</p>
<ul>
<li><p>Null hypothesis, H0: The spatial distribution of functional and non-functional water points are <em>independent</em> from each other.</p></li>
<li><p>Alternative hypothesis, H1: The spatial distribution of functional and non-functional water points are <em>not independent</em> from each other.</p></li>
<li><p>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</p></li>
<li></li>
</ul>
<p>To start off, I need to retrieve the polygon features of functional and non-functional waterpoints in Nigeria, Osun which i had extracted earlier and combined together into one dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">rbind</span>(wp_functional, wp_nonfunctional)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(wpNGA_funct_nonfunct<span class="sc">$</span>status_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the df of wpNGA_funct_nonfunct, functional waterpoints consist of “Functional” and “Functional, needs repair” and non-functional waterpoints consist of “Abandoned/Decommissioned”. Thus, to make things clearer, I decided to make it so that the df only contains “Functional” or “Non-functional” in the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Functional, needs repair"</span>] <span class="ot">&lt;-</span> <span class="st">"Functional"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Abandoned/Decommissioned"</span>] <span class="ot">&lt;-</span> <span class="st">"Non-functional"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I need to visualise my sf layers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wpNGA_funct_nonfunct</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(NGA_owin) + tm_polygons(wpNGA_funct_nonfunct)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_funct_nonfunct)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tmap_mode("view")</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(wpNGA_funct_nonfunct) +</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_polygons("status_clean")+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_view(set.zoom.limits = c(12, 16))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley’s%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb54" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Assignment 1: Application of Spatial Point Patterns Analysis"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Rhonda Ho Kah Yee"</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "30 january 2023"</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: false</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Overview</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>Hello, this is Rhonda Ho's Take-home Assignment 1 for IS415 module.</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>To view/hide the code, please click on the "<span class="sc">\&lt;</span>/<span class="sc">\&gt;</span> code" tab beside the title and select the option to view/hide the code.</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Objectives</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>Geospatial analytics hold tremendous potential to address complex problems facing society. In this study, I am tasked to apply appropriate spatial point patterns analysis methods to discover the geographical distribution of functional and non-function water points and their co-locations if any in Osun State, Nigeria.</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 The Data</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 Tasks</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>The specific tasks of this take-home exercise are as follows:</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Exploratory Spatial Data Analysis (ESDA)**</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Derive kernel density maps of functional and non-functional water points. Using appropriate tmap functions,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Display the kernel density maps on openstreetmap of Osub State, Nigeria.</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Describe the spatial patterns revealed by the kernel density maps. Highlight the advantage of kernel density map over point map.</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;!-- --&gt;</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Second-order Spatial Point Patterns Analysis**</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>    With reference to the spatial point patterns observed in ESDA:</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Perform the test by using appropriate Second order spatial point patterns analysis technique.</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the analysis results, draw statistical conclusions.</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Spatial Correlation Analysis**</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>    In this section, you are required to confirm statistically if the spatial distribution of functional and non-functional water points are independent from each other.</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulate the null hypothesis and alternative hypothesis and select the confidence level.</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Perform the test by using appropriate Second order spatial point patterns analysis technique.</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>With reference to the analysis results, draw statistical conclusions.</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Getting Started</span></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>For the purpose of this assignment, the following packages will be used:</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sf**</span><span class="co">](https://cran.r-project.org/web/packages/sf/index.html)</span>: used for importing, managing, and processing geospatial data</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tidyverse**</span><span class="co">](https://www.tidyverse.org/)</span>: a collection of packages for data science tasks</span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tmap**</span><span class="co">](https://cran.r-project.org/web/packages/tmap/index.html)</span>: used for creating thematic maps, such as choropleth and bubble maps</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**spatstat**</span><span class="co">](https://spatstat.org/)</span>: used for point pattern analysis</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**raster**</span><span class="co">](https://cran.r-project.org/web/packages/raster/)</span>: reads, writes, manipulates, analyses and models gridded spatial data (i.e.&nbsp;raster-based geographical data)</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**funModeling**</span><span class="co">](https://cran.r-project.org/web/packages/funModeling/index.html)</span>: contains a set of functions related to exploratory data analysis, data preparation, and model performance</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**maptools**</span><span class="co">](https://cran.r-project.org/web/packages/maptools/index.html)</span>: a set of tools for manipulating geographic data and</span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**sfdep**</span><span class="co">](https://cran.r-project.org/web/packages/spdep/index.html)</span>: for performing geospatia data wrangling and local colocation quotient analysis.</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, spatstat, raster, funModeling, maptools, sfdep)</span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Handling of Data</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Importing Geospatial Data</span></span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a>In this section, <span class="co">[</span><span class="ot">st_read()</span><span class="co">](https://r-spatial.github.io/sf/reference/st_read.html)</span> of sf package will be used to import the 2 geospatial data sets into R.</span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.1 The Geoboundaries Dataset</span></span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a>                  <span class="at">layer =</span> <span class="st">"geoBoundaries-NGA-ADM1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a>To understand more about the columns and data across our dataset, I used the function <span class="co">[</span><span class="ot">glimpse()</span><span class="co">]</span>(https://dplyr.tidyverse.org/reference/glimpse.html#:~:text=glimpse()%20is%20like%20a,as%20much%20data%20as%20possible.) as shown in the code chunk below.</span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(geoNGA)</span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1.2 The NGA Dataset</span></span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/geospatial/"</span>,</span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2_osgof_20190417"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb54-129"><a href="#cb54-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(NGA)</span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a>By examining both of the sf dataframes closely, we can observe that the NGA dataset provides us with more information with regards to the state i.e Osun which we require to perform our tasks. Hence, NGA data.frame will be used for the subsequent processing.</span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 Importing Aspatial Data</span></span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a>Moving on to the Aspatial data, as it is in an excel format, I decided to use <span class="co">[</span><span class="ot">read_csv()</span><span class="co">](https://swcarpentry.github.io/r-novice-inflammation/11-supp-read-write-csv/)</span>function. As the area of study for this task is focused on Osun State, Nigeria, I then filtered out the values accordingly using the <span class="co">[</span><span class="ot">filter()</span><span class="co">](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter)</span> function. But how do we know which column to filter by? First, I read up on the description of the metadata in the Aspatial data <span class="co">[</span><span class="ot">here</span><span class="co">](https://data.waterpointdata.org/dataset/Water-Point-Data-Exchange-Plus-WPdx-/eqje-vguj)</span> and discovered that I needed to filter out the country, Nigeria under the <span class="sc">\`</span>clean_country_name<span class="sc">\`</span>.</span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_country_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nigeria"</span>))</span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a>Next, I took a closer look at the data and discovered that the states of Nigeria are splitted in to 4 divisions. To determine where Osun is, I used the function, any() to check which column Osun belonged to.</span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm1<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm2<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm3<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(wp_nga<span class="sc">$</span>clean_adm4<span class="sc">==</span><span class="st">"Osun"</span>)</span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a>Based on the output above, Osun only exists under the column 'clean_adm1', so I filtered out the Osun state in that specific column.</span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/wpdx.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_adm1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a>Next, we need to convert the aspatial data into sf data.frame.</span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a>To do so, it requires two steps. First, we need to convert the <span class="co">[</span><span class="ot">wkt</span><span class="co">](https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry)</span> field into sfc field by using <span class="in">`st_as_sfc()`</span> data type.</span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a>wp_nga<span class="sc">$</span>Geometry <span class="ot">=</span> <span class="fu">st_as_sfc</span>(wp_nga<span class="sc">$</span><span class="st">`</span><span class="at">new_georeferenced_column_</span><span class="st">`</span>)</span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a>wp_nga</span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>Next, we will convert the tibble data.frame into an sf object by using <span class="co">[</span><span class="ot">st_sf()</span><span class="co">](https://r-spatial.github.io/sf/reference/sf.html)</span>. It is also important for us to include the referencing system of the data into the sf object.</span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(wp_nga, <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a>wp_sf</span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a>Afterwards, we need to transform the projection from wgs84 to appropriate projected coordinate system of Nigeria i.e 26392.</span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span></span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26392</span>)</span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4 Geospatial Data Cleaning</span></span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a>Data cleaning is the process of fixing or removing incorrect, corrupted, incorrectly formatted, duplicate, or incomplete data within a dataset. This is important to improve the data quality which will allow us to analyse and infer better quality information.</span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Exclude redundant fields</span></span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-207"><a href="#cb54-207" aria-hidden="true" tabindex="-1"></a>NGA sf data.frame consists of many redundent fields. Thus, I used <span class="co">[</span><span class="ot">select()</span><span class="co">](https://sparkbyexamples.com/r-programming/r-select-function-from-dplyr/)</span> of dplyr to retain the relevant columns which contain the values under the state of Osun.</span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: using select function</span></span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>NGA <span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr:: is used as there may be library conflicts which prevents me from using the code</span></span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: keeping the column by name</span></span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a><span class="co">#keeps &lt;- c("ADM2_EN","ADM2_PCODE","ADM1_EN","ADM1_PCODE")</span></span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA = NGA[keeps]</span></span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a>Afterwards, I filtered the column 'ADM1_EN' to only include Osun Values.</span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a>NGA<span class="ot">&lt;-</span> NGA <span class="sc">%&gt;%</span></span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Osun"</span>))</span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Check for duplicate names</span></span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a>For the code chunk below, the function <span class="co">[</span><span class="ot">duplicate()</span><span class="co">](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/duplicated)</span> is used to check for any duplicated values.</span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a>NGA<span class="sc">$</span>ADM2_EN[<span class="fu">duplicated</span>(NGA<span class="sc">$</span>ADM2_EN)<span class="sc">==</span><span class="cn">TRUE</span>]</span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a>Hence, based on the output above, there is no duplicated values.</span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. Data Wrangling for Water Point Data</span></span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>In this section, I would like to perform data wrangling to improve the data usability as it transforms raw data into more readily used formats.</span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a>First off, I discovered that the column 'status_clean' shows the type of waterpoints in Nigeria, Osun. To display the frequencies and have a closer look at the unique values of the type ofwaterpoints, I used the function <span class="co">[</span><span class="ot">freq()</span><span class="co">](https://rdrr.io/cran/summarytools/man/freq.html#:~:text=format_number%3A%20format_number-,freq%3A%20Frequency%20Tables%20for%20Factors%20and%20Other%20Discrete%20Data,From%20Arguments%20Passed%20to%20Functions)</span> .</span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a>funModeling<span class="sc">::</span><span class="fu">freq</span>(<span class="at">data =</span> wp_sf,</span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_clean'</span>)</span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(wp_sf$status_clean)</span></span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a>As you can see from the output above, there are 4 classes in the 'status_clean' field.</span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a>Next, we select 'status_clean' and the <span class="co">[</span><span class="ot">replace_na()</span><span class="co">](https://tidyr.tidyverse.org/reference/replace_na.html)</span> function to replace NA values into 'Unknown'.</span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a>wp_sf_nga <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span> </span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(status_clean) <span class="sc">%&gt;%</span></span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_clean =</span> <span class="fu">replace_na</span>(</span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a>    status_clean, <span class="st">"Unknown"</span>))</span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a>Now, we can start to extract the water data points base on its status which is functional, non-functional and unknown using the <span class="co">[</span><span class="ot">filter()</span><span class="co">](https://dplyr.tidyverse.org/reference/filter.html)</span> function.</span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional, needs repair"</span>))</span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>))</span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>wp_unknown <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.1 Converting sf data frames to sp's Spatial\* class</span></span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-293"><a href="#cb54-293" aria-hidden="true" tabindex="-1"></a>Next, since the task requires us to perform exploratory spatial data analysis (ESDA), we need to convert simple feature data frame to sp's Spatial<span class="sc">\*</span> class using the <span class="co">[</span><span class="ot">as_Spatial()</span><span class="co">](https://www.google.com/search?q=as_Spatial%28%29++in+r&amp;ei=5uroY5m5IoiA3LUP5ISEkAQ&amp;ved=0ahUKEwiZxLLSjJD9AhUIALcAHWQCAUIQ4dUDCA8&amp;uact=5&amp;oq=as_Spatial%28%29++in+r&amp;gs_lcp=Cgxnd3Mtd2l6LXNlcnAQAzIJCAAQHhANEPEEMgYIABAWEB4yCAgAEBYQHhAPOgcIABAeEPEEOgYIABAeEA86CQgAEB4QDxDxBDoJCAAQFhAeEPEEOgsIABAWEB4QDxDxBEoECEEYAEoECEYYAFAAWNYFYOgGaABwAXgAgAFIiAH9ApIBATaYAQCgAQKgAQHAAQE&amp;sclient=gws-wiz-serp)</span> function.</span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a><span class="co">#overview of wp in Ossun state</span></span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a>wp_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_sf)</span>
<span id="cb54-300"><a href="#cb54-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-301"><a href="#cb54-301" aria-hidden="true" tabindex="-1"></a><span class="co">#only functional wp in Ossun state</span></span>
<span id="cb54-302"><a href="#cb54-302" aria-hidden="true" tabindex="-1"></a>wp_func_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_functional)</span>
<span id="cb54-303"><a href="#cb54-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-304"><a href="#cb54-304" aria-hidden="true" tabindex="-1"></a><span class="co">#only non-functional wp in Ossun state</span></span>
<span id="cb54-305"><a href="#cb54-305" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(wp_nonfunctional)</span>
<span id="cb54-306"><a href="#cb54-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-307"><a href="#cb54-307" aria-hidden="true" tabindex="-1"></a><span class="co">#NGA dataset</span></span>
<span id="cb54-308"><a href="#cb54-308" aria-hidden="true" tabindex="-1"></a>NGA_spatial <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(NGA)</span>
<span id="cb54-309"><a href="#cb54-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-310"><a href="#cb54-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-311"><a href="#cb54-311" aria-hidden="true" tabindex="-1"></a>To further understand our data, we run the code chunk below.</span>
<span id="cb54-312"><a href="#cb54-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-315"><a href="#cb54-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-316"><a href="#cb54-316" aria-hidden="true" tabindex="-1"></a>wp_spatial</span>
<span id="cb54-317"><a href="#cb54-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-318"><a href="#cb54-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-321"><a href="#cb54-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-322"><a href="#cb54-322" aria-hidden="true" tabindex="-1"></a>NGA_spatial</span>
<span id="cb54-323"><a href="#cb54-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-324"><a href="#cb54-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-325"><a href="#cb54-325" aria-hidden="true" tabindex="-1"></a>Looking at the output above, we understand that wp_spatial belongs to the SpatialPointsDataFrame while NGA_spatial belongs to SpatialPolygonsDataFrame class. This will help us in the next section which is the conversion of Spatial<span class="sc">\*</span> class into generic sp format.</span>
<span id="cb54-326"><a href="#cb54-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-327"><a href="#cb54-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.2 Converting the Spatial\* class into generic sp format</span></span>
<span id="cb54-328"><a href="#cb54-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-329"><a href="#cb54-329" aria-hidden="true" tabindex="-1"></a>As spatstat requires the analytical data in ppp object form. We need to convert the Spatial classes<span class="sc">\*</span> into Spatial object first. The codes chunk below converts the Spatial<span class="sc">\*</span> classes into generic sp objects.</span>
<span id="cb54-330"><a href="#cb54-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-333"><a href="#cb54-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-334"><a href="#cb54-334" aria-hidden="true" tabindex="-1"></a>wp_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb54-335"><a href="#cb54-335" aria-hidden="true" tabindex="-1"></a>wp_func_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb54-336"><a href="#cb54-336" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_spatial, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb54-337"><a href="#cb54-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-338"><a href="#cb54-338" aria-hidden="true" tabindex="-1"></a>NGA_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_spatial, <span class="st">"SpatialPolygons"</span>)</span>
<span id="cb54-339"><a href="#cb54-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-340"><a href="#cb54-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-341"><a href="#cb54-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.3 Converting the generic sp format into spatstat's ppp format</span></span>
<span id="cb54-342"><a href="#cb54-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-343"><a href="#cb54-343" aria-hidden="true" tabindex="-1"></a>Now, we will use <span class="co">[</span><span class="ot">as.ppp()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/as.ppp)</span> function of spatstat to convert the spatial data into spatstat's ppp object format.</span>
<span id="cb54-344"><a href="#cb54-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-347"><a href="#cb54-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-348"><a href="#cb54-348" aria-hidden="true" tabindex="-1"></a>wp_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_sp, <span class="st">"ppp"</span>)</span>
<span id="cb54-349"><a href="#cb54-349" aria-hidden="true" tabindex="-1"></a>wp_ppp</span>
<span id="cb54-350"><a href="#cb54-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-351"><a href="#cb54-351" aria-hidden="true" tabindex="-1"></a>wp_func_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_func_sp, <span class="st">"ppp"</span>)</span>
<span id="cb54-352"><a href="#cb54-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-353"><a href="#cb54-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-354"><a href="#cb54-354" aria-hidden="true" tabindex="-1"></a>wp_nonfunc_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunc_sp, <span class="st">"ppp"</span>)</span>
<span id="cb54-355"><a href="#cb54-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-356"><a href="#cb54-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-357"><a href="#cb54-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-358"><a href="#cb54-358" aria-hidden="true" tabindex="-1"></a>To further understand our data, let's look at its summary statistics.</span>
<span id="cb54-359"><a href="#cb54-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-362"><a href="#cb54-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-363"><a href="#cb54-363" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wp_ppp)</span>
<span id="cb54-364"><a href="#cb54-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-365"><a href="#cb54-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-366"><a href="#cb54-366" aria-hidden="true" tabindex="-1"></a>Based on the output above, fortunately, we do not see a warning messages about duplicates. The code chunk below shows an alternate method of checking for duplicates. If it return FALSE, that means there is no duplicated values.</span>
<span id="cb54-367"><a href="#cb54-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-370"><a href="#cb54-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-371"><a href="#cb54-371" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_ppp))</span>
<span id="cb54-372"><a href="#cb54-372" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_func_ppp))</span>
<span id="cb54-373"><a href="#cb54-373" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(wp_nonfunc_ppp))</span>
<span id="cb54-374"><a href="#cb54-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-375"><a href="#cb54-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-376"><a href="#cb54-376" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.4 Creating owin object</span></span>
<span id="cb54-377"><a href="#cb54-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-378"><a href="#cb54-378" aria-hidden="true" tabindex="-1"></a>When analysing spatial point patterns, it is a good practice to confine the analysis with a geographical area, for example, Nigeria's boundary. In spatstat, an object called owin is specially designed to represent this polygonal region.</span>
<span id="cb54-379"><a href="#cb54-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-380"><a href="#cb54-380" aria-hidden="true" tabindex="-1"></a>The code chunk below is used to convert Nigera, Ossun stats SpatialPolygon object into owin object of spatstat.</span>
<span id="cb54-381"><a href="#cb54-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-384"><a href="#cb54-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-385"><a href="#cb54-385" aria-hidden="true" tabindex="-1"></a>NGA_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(NGA_sp, <span class="st">"owin"</span>)</span>
<span id="cb54-386"><a href="#cb54-386" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(NGA_owin)</span>
<span id="cb54-387"><a href="#cb54-387" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NGA_owin)</span>
<span id="cb54-388"><a href="#cb54-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-389"><a href="#cb54-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-390"><a href="#cb54-390" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.5 Combining point events object and owin object</span></span>
<span id="cb54-391"><a href="#cb54-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-392"><a href="#cb54-392" aria-hidden="true" tabindex="-1"></a>In this last step of geospatial data wrangling, we will extract *all waterpoints* that are located within Nigeria Ossun by using the code chunk below.</span>
<span id="cb54-393"><a href="#cb54-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-396"><a href="#cb54-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-397"><a href="#cb54-397" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp <span class="ot">=</span> wp_ppp[NGA_owin]</span>
<span id="cb54-398"><a href="#cb54-398" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpNGA_ppp)</span>
<span id="cb54-399"><a href="#cb54-399" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_ppp)</span>
<span id="cb54-400"><a href="#cb54-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-401"><a href="#cb54-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-402"><a href="#cb54-402" aria-hidden="true" tabindex="-1"></a>The code chunk below extract *functional waterpoints* that are located within Nigeria, Ossun.</span>
<span id="cb54-403"><a href="#cb54-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-406"><a href="#cb54-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-407"><a href="#cb54-407" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp <span class="ot">=</span> wp_func_ppp[NGA_owin]</span>
<span id="cb54-408"><a href="#cb54-408" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpfuncNGA_ppp)</span>
<span id="cb54-409"><a href="#cb54-409" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpfuncNGA_ppp)</span>
<span id="cb54-410"><a href="#cb54-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-411"><a href="#cb54-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-412"><a href="#cb54-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-413"><a href="#cb54-413" aria-hidden="true" tabindex="-1"></a>The code chunk below extract *non-functional waterpoints* that are located within Nigeria, Ossun.</span>
<span id="cb54-414"><a href="#cb54-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-417"><a href="#cb54-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-418"><a href="#cb54-418" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp <span class="ot">=</span> wp_nonfunc_ppp[NGA_owin]</span>
<span id="cb54-419"><a href="#cb54-419" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wpnonfuncNGA_ppp)</span>
<span id="cb54-420"><a href="#cb54-420" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpnonfuncNGA_ppp)</span>
<span id="cb54-421"><a href="#cb54-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-422"><a href="#cb54-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-423"><a href="#cb54-423" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6. First-order Spatial Point Patterns Analysis</span></span>
<span id="cb54-424"><a href="#cb54-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-425"><a href="#cb54-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.1 Kernel Density Estimation</span></span>
<span id="cb54-426"><a href="#cb54-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-427"><a href="#cb54-427" aria-hidden="true" tabindex="-1"></a>In this section, I will be computing the kernel density estimation (KDE) of waterpoints in Singapore.</span>
<span id="cb54-428"><a href="#cb54-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-429"><a href="#cb54-429" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.1 Automatic bandwidth selection methods</span></span>
<span id="cb54-430"><a href="#cb54-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-431"><a href="#cb54-431" aria-hidden="true" tabindex="-1"></a>The code chunk below computes a kernel density by using the following configurations of <span class="co">[</span><span class="ot">density()</span><span class="co">](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density)</span> of spatstat:</span>
<span id="cb54-432"><a href="#cb54-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-433"><a href="#cb54-433" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>bw.diggle() automatic bandwidth selection method. Other recommended methods are *bw.CvL(), bw.scott() or bw.ppl().*</span>
<span id="cb54-434"><a href="#cb54-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-435"><a href="#cb54-435" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The smoothing kernel used is gaussian, which is the default. Other smoothing methods are: "epanechnikov", "quartic" or "disc".</span>
<span id="cb54-436"><a href="#cb54-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-437"><a href="#cb54-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The intensity estimate is corrected for edge effect bias by using method described by Jones (1993) and Diggle (2010, equation 18.9). The default is FALSE.</span>
<span id="cb54-438"><a href="#cb54-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-441"><a href="#cb54-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-442"><a href="#cb54-442" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp,</span>
<span id="cb54-443"><a href="#cb54-443" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb54-444"><a href="#cb54-444" aria-hidden="true" tabindex="-1"></a>                              <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb54-445"><a href="#cb54-445" aria-hidden="true" tabindex="-1"></a>                            <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-446"><a href="#cb54-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-447"><a href="#cb54-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-448"><a href="#cb54-448" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA_bw, <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (m^2)"</span>)</span>
<span id="cb54-449"><a href="#cb54-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-450"><a href="#cb54-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-451"><a href="#cb54-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-452"><a href="#cb54-452" aria-hidden="true" tabindex="-1"></a>As we can observe from the above, the density values of the output range from 0 to 0.00000004 which is way too small to comprehend. This is because the default unit of measurement of WGS 84 is in meter. As a result, the density values computed is in "number of points per square meter". Thus, for a better visualisation, we need to rescale the KDE values.</span>
<span id="cb54-453"><a href="#cb54-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-454"><a href="#cb54-454" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.2 Rescalling KDE values</span></span>
<span id="cb54-455"><a href="#cb54-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-456"><a href="#cb54-456" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="co">[</span><span class="ot">rescale()</span><span class="co">](https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/rescale)</span> is used to covert the unit of measurement from meter to kilometer.</span>
<span id="cb54-457"><a href="#cb54-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-460"><a href="#cb54-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-461"><a href="#cb54-461" aria-hidden="true" tabindex="-1"></a>wpNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb54-462"><a href="#cb54-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-463"><a href="#cb54-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-464"><a href="#cb54-464" aria-hidden="true" tabindex="-1"></a>Now, we can re-run density() using the resale data set and plot the output kde map.</span>
<span id="cb54-465"><a href="#cb54-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-468"><a href="#cb54-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-469"><a href="#cb54-469" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-470"><a href="#cb54-470" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, </span>
<span id="cb54-471"><a href="#cb54-471" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"KDE of Waterpoints in Nigeria, Ossun using bw.diggle (km^2)"</span>)</span>
<span id="cb54-472"><a href="#cb54-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-473"><a href="#cb54-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-474"><a href="#cb54-474" aria-hidden="true" tabindex="-1"></a>According to Baddeley et. (2016), they suggested the use of the bw.ppl() algorithm because in ther experience it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters. But they also insist that if the purpose of once study is to detect a single tight cluster in the midst of random noise then the bw.diggle() method seems to work best.</span>
<span id="cb54-475"><a href="#cb54-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-476"><a href="#cb54-476" aria-hidden="true" tabindex="-1"></a>Hence, I decided to look at the output for both.</span>
<span id="cb54-477"><a href="#cb54-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-480"><a href="#cb54-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-481"><a href="#cb54-481" aria-hidden="true" tabindex="-1"></a>kde_wpNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpNGA_ppp.km, </span>
<span id="cb54-482"><a href="#cb54-482" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb54-483"><a href="#cb54-483" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb54-484"><a href="#cb54-484" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-485"><a href="#cb54-485" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb54-486"><a href="#cb54-486" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.bw, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb54-487"><a href="#cb54-487" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpNGA.ppl, <span class="at">main =</span> <span class="st">"KDE of All Waterpoints, bw.ppl"</span>)</span>
<span id="cb54-488"><a href="#cb54-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-489"><a href="#cb54-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-490"><a href="#cb54-490" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.3 KDE for Functional and Non-functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb54-491"><a href="#cb54-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-492"><a href="#cb54-492" aria-hidden="true" tabindex="-1"></a>Next, I performed the same actions as above the code chunk to derive the KDE for functional and non functional waterpoints respectively.</span>
<span id="cb54-493"><a href="#cb54-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-494"><a href="#cb54-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **6.1.3.1 KDE for Functional Waterpoints in Nigeria, Osun**</span></span>
<span id="cb54-495"><a href="#cb54-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-498"><a href="#cb54-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-499"><a href="#cb54-499" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb54-500"><a href="#cb54-500" aria-hidden="true" tabindex="-1"></a>wpfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb54-501"><a href="#cb54-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-502"><a href="#cb54-502" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb54-503"><a href="#cb54-503" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-504"><a href="#cb54-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-505"><a href="#cb54-505" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb54-506"><a href="#cb54-506" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-507"><a href="#cb54-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-508"><a href="#cb54-508" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb54-509"><a href="#cb54-509" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb54-510"><a href="#cb54-510" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Functional Waterpoints (km^2), bw.ppl"</span>)</span>
<span id="cb54-511"><a href="#cb54-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-512"><a href="#cb54-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-513"><a href="#cb54-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-514"><a href="#cb54-514" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **6.1.3.2 KDE for Non-functional Waterpoints in Nigeria, Osun**</span></span>
<span id="cb54-515"><a href="#cb54-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-518"><a href="#cb54-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-519"><a href="#cb54-519" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale</span></span>
<span id="cb54-520"><a href="#cb54-520" aria-hidden="true" tabindex="-1"></a>wpnonfuncNGA_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wpnonfuncNGA_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb54-521"><a href="#cb54-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-522"><a href="#cb54-522" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - diggle</span></span>
<span id="cb54-523"><a href="#cb54-523" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-524"><a href="#cb54-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-525"><a href="#cb54-525" aria-hidden="true" tabindex="-1"></a><span class="co">#kde with bandwith - ppl</span></span>
<span id="cb54-526"><a href="#cb54-526" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA.ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(wpnonfuncNGA_ppp.km, <span class="at">sigma=</span>bw.ppl, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb54-527"><a href="#cb54-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-528"><a href="#cb54-528" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb54-529"><a href="#cb54-529" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.bw, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.diggle"</span>)</span>
<span id="cb54-530"><a href="#cb54-530" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfuncNGA.ppl, <span class="at">main=</span><span class="st">"KDE of Non-functional Waterpoints (km^2), bw.ppl"</span>)</span>
<span id="cb54-531"><a href="#cb54-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-532"><a href="#cb54-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-533"><a href="#cb54-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.2 Converting KDE output into grid object</span></span>
<span id="cb54-534"><a href="#cb54-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-535"><a href="#cb54-535" aria-hidden="true" tabindex="-1"></a>Next, for mapping purposes, I need to convert the KDE output into a grid object.</span>
<span id="cb54-536"><a href="#cb54-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-539"><a href="#cb54-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-540"><a href="#cb54-540" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpNGA.bw)</span>
<span id="cb54-541"><a href="#cb54-541" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of All Waterpoints, bw.diggle"</span>)</span>
<span id="cb54-542"><a href="#cb54-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-543"><a href="#cb54-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-544"><a href="#cb54-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-545"><a href="#cb54-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.1 Converting gridded output into raster</span></span>
<span id="cb54-546"><a href="#cb54-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-547"><a href="#cb54-547" aria-hidden="true" tabindex="-1"></a>Next, we will convert the gridded kernal density objects into RasterLayer object by using raster() of raster package.</span>
<span id="cb54-548"><a href="#cb54-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-551"><a href="#cb54-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-552"><a href="#cb54-552" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpNGA_bw)</span>
<span id="cb54-553"><a href="#cb54-553" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span>
<span id="cb54-554"><a href="#cb54-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-555"><a href="#cb54-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-556"><a href="#cb54-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-557"><a href="#cb54-557" aria-hidden="true" tabindex="-1"></a>Based on the output, the crs property is NA. Hence, we need to assign it.</span>
<span id="cb54-558"><a href="#cb54-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-559"><a href="#cb54-559" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.2 Assigning projection systems</span></span>
<span id="cb54-560"><a href="#cb54-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-563"><a href="#cb54-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-564"><a href="#cb54-564" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb54-565"><a href="#cb54-565" aria-hidden="true" tabindex="-1"></a>kde_wpNGA_bw_raster</span>
<span id="cb54-566"><a href="#cb54-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-567"><a href="#cb54-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-568"><a href="#cb54-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-569"><a href="#cb54-569" aria-hidden="true" tabindex="-1"></a>Based on the output above, the CRS information has been sucessfully added in.</span>
<span id="cb54-570"><a href="#cb54-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-571"><a href="#cb54-571" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.3 Visualising the output in tmap</span></span>
<span id="cb54-572"><a href="#cb54-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-573"><a href="#cb54-573" aria-hidden="true" tabindex="-1"></a>Finally, we will display the raster in cartographic quality map using tmap package.</span>
<span id="cb54-574"><a href="#cb54-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-575"><a href="#cb54-575" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.1 Raster of KDE All Waterpoints in Nigeria, Osun</span></span>
<span id="cb54-576"><a href="#cb54-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-579"><a href="#cb54-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-580"><a href="#cb54-580" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb54-581"><a href="#cb54-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb54-582"><a href="#cb54-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb54-583"><a href="#cb54-583" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb54-584"><a href="#cb54-584" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-585"><a href="#cb54-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-586"><a href="#cb54-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-587"><a href="#cb54-587" aria-hidden="true" tabindex="-1"></a>Based on the KDE graphs, most of the waterpoints are clustered around the top middle section. Upon further research on the <span class="co">[</span><span class="ot">cities in Nigeria</span><span class="co">](https://www.google.com/maps/place/Osun,+Nigeria/data=!4m2!3m1!1s0x10381b1492f19919:0x4444a9d7e31afcd3?sa=X&amp;ved=2ahUKEwiFpO3Fyo_9AhVZTWwGHSTkBBIQ8gF6BAh-EAE)</span>, State of Osun, I discovered that most of waterpoints are clustered around the city called Osogbo where the Osun river resides.</span>
<span id="cb54-588"><a href="#cb54-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-589"><a href="#cb54-589" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.2 Raster of KDE Functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb54-590"><a href="#cb54-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-591"><a href="#cb54-591" aria-hidden="true" tabindex="-1"></a>To display raster of KDE of functional waterpoints in Nigeria, Osun, simply repeat the steps in section 6.</span>
<span id="cb54-592"><a href="#cb54-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-595"><a href="#cb54-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-596"><a href="#cb54-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the same steps in section 6.2</span></span>
<span id="cb54-597"><a href="#cb54-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-598"><a href="#cb54-598" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb54-599"><a href="#cb54-599" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpfuncNGA.bw)</span>
<span id="cb54-600"><a href="#cb54-600" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb54-601"><a href="#cb54-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-602"><a href="#cb54-602" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb54-603"><a href="#cb54-603" aria-hidden="true" tabindex="-1"></a>kde_wpfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpfuncNGA_bw)</span>
<span id="cb54-604"><a href="#cb54-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-605"><a href="#cb54-605" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb54-606"><a href="#cb54-606" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb54-607"><a href="#cb54-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-608"><a href="#cb54-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-609"><a href="#cb54-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-610"><a href="#cb54-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-613"><a href="#cb54-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-614"><a href="#cb54-614" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb54-615"><a href="#cb54-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb54-616"><a href="#cb54-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Functional Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb54-617"><a href="#cb54-617" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.8</span>,</span>
<span id="cb54-618"><a href="#cb54-618" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-619"><a href="#cb54-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-620"><a href="#cb54-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-621"><a href="#cb54-621" aria-hidden="true" tabindex="-1"></a>Looking at the KDE graph for functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the functional waterpoints are mainly clustered in 6 areas. Roughly gauging based on the <span class="co">[</span><span class="ot">cities</span><span class="co">](https://www.google.com/maps/place/Osun,+Nigeria/@7.500196,4.6687999,9.46z/data=!4m6!3m5!1s0x10381b1492f19919:0x4444a9d7e31afcd3!8m2!3d7.5628964!4d4.5199593!16zL20vMDZ4anFk)</span> in Nigeria, Ossun, the most densely populated area of functional waterpoints area is found in the city of Osogbo, followed by Ikirun/Ota, Isero/Ikonifin and Okeigbo. The less densely populated area of functional waterpoints but we are still able to see a cluster are around the city of Ife and Ikire.</span>
<span id="cb54-622"><a href="#cb54-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-623"><a href="#cb54-623" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.3 Raster of KDE Non-functional Waterpoints in Nigeria, Osun</span></span>
<span id="cb54-624"><a href="#cb54-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-627"><a href="#cb54-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-628"><a href="#cb54-628" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to grid</span></span>
<span id="cb54-629"><a href="#cb54-629" aria-hidden="true" tabindex="-1"></a>gridded_kde_wpnonfuncNGA_bw <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpnonfuncNGA.bw)</span>
<span id="cb54-630"><a href="#cb54-630" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_kde_wpnonfuncNGA_bw, <span class="at">main =</span> <span class="st">"Gridded KDE of Non-functional Waterpoints, bw.diggle"</span>)</span>
<span id="cb54-631"><a href="#cb54-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-632"><a href="#cb54-632" aria-hidden="true" tabindex="-1"></a><span class="co">#create raster</span></span>
<span id="cb54-633"><a href="#cb54-633" aria-hidden="true" tabindex="-1"></a>kde_wpnonfuncNGA_bw_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_kde_wpnonfuncNGA_bw)</span>
<span id="cb54-634"><a href="#cb54-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-635"><a href="#cb54-635" aria-hidden="true" tabindex="-1"></a><span class="co">#assign CRS info</span></span>
<span id="cb54-636"><a href="#cb54-636" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpnonfuncNGA_bw_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26392"</span>)</span>
<span id="cb54-637"><a href="#cb54-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-638"><a href="#cb54-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-639"><a href="#cb54-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-640"><a href="#cb54-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-643"><a href="#cb54-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-644"><a href="#cb54-644" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpnonfuncNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb54-645"><a href="#cb54-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb54-646"><a href="#cb54-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Non-functional Waterpoints in Nigeria, Osun"</span>,</span>
<span id="cb54-647"><a href="#cb54-647" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="fl">0.7</span>,</span>
<span id="cb54-648"><a href="#cb54-648" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-649"><a href="#cb54-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-650"><a href="#cb54-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-651"><a href="#cb54-651" aria-hidden="true" tabindex="-1"></a>Looking at the KDE graph for non-functional waterpoints in Nigeria, Osun using bw.diggle, we can observe that the non-functional waterpoints are roughly clustered in 9 areas. As compared to the functional waterpoints clusters, there are a larger number of non-functional waterpoints clusters but each cluster are much smaller. It also seems that the most densely populated non-functional waterpoints area is quite near, on the right of, the city of Osogbo, where most of the functional waterpoints are.</span>
<span id="cb54-652"><a href="#cb54-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-653"><a href="#cb54-653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 6.2.3.4 Raster of KDE All Waterpoints in Nigeria, Osun (Openstreetmap)</span></span>
<span id="cb54-654"><a href="#cb54-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-657"><a href="#cb54-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-658"><a href="#cb54-658" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb54-659"><a href="#cb54-659" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb54-660"><a href="#cb54-660" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpNGA_bw_raster) <span class="sc">+</span> </span>
<span id="cb54-661"><a href="#cb54-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>) <span class="sc">+</span></span>
<span id="cb54-662"><a href="#cb54-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title=</span><span class="st">"Raster of KDE Waterpoints in Nigeria, Osun"</span>, </span>
<span id="cb54-663"><a href="#cb54-663" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>,</span>
<span id="cb54-664"><a href="#cb54-664" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>), <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb54-665"><a href="#cb54-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits=</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">29</span>)) </span>
<span id="cb54-666"><a href="#cb54-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-667"><a href="#cb54-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-668"><a href="#cb54-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-671"><a href="#cb54-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-672"><a href="#cb54-672" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb54-673"><a href="#cb54-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-674"><a href="#cb54-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-675"><a href="#cb54-675" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.4 Advantage of Kernel Density map over Point map</span></span>
<span id="cb54-676"><a href="#cb54-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-677"><a href="#cb54-677" aria-hidden="true" tabindex="-1"></a>KDE map takes into account the location of features relative to each other while for a point map, it shows the quantity specified by the population field that falls within the identified neighborhood and divide that quantity by the area of the neighborhood.</span>
<span id="cb54-678"><a href="#cb54-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-679"><a href="#cb54-679" aria-hidden="true" tabindex="-1"></a>The disadvantages of a point map includes:</span>
<span id="cb54-680"><a href="#cb54-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-681"><a href="#cb54-681" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overcrowding of points, when the scale is small, which makes it harder for the user to analyse the map</span>
<span id="cb54-682"><a href="#cb54-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-683"><a href="#cb54-683" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Subjected to distortion of shape, distance, direction, scale, and area</span>
<span id="cb54-684"><a href="#cb54-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-685"><a href="#cb54-685" aria-hidden="true" tabindex="-1"></a>Thus, KDE map would be a more accurate representation.</span>
<span id="cb54-686"><a href="#cb54-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-687"><a href="#cb54-687" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Second-order Spatial Point Patterns Analysis</span></span>
<span id="cb54-688"><a href="#cb54-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-689"><a href="#cb54-689" aria-hidden="true" tabindex="-1"></a>For this section, I intend to analyse the spatial point processes using L-Function by using <span class="co">[</span><span class="ot">Lest()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/Lest)</span> of spatstat package and testing if it is significantly different from a complete spatial randomness process. Two hypothesis test will be conducted for functional and non-functional waterpoints in Nigeria, Osun respectively.</span>
<span id="cb54-690"><a href="#cb54-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-691"><a href="#cb54-691" aria-hidden="true" tabindex="-1"></a>**What is [L-function](https://rdrr.io/cran/spatstat.core/man/Lest.html)?**</span>
<span id="cb54-692"><a href="#cb54-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-693"><a href="#cb54-693" aria-hidden="true" tabindex="-1"></a>A brief description of the L-function is that it is a variance-normalized version of the <span class="co">[</span><span class="ot">Ripley's K statistic</span><span class="co">]</span>(https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley's%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.) where it is used to determine whether points have a random, dispersed or clustered distribution pattern at certain scale. Thus, this allows us to compare a given point distribution with a random distribution that is the point distribution under investigation is tested against the null hypothesis that the points are distributed randomly and independently.</span>
<span id="cb54-694"><a href="#cb54-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-695"><a href="#cb54-695" aria-hidden="true" tabindex="-1"></a>**What is a [Complete spatial randomness (CSR)](https://link.springer.com/article/10.1007/s10182-021-00434-4#:~:text=Complete%20spatial%20randomness%20(CSR)%20describes,is%20to%20test%20for%20CSR.)?**</span>
<span id="cb54-696"><a href="#cb54-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-697"><a href="#cb54-697" aria-hidden="true" tabindex="-1"></a>It refers to a point process whereby point events occur within a given study area in a completely random fashion. It is synonymous with a homogeneous spatial Poisson process. If the hypothesis is not rejected, one can assume that the given point pattern is random, and we refer to it as a homogeneous Poisson point pattern.</span>
<span id="cb54-698"><a href="#cb54-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-699"><a href="#cb54-699" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.1 Functional Waterpoints in Nigeria, Ossun</span></span>
<span id="cb54-700"><a href="#cb54-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-701"><a href="#cb54-701" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.1 Hypothesis Test</span></span>
<span id="cb54-702"><a href="#cb54-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-703"><a href="#cb54-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The distribution of *functional waterpoints* in Nigeria, Osun is *randomly distributed.*</span>
<span id="cb54-704"><a href="#cb54-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-705"><a href="#cb54-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The distribution of *functional waterpoints* in Nigeria, Osun is *not randomly distributed.*</span>
<span id="cb54-706"><a href="#cb54-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-707"><a href="#cb54-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb54-708"><a href="#cb54-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-709"><a href="#cb54-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.2 Computing L Function estimation</span></span>
<span id="cb54-710"><a href="#cb54-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-713"><a href="#cb54-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-714"><a href="#cb54-714" aria-hidden="true" tabindex="-1"></a>L_func <span class="ot">=</span> <span class="fu">Lest</span>(wpfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb54-715"><a href="#cb54-715" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb54-716"><a href="#cb54-716" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span>
<span id="cb54-717"><a href="#cb54-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-718"><a href="#cb54-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-719"><a href="#cb54-719" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.3 Performing Complete Spatial Randomness Test</span></span>
<span id="cb54-720"><a href="#cb54-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-721"><a href="#cb54-721" aria-hidden="true" tabindex="-1"></a>Next, we perform the function <span class="co">[</span><span class="ot">envelope()</span><span class="co">](https://www.rdocumentation.org/packages/spatstat/versions/1.64-1/topics/envelope)</span> to compute simulation envelopes of the summary function i.e L function. The following arguments are used:</span>
<span id="cb54-722"><a href="#cb54-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-723"><a href="#cb54-723" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>nsim : Number of simulated point patterns to be generated when computing the envelopes.</span>
<span id="cb54-724"><a href="#cb54-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-725"><a href="#cb54-725" aria-hidden="true" tabindex="-1"></a>    As we have chosen the significance level to be 0.05, following this formula from the documentation, significance level alpha = 2 <span class="sc">\*</span> nrank / (1 + nsim), nsim would be 39.</span>
<span id="cb54-726"><a href="#cb54-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-727"><a href="#cb54-727" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>rank: Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.</span>
<span id="cb54-728"><a href="#cb54-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-729"><a href="#cb54-729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Logical flag indicating whether envelopes should be pointwise (global=FALSE) or simultaneous (global=TRUE).</span>
<span id="cb54-730"><a href="#cb54-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-733"><a href="#cb54-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-734"><a href="#cb54-734" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb54-735"><a href="#cb54-735" aria-hidden="true" tabindex="-1"></a>L_func.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-736"><a href="#cb54-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-737"><a href="#cb54-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-740"><a href="#cb54-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-741"><a href="#cb54-741" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_func.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span>
<span id="cb54-742"><a href="#cb54-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-743"><a href="#cb54-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-744"><a href="#cb54-744" aria-hidden="true" tabindex="-1"></a>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence that the distribution of functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</span>
<span id="cb54-745"><a href="#cb54-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-746"><a href="#cb54-746" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.2 Non-functional Waterpoints in Nigeria, Ossun</span></span>
<span id="cb54-747"><a href="#cb54-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-748"><a href="#cb54-748" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2.1 Hypothesis Test</span></span>
<span id="cb54-749"><a href="#cb54-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-750"><a href="#cb54-750" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The distribution of *non-functional waterpoints* in Nigeria, Osun is *randomly distributed.*</span>
<span id="cb54-751"><a href="#cb54-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-752"><a href="#cb54-752" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The distribution of *non-functional waterpoints* in Nigeria, Osun is *not randomly distributed.*</span>
<span id="cb54-753"><a href="#cb54-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-754"><a href="#cb54-754" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb54-755"><a href="#cb54-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-756"><a href="#cb54-756" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2.2 Computing L Function estimation</span></span>
<span id="cb54-757"><a href="#cb54-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-760"><a href="#cb54-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-761"><a href="#cb54-761" aria-hidden="true" tabindex="-1"></a>L_nonfunc <span class="ot">=</span> <span class="fu">Lest</span>(wpnonfuncNGA_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb54-762"><a href="#cb54-762" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb54-763"><a href="#cb54-763" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span>
<span id="cb54-764"><a href="#cb54-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-765"><a href="#cb54-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-766"><a href="#cb54-766" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1.3 Performing Complete Spatial Randomness Test</span></span>
<span id="cb54-767"><a href="#cb54-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-770"><a href="#cb54-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-771"><a href="#cb54-771" aria-hidden="true" tabindex="-1"></a><span class="co">#takes around less than 2 minutes</span></span>
<span id="cb54-772"><a href="#cb54-772" aria-hidden="true" tabindex="-1"></a>L_nonfunc.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(wpnonfuncNGA_ppp, Lest, <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">nrank =</span> <span class="dv">1</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-773"><a href="#cb54-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-774"><a href="#cb54-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-777"><a href="#cb54-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-778"><a href="#cb54-778" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_nonfunc.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span>
<span id="cb54-779"><a href="#cb54-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-780"><a href="#cb54-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-781"><a href="#cb54-781" aria-hidden="true" tabindex="-1"></a>Based on the graph, we can see that the L function is within the randomisation. Hence, we cannot reject the null hypothesis as there is insufficient evidence to prove that the distribution of non-functional waterpoints in Nigeria, Osun is randomly distributed at the level of 0.05.</span>
<span id="cb54-782"><a href="#cb54-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-783"><a href="#cb54-783" aria-hidden="true" tabindex="-1"></a><span class="fu"># 8. Spatial Correlation Analysis</span></span>
<span id="cb54-784"><a href="#cb54-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-785"><a href="#cb54-785" aria-hidden="true" tabindex="-1"></a>To look into the spatial correlation analysis between functional and non-functional waterpoints, I decided to perform Local Colocation Quotient Analysis <span class="co">[</span><span class="ot">(LCQA)</span><span class="co">](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/learnmorecolocationanalysis.htm)</span> as it measures local patterns of spatial association between two categories of point features using the colocation quotient statistic. The output of this analysis will be a map representing the likelihood of the spatial association between the two categories (i.e functional and non-functional waterpoints) analyzed with added fields including the colocation quotient value and p-value.</span>
<span id="cb54-786"><a href="#cb54-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-787"><a href="#cb54-787" aria-hidden="true" tabindex="-1"></a>If the p-value is less that our selected significance level (i.e 0.05), it means that there is sufficent evidence to reject the null hypothesis.</span>
<span id="cb54-788"><a href="#cb54-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-789"><a href="#cb54-789" aria-hidden="true" tabindex="-1"></a>For this hypothesis testing, the hypothesis are as follows:</span>
<span id="cb54-790"><a href="#cb54-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-791"><a href="#cb54-791" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis, H0: The spatial distribution of functional and non-functional water points are *independent* from each other.</span>
<span id="cb54-792"><a href="#cb54-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-793"><a href="#cb54-793" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative hypothesis, H1: The spatial distribution of functional and non-functional water points are *not independent* from each other.</span>
<span id="cb54-794"><a href="#cb54-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-795"><a href="#cb54-795" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The hypothesis will be tested at a significance level of 0.05, with a corresponding confidence level of 95%.</span>
<span id="cb54-796"><a href="#cb54-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-797"><a href="#cb54-797" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span></span>
<span id="cb54-798"><a href="#cb54-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-799"><a href="#cb54-799" aria-hidden="true" tabindex="-1"></a>To start off, I need to retrieve the polygon features of functional and non-functional waterpoints in Nigeria, Osun which i had extracted earlier and combined together into one dataframe.</span>
<span id="cb54-800"><a href="#cb54-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-803"><a href="#cb54-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-804"><a href="#cb54-804" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">rbind</span>(wp_functional, wp_nonfunctional)</span>
<span id="cb54-805"><a href="#cb54-805" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(wpNGA_funct_nonfunct<span class="sc">$</span>status_clean)</span>
<span id="cb54-806"><a href="#cb54-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-807"><a href="#cb54-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-808"><a href="#cb54-808" aria-hidden="true" tabindex="-1"></a>Looking at the df of wpNGA_funct_nonfunct, functional waterpoints consist of "Functional" and "Functional, needs repair" and non-functional waterpoints consist of "Abandoned/Decommissioned". Thus, to make things clearer, I decided to make it so that the df only contains "Functional" or "Non-functional" in the code chunk below.</span>
<span id="cb54-809"><a href="#cb54-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-812"><a href="#cb54-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-813"><a href="#cb54-813" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Functional, needs repair"</span>] <span class="ot">&lt;-</span> <span class="st">"Functional"</span></span>
<span id="cb54-814"><a href="#cb54-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-815"><a href="#cb54-815" aria-hidden="true" tabindex="-1"></a>wpNGA_funct_nonfunct<span class="sc">$</span>status_clean[wpNGA_funct_nonfunct<span class="sc">$</span>status_clean <span class="sc">==</span> <span class="st">"Abandoned/Decommissioned"</span>] <span class="ot">&lt;-</span> <span class="st">"Non-functional"</span></span>
<span id="cb54-816"><a href="#cb54-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-817"><a href="#cb54-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-818"><a href="#cb54-818" aria-hidden="true" tabindex="-1"></a>Next, I need to visualise my sf layers.</span>
<span id="cb54-819"><a href="#cb54-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-822"><a href="#cb54-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-823"><a href="#cb54-823" aria-hidden="true" tabindex="-1"></a><span class="co">#wpNGA_funct_nonfunct</span></span>
<span id="cb54-824"><a href="#cb54-824" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(NGA_owin) + tm_polygons(wpNGA_funct_nonfunct)</span></span>
<span id="cb54-825"><a href="#cb54-825" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wpNGA_funct_nonfunct)</span>
<span id="cb54-826"><a href="#cb54-826" aria-hidden="true" tabindex="-1"></a><span class="co">#tmap_mode("view")</span></span>
<span id="cb54-827"><a href="#cb54-827" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(wpNGA_funct_nonfunct) +</span></span>
<span id="cb54-828"><a href="#cb54-828" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_polygons("status_clean")+</span></span>
<span id="cb54-829"><a href="#cb54-829" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_view(set.zoom.limits = c(12, 16))</span></span>
<span id="cb54-830"><a href="#cb54-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-831"><a href="#cb54-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-832"><a href="#cb54-832" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb54-833"><a href="#cb54-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-834"><a href="#cb54-834" aria-hidden="true" tabindex="-1"></a>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726315/#:\~:text=H(r)%20%3D%20L(r)%20%E2%88%92%20r.&amp;text=Ripley's%20K%2Dfunction%20is%20typically,are%20distributed%20randomly%20and%20independently.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>